{"remainingRequest":"/Users/shanebeal/Desktop/bodewiki/node_modules/babel-loader/lib/index.js??ref--0-1!/Users/shanebeal/Desktop/bodewiki/client/libs/codemirror-merge/diff-match-patch.js","dependencies":[{"path":"/Users/shanebeal/Desktop/bodewiki/client/libs/codemirror-merge/diff-match-patch.js","mtime":1742851626000},{"path":"/Users/shanebeal/Desktop/bodewiki/.babelrc","mtime":1742797763162},{"path":"/Users/shanebeal/Desktop/bodewiki/node_modules/cache-loader/dist/cjs.js","mtime":1743632217742},{"path":"/Users/shanebeal/Desktop/bodewiki/node_modules/babel-loader/lib/index.js","mtime":1743632218430}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIGRpZmZfbWF0Y2hfcGF0Y2ggPSBmdW5jdGlvbiBkaWZmX21hdGNoX3BhdGNoKCkgewogICAgdGhpcy5EaWZmX1RpbWVvdXQgPSAxOwogICAgdGhpcy5EaWZmX0VkaXRDb3N0ID0gNDsKICAgIHRoaXMuTWF0Y2hfVGhyZXNob2xkID0gLjU7CiAgICB0aGlzLk1hdGNoX0Rpc3RhbmNlID0gMUUzOwogICAgdGhpcy5QYXRjaF9EZWxldGVUaHJlc2hvbGQgPSAuNTsKICAgIHRoaXMuUGF0Y2hfTWFyZ2luID0gNDsKICAgIHRoaXMuTWF0Y2hfTWF4Qml0cyA9IDMyOwogIH0sCiAgRElGRl9ERUxFVEUgPSAtMSwKICBESUZGX0lOU0VSVCA9IDEsCiAgRElGRl9FUVVBTCA9IDA7CmRpZmZfbWF0Y2hfcGF0Y2guRGlmZiA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgdGhpc1swXSA9IGE7CiAgdGhpc1sxXSA9IGI7Cn07CmRpZmZfbWF0Y2hfcGF0Y2guRGlmZi5wcm90b3R5cGUubGVuZ3RoID0gMjsKZGlmZl9tYXRjaF9wYXRjaC5EaWZmLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gdGhpc1swXSArICIsIiArIHRoaXNbMV07Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfbWFpbiA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7CiAgInVuZGVmaW5lZCIgPT0gdHlwZW9mIGQgJiYgKGQgPSAwID49IHRoaXMuRGlmZl9UaW1lb3V0ID8gTnVtYmVyLk1BWF9WQUxVRSA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgMUUzICogdGhpcy5EaWZmX1RpbWVvdXQpOwogIGlmIChudWxsID09IGEgfHwgbnVsbCA9PSBiKSB0aHJvdyBFcnJvcigiTnVsbCBpbnB1dC4gKGRpZmZfbWFpbikiKTsKICBpZiAoYSA9PSBiKSByZXR1cm4gYSA/IFtuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGEpXSA6IFtdOwogICJ1bmRlZmluZWQiID09IHR5cGVvZiBjICYmIChjID0gITApOwogIHZhciBlID0gYywKICAgIGYgPSB0aGlzLmRpZmZfY29tbW9uUHJlZml4KGEsIGIpOwogIGMgPSBhLnN1YnN0cmluZygwLCBmKTsKICBhID0gYS5zdWJzdHJpbmcoZik7CiAgYiA9IGIuc3Vic3RyaW5nKGYpOwogIGYgPSB0aGlzLmRpZmZfY29tbW9uU3VmZml4KGEsIGIpOwogIHZhciBnID0gYS5zdWJzdHJpbmcoYS5sZW5ndGggLSBmKTsKICBhID0gYS5zdWJzdHJpbmcoMCwgYS5sZW5ndGggLSBmKTsKICBiID0gYi5zdWJzdHJpbmcoMCwgYi5sZW5ndGggLSBmKTsKICBhID0gdGhpcy5kaWZmX2NvbXB1dGVfKGEsIGIsIGUsIGQpOwogIGMgJiYgYS51bnNoaWZ0KG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgYykpOwogIGcgJiYgYS5wdXNoKG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgZykpOwogIHRoaXMuZGlmZl9jbGVhbnVwTWVyZ2UoYSk7CiAgcmV0dXJuIGE7Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY29tcHV0ZV8gPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgewogIGlmICghYSkgcmV0dXJuIFtuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfSU5TRVJULCBiKV07CiAgaWYgKCFiKSByZXR1cm4gW25ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9ERUxFVEUsIGEpXTsKICB2YXIgZSA9IGEubGVuZ3RoID4gYi5sZW5ndGggPyBhIDogYiwKICAgIGYgPSBhLmxlbmd0aCA+IGIubGVuZ3RoID8gYiA6IGEsCiAgICBnID0gZS5pbmRleE9mKGYpOwogIHJldHVybiAtMSAhPSBnID8gKGMgPSBbbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0lOU0VSVCwgZS5zdWJzdHJpbmcoMCwgZykpLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGYpLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfSU5TRVJULCBlLnN1YnN0cmluZyhnICsgZi5sZW5ndGgpKV0sIGEubGVuZ3RoID4gYi5sZW5ndGggJiYgKGNbMF1bMF0gPSBjWzJdWzBdID0gRElGRl9ERUxFVEUpLCBjKSA6IDEgPT0gZi5sZW5ndGggPyBbbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0RFTEVURSwgYSksIG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9JTlNFUlQsIGIpXSA6IChlID0gdGhpcy5kaWZmX2hhbGZNYXRjaF8oYSwgYikpID8gKGIgPSBlWzFdLCBmID0gZVszXSwgYSA9IGVbNF0sIGUgPSB0aGlzLmRpZmZfbWFpbihlWzBdLCBlWzJdLCBjLCBkKSwgYyA9IHRoaXMuZGlmZl9tYWluKGIsIGYsIGMsIGQpLCBlLmNvbmNhdChbbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBhKV0sIGMpKSA6IGMgJiYgMTAwIDwgYS5sZW5ndGggJiYgMTAwIDwgYi5sZW5ndGggPyB0aGlzLmRpZmZfbGluZU1vZGVfKGEsIGIsIGQpIDogdGhpcy5kaWZmX2Jpc2VjdF8oYSwgYiwgZCk7Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfbGluZU1vZGVfID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsKICB2YXIgZCA9IHRoaXMuZGlmZl9saW5lc1RvQ2hhcnNfKGEsIGIpOwogIGEgPSBkLmNoYXJzMTsKICBiID0gZC5jaGFyczI7CiAgZCA9IGQubGluZUFycmF5OwogIGEgPSB0aGlzLmRpZmZfbWFpbihhLCBiLCAhMSwgYyk7CiAgdGhpcy5kaWZmX2NoYXJzVG9MaW5lc18oYSwgZCk7CiAgdGhpcy5kaWZmX2NsZWFudXBTZW1hbnRpYyhhKTsKICBhLnB1c2gobmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCAiIikpOwogIGZvciAodmFyIGUgPSBkID0gYiA9IDAsIGYgPSAiIiwgZyA9ICIiOyBiIDwgYS5sZW5ndGg7KSB7CiAgICBzd2l0Y2ggKGFbYl1bMF0pIHsKICAgICAgY2FzZSBESUZGX0lOU0VSVDoKICAgICAgICBlKys7CiAgICAgICAgZyArPSBhW2JdWzFdOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIERJRkZfREVMRVRFOgogICAgICAgIGQrKzsKICAgICAgICBmICs9IGFbYl1bMV07CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgRElGRl9FUVVBTDoKICAgICAgICBpZiAoMSA8PSBkICYmIDEgPD0gZSkgewogICAgICAgICAgYS5zcGxpY2UoYiAtIGQgLSBlLCBkICsgZSk7CiAgICAgICAgICBiID0gYiAtIGQgLSBlOwogICAgICAgICAgZCA9IHRoaXMuZGlmZl9tYWluKGYsIGcsICExLCBjKTsKICAgICAgICAgIGZvciAoZSA9IGQubGVuZ3RoIC0gMTsgMCA8PSBlOyBlLS0pIGEuc3BsaWNlKGIsIDAsIGRbZV0pOwogICAgICAgICAgYiArPSBkLmxlbmd0aDsKICAgICAgICB9CiAgICAgICAgZCA9IGUgPSAwOwogICAgICAgIGcgPSBmID0gIiI7CiAgICB9CiAgICBiKys7CiAgfQogIGEucG9wKCk7CiAgcmV0dXJuIGE7Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfYmlzZWN0XyA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7CiAgZm9yICh2YXIgZCA9IGEubGVuZ3RoLCBlID0gYi5sZW5ndGgsIGYgPSBNYXRoLmNlaWwoKGQgKyBlKSAvIDIpLCBnID0gMiAqIGYsIGggPSBBcnJheShnKSwgbCA9IEFycmF5KGcpLCBrID0gMDsgayA8IGc7IGsrKykgaFtrXSA9IC0xLCBsW2tdID0gLTE7CiAgaFtmICsgMV0gPSAwOwogIGxbZiArIDFdID0gMDsKICBrID0gZCAtIGU7CiAgZm9yICh2YXIgbSA9IDAgIT0gayAlIDIsIHAgPSAwLCB4ID0gMCwgdyA9IDAsIHEgPSAwLCB0ID0gMDsgdCA8IGYgJiYgIShuZXcgRGF0ZSgpLmdldFRpbWUoKSA+IGMpOyB0KyspIHsKICAgIGZvciAodmFyIHYgPSAtdCArIHA7IHYgPD0gdCAtIHg7IHYgKz0gMikgewogICAgICB2YXIgbiA9IGYgKyB2OwogICAgICB2YXIgciA9IHYgPT0gLXQgfHwgdiAhPSB0ICYmIGhbbiAtIDFdIDwgaFtuICsgMV0gPyBoW24gKyAxXSA6IGhbbiAtIDFdICsgMTsKICAgICAgZm9yICh2YXIgeSA9IHIgLSB2OyByIDwgZCAmJiB5IDwgZSAmJiBhLmNoYXJBdChyKSA9PSBiLmNoYXJBdCh5KTspIHIrKywgeSsrOwogICAgICBoW25dID0gcjsKICAgICAgaWYgKHIgPiBkKSB4ICs9IDI7ZWxzZSBpZiAoeSA+IGUpIHAgKz0gMjtlbHNlIGlmIChtICYmIChuID0gZiArIGsgLSB2LCAwIDw9IG4gJiYgbiA8IGcgJiYgLTEgIT0gbFtuXSkpIHsKICAgICAgICB2YXIgdSA9IGQgLSBsW25dOwogICAgICAgIGlmIChyID49IHUpIHJldHVybiB0aGlzLmRpZmZfYmlzZWN0U3BsaXRfKGEsIGIsIHIsIHksIGMpOwogICAgICB9CiAgICB9CiAgICBmb3IgKHYgPSAtdCArIHc7IHYgPD0gdCAtIHE7IHYgKz0gMikgewogICAgICBuID0gZiArIHY7CiAgICAgIHUgPSB2ID09IC10IHx8IHYgIT0gdCAmJiBsW24gLSAxXSA8IGxbbiArIDFdID8gbFtuICsgMV0gOiBsW24gLSAxXSArIDE7CiAgICAgIGZvciAociA9IHUgLSB2OyB1IDwgZCAmJiByIDwgZSAmJiBhLmNoYXJBdChkIC0gdSAtIDEpID09IGIuY2hhckF0KGUgLSByIC0gMSk7KSB1KyssIHIrKzsKICAgICAgbFtuXSA9IHU7CiAgICAgIGlmICh1ID4gZCkgcSArPSAyO2Vsc2UgaWYgKHIgPiBlKSB3ICs9IDI7ZWxzZSBpZiAoIW0gJiYgKG4gPSBmICsgayAtIHYsIDAgPD0gbiAmJiBuIDwgZyAmJiAtMSAhPSBoW25dICYmIChyID0gaFtuXSwgeSA9IGYgKyByIC0gbiwgdSA9IGQgLSB1LCByID49IHUpKSkgcmV0dXJuIHRoaXMuZGlmZl9iaXNlY3RTcGxpdF8oYSwgYiwgciwgeSwgYyk7CiAgICB9CiAgfQogIHJldHVybiBbbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0RFTEVURSwgYSksIG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9JTlNFUlQsIGIpXTsKfTsKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9iaXNlY3RTcGxpdF8gPSBmdW5jdGlvbiAoYSwgYiwgYywgZCwgZSkgewogIHZhciBmID0gYS5zdWJzdHJpbmcoMCwgYyksCiAgICBnID0gYi5zdWJzdHJpbmcoMCwgZCk7CiAgYSA9IGEuc3Vic3RyaW5nKGMpOwogIGIgPSBiLnN1YnN0cmluZyhkKTsKICBmID0gdGhpcy5kaWZmX21haW4oZiwgZywgITEsIGUpOwogIGUgPSB0aGlzLmRpZmZfbWFpbihhLCBiLCAhMSwgZSk7CiAgcmV0dXJuIGYuY29uY2F0KGUpOwp9OwpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2xpbmVzVG9DaGFyc18gPSBmdW5jdGlvbiAoYSwgYikgewogIGZ1bmN0aW9uIGMoYSkgewogICAgZm9yICh2YXIgYiA9ICIiLCBjID0gMCwgZyA9IC0xLCBoID0gZC5sZW5ndGg7IGcgPCBhLmxlbmd0aCAtIDE7KSB7CiAgICAgIGcgPSBhLmluZGV4T2YoIlxuIiwgYyk7CiAgICAgIC0xID09IGcgJiYgKGcgPSBhLmxlbmd0aCAtIDEpOwogICAgICB2YXIgbCA9IGEuc3Vic3RyaW5nKGMsIGcgKyAxKTsKICAgICAgKGUuaGFzT3duUHJvcGVydHkgPyBlLmhhc093blByb3BlcnR5KGwpIDogdm9pZCAwICE9PSBlW2xdKSA/IGIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShlW2xdKSA6IChoID09IGYgJiYgKGwgPSBhLnN1YnN0cmluZyhjKSwgZyA9IGEubGVuZ3RoKSwgYiArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGgpLCBlW2xdID0gaCwgZFtoKytdID0gbCk7CiAgICAgIGMgPSBnICsgMTsKICAgIH0KICAgIHJldHVybiBiOwogIH0KICB2YXIgZCA9IFtdLAogICAgZSA9IHt9OwogIGRbMF0gPSAiIjsKICB2YXIgZiA9IDRFNCwKICAgIGcgPSBjKGEpOwogIGYgPSA2NTUzNTsKICB2YXIgaCA9IGMoYik7CiAgcmV0dXJuIHsKICAgIGNoYXJzMTogZywKICAgIGNoYXJzMjogaCwKICAgIGxpbmVBcnJheTogZAogIH07Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY2hhcnNUb0xpbmVzXyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgZm9yICh2YXIgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSB7CiAgICBmb3IgKHZhciBkID0gYVtjXVsxXSwgZSA9IFtdLCBmID0gMDsgZiA8IGQubGVuZ3RoOyBmKyspIGVbZl0gPSBiW2QuY2hhckNvZGVBdChmKV07CiAgICBhW2NdWzFdID0gZS5qb2luKCIiKTsKICB9Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY29tbW9uUHJlZml4ID0gZnVuY3Rpb24gKGEsIGIpIHsKICBpZiAoIWEgfHwgIWIgfHwgYS5jaGFyQXQoMCkgIT0gYi5jaGFyQXQoMCkpIHJldHVybiAwOwogIGZvciAodmFyIGMgPSAwLCBkID0gTWF0aC5taW4oYS5sZW5ndGgsIGIubGVuZ3RoKSwgZSA9IGQsIGYgPSAwOyBjIDwgZTspIGEuc3Vic3RyaW5nKGYsIGUpID09IGIuc3Vic3RyaW5nKGYsIGUpID8gZiA9IGMgPSBlIDogZCA9IGUsIGUgPSBNYXRoLmZsb29yKChkIC0gYykgLyAyICsgYyk7CiAgcmV0dXJuIGU7Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY29tbW9uU3VmZml4ID0gZnVuY3Rpb24gKGEsIGIpIHsKICBpZiAoIWEgfHwgIWIgfHwgYS5jaGFyQXQoYS5sZW5ndGggLSAxKSAhPSBiLmNoYXJBdChiLmxlbmd0aCAtIDEpKSByZXR1cm4gMDsKICBmb3IgKHZhciBjID0gMCwgZCA9IE1hdGgubWluKGEubGVuZ3RoLCBiLmxlbmd0aCksIGUgPSBkLCBmID0gMDsgYyA8IGU7KSBhLnN1YnN0cmluZyhhLmxlbmd0aCAtIGUsIGEubGVuZ3RoIC0gZikgPT0gYi5zdWJzdHJpbmcoYi5sZW5ndGggLSBlLCBiLmxlbmd0aCAtIGYpID8gZiA9IGMgPSBlIDogZCA9IGUsIGUgPSBNYXRoLmZsb29yKChkIC0gYykgLyAyICsgYyk7CiAgcmV0dXJuIGU7Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY29tbW9uT3ZlcmxhcF8gPSBmdW5jdGlvbiAoYSwgYikgewogIHZhciBjID0gYS5sZW5ndGgsCiAgICBkID0gYi5sZW5ndGg7CiAgaWYgKDAgPT0gYyB8fCAwID09IGQpIHJldHVybiAwOwogIGMgPiBkID8gYSA9IGEuc3Vic3RyaW5nKGMgLSBkKSA6IGMgPCBkICYmIChiID0gYi5zdWJzdHJpbmcoMCwgYykpOwogIGMgPSBNYXRoLm1pbihjLCBkKTsKICBpZiAoYSA9PSBiKSByZXR1cm4gYzsKICBkID0gMDsKICBmb3IgKHZhciBlID0gMTs7KSB7CiAgICB2YXIgZiA9IGEuc3Vic3RyaW5nKGMgLSBlKTsKICAgIGYgPSBiLmluZGV4T2YoZik7CiAgICBpZiAoLTEgPT0gZikgcmV0dXJuIGQ7CiAgICBlICs9IGY7CiAgICBpZiAoMCA9PSBmIHx8IGEuc3Vic3RyaW5nKGMgLSBlKSA9PSBiLnN1YnN0cmluZygwLCBlKSkgZCA9IGUsIGUrKzsKICB9Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfaGFsZk1hdGNoXyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgZnVuY3Rpb24gYyhhLCBiLCBjKSB7CiAgICBmb3IgKHZhciBkID0gYS5zdWJzdHJpbmcoYywgYyArIE1hdGguZmxvb3IoYS5sZW5ndGggLyA0KSksIGUgPSAtMSwgZyA9ICIiLCBoLCBrLCBsLCBtOyAtMSAhPSAoZSA9IGIuaW5kZXhPZihkLCBlICsgMSkpOykgewogICAgICB2YXIgcCA9IGYuZGlmZl9jb21tb25QcmVmaXgoYS5zdWJzdHJpbmcoYyksIGIuc3Vic3RyaW5nKGUpKSwKICAgICAgICB1ID0gZi5kaWZmX2NvbW1vblN1ZmZpeChhLnN1YnN0cmluZygwLCBjKSwgYi5zdWJzdHJpbmcoMCwgZSkpOwogICAgICBnLmxlbmd0aCA8IHUgKyBwICYmIChnID0gYi5zdWJzdHJpbmcoZSAtIHUsIGUpICsgYi5zdWJzdHJpbmcoZSwgZSArIHApLCBoID0gYS5zdWJzdHJpbmcoMCwgYyAtIHUpLCBrID0gYS5zdWJzdHJpbmcoYyArIHApLCBsID0gYi5zdWJzdHJpbmcoMCwgZSAtIHUpLCBtID0gYi5zdWJzdHJpbmcoZSArIHApKTsKICAgIH0KICAgIHJldHVybiAyICogZy5sZW5ndGggPj0gYS5sZW5ndGggPyBbaCwgaywgbCwgbSwgZ10gOiBudWxsOwogIH0KICBpZiAoMCA+PSB0aGlzLkRpZmZfVGltZW91dCkgcmV0dXJuIG51bGw7CiAgdmFyIGQgPSBhLmxlbmd0aCA+IGIubGVuZ3RoID8gYSA6IGIsCiAgICBlID0gYS5sZW5ndGggPiBiLmxlbmd0aCA/IGIgOiBhOwogIGlmICg0ID4gZC5sZW5ndGggfHwgMiAqIGUubGVuZ3RoIDwgZC5sZW5ndGgpIHJldHVybiBudWxsOwogIHZhciBmID0gdGhpcywKICAgIGcgPSBjKGQsIGUsIE1hdGguY2VpbChkLmxlbmd0aCAvIDQpKTsKICBkID0gYyhkLCBlLCBNYXRoLmNlaWwoZC5sZW5ndGggLyAyKSk7CiAgaWYgKGcgfHwgZCkgZyA9IGQgPyBnID8gZ1s0XS5sZW5ndGggPiBkWzRdLmxlbmd0aCA/IGcgOiBkIDogZCA6IGc7ZWxzZSByZXR1cm4gbnVsbDsKICBpZiAoYS5sZW5ndGggPiBiLmxlbmd0aCkgewogICAgZCA9IGdbMF07CiAgICBlID0gZ1sxXTsKICAgIHZhciBoID0gZ1syXTsKICAgIHZhciBsID0gZ1szXTsKICB9IGVsc2UgaCA9IGdbMF0sIGwgPSBnWzFdLCBkID0gZ1syXSwgZSA9IGdbM107CiAgcmV0dXJuIFtkLCBlLCBoLCBsLCBnWzRdXTsKfTsKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9jbGVhbnVwU2VtYW50aWMgPSBmdW5jdGlvbiAoYSkgewogIGZvciAodmFyIGIgPSAhMSwgYyA9IFtdLCBkID0gMCwgZSA9IG51bGwsIGYgPSAwLCBnID0gMCwgaCA9IDAsIGwgPSAwLCBrID0gMDsgZiA8IGEubGVuZ3RoOykgYVtmXVswXSA9PSBESUZGX0VRVUFMID8gKGNbZCsrXSA9IGYsIGcgPSBsLCBoID0gaywgayA9IGwgPSAwLCBlID0gYVtmXVsxXSkgOiAoYVtmXVswXSA9PSBESUZGX0lOU0VSVCA/IGwgKz0gYVtmXVsxXS5sZW5ndGggOiBrICs9IGFbZl1bMV0ubGVuZ3RoLCBlICYmIGUubGVuZ3RoIDw9IE1hdGgubWF4KGcsIGgpICYmIGUubGVuZ3RoIDw9IE1hdGgubWF4KGwsIGspICYmIChhLnNwbGljZShjW2QgLSAxXSwgMCwgbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0RFTEVURSwgZSkpLCBhW2NbZCAtIDFdICsgMV1bMF0gPSBESUZGX0lOU0VSVCwgZC0tLCBkLS0sIGYgPSAwIDwgZCA/IGNbZCAtIDFdIDogLTEsIGsgPSBsID0gaCA9IGcgPSAwLCBlID0gbnVsbCwgYiA9ICEwKSksIGYrKzsKICBiICYmIHRoaXMuZGlmZl9jbGVhbnVwTWVyZ2UoYSk7CiAgdGhpcy5kaWZmX2NsZWFudXBTZW1hbnRpY0xvc3NsZXNzKGEpOwogIGZvciAoZiA9IDE7IGYgPCBhLmxlbmd0aDspIHsKICAgIGlmIChhW2YgLSAxXVswXSA9PSBESUZGX0RFTEVURSAmJiBhW2ZdWzBdID09IERJRkZfSU5TRVJUKSB7CiAgICAgIGIgPSBhW2YgLSAxXVsxXTsKICAgICAgYyA9IGFbZl1bMV07CiAgICAgIGQgPSB0aGlzLmRpZmZfY29tbW9uT3ZlcmxhcF8oYiwgYyk7CiAgICAgIGUgPSB0aGlzLmRpZmZfY29tbW9uT3ZlcmxhcF8oYywgYik7CiAgICAgIGlmIChkID49IGUpIHsKICAgICAgICBpZiAoZCA+PSBiLmxlbmd0aCAvIDIgfHwgZCA+PSBjLmxlbmd0aCAvIDIpIGEuc3BsaWNlKGYsIDAsIG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgYy5zdWJzdHJpbmcoMCwgZCkpKSwgYVtmIC0gMV1bMV0gPSBiLnN1YnN0cmluZygwLCBiLmxlbmd0aCAtIGQpLCBhW2YgKyAxXVsxXSA9IGMuc3Vic3RyaW5nKGQpLCBmKys7CiAgICAgIH0gZWxzZSBpZiAoZSA+PSBiLmxlbmd0aCAvIDIgfHwgZSA+PSBjLmxlbmd0aCAvIDIpIGEuc3BsaWNlKGYsIDAsIG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgYi5zdWJzdHJpbmcoMCwgZSkpKSwgYVtmIC0gMV1bMF0gPSBESUZGX0lOU0VSVCwgYVtmIC0gMV1bMV0gPSBjLnN1YnN0cmluZygwLCBjLmxlbmd0aCAtIGUpLCBhW2YgKyAxXVswXSA9IERJRkZfREVMRVRFLCBhW2YgKyAxXVsxXSA9IGIuc3Vic3RyaW5nKGUpLCBmKys7CiAgICAgIGYrKzsKICAgIH0KICAgIGYrKzsKICB9Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY2xlYW51cFNlbWFudGljTG9zc2xlc3MgPSBmdW5jdGlvbiAoYSkgewogIGZ1bmN0aW9uIGIoYSwgYikgewogICAgaWYgKCFhIHx8ICFiKSByZXR1cm4gNjsKICAgIHZhciBjID0gYS5jaGFyQXQoYS5sZW5ndGggLSAxKSwKICAgICAgZCA9IGIuY2hhckF0KDApLAogICAgICBlID0gYy5tYXRjaChkaWZmX21hdGNoX3BhdGNoLm5vbkFscGhhTnVtZXJpY1JlZ2V4XyksCiAgICAgIGYgPSBkLm1hdGNoKGRpZmZfbWF0Y2hfcGF0Y2gubm9uQWxwaGFOdW1lcmljUmVnZXhfKSwKICAgICAgZyA9IGUgJiYgYy5tYXRjaChkaWZmX21hdGNoX3BhdGNoLndoaXRlc3BhY2VSZWdleF8pLAogICAgICBoID0gZiAmJiBkLm1hdGNoKGRpZmZfbWF0Y2hfcGF0Y2gud2hpdGVzcGFjZVJlZ2V4Xyk7CiAgICBjID0gZyAmJiBjLm1hdGNoKGRpZmZfbWF0Y2hfcGF0Y2gubGluZWJyZWFrUmVnZXhfKTsKICAgIGQgPSBoICYmIGQubWF0Y2goZGlmZl9tYXRjaF9wYXRjaC5saW5lYnJlYWtSZWdleF8pOwogICAgdmFyIGsgPSBjICYmIGEubWF0Y2goZGlmZl9tYXRjaF9wYXRjaC5ibGFua2xpbmVFbmRSZWdleF8pLAogICAgICBsID0gZCAmJiBiLm1hdGNoKGRpZmZfbWF0Y2hfcGF0Y2guYmxhbmtsaW5lU3RhcnRSZWdleF8pOwogICAgcmV0dXJuIGsgfHwgbCA/IDUgOiBjIHx8IGQgPyA0IDogZSAmJiAhZyAmJiBoID8gMyA6IGcgfHwgaCA/IDIgOiBlIHx8IGYgPyAxIDogMDsKICB9CiAgZm9yICh2YXIgYyA9IDE7IGMgPCBhLmxlbmd0aCAtIDE7KSB7CiAgICBpZiAoYVtjIC0gMV1bMF0gPT0gRElGRl9FUVVBTCAmJiBhW2MgKyAxXVswXSA9PSBESUZGX0VRVUFMKSB7CiAgICAgIHZhciBkID0gYVtjIC0gMV1bMV0sCiAgICAgICAgZSA9IGFbY11bMV0sCiAgICAgICAgZiA9IGFbYyArIDFdWzFdLAogICAgICAgIGcgPSB0aGlzLmRpZmZfY29tbW9uU3VmZml4KGQsIGUpOwogICAgICBpZiAoZykgewogICAgICAgIHZhciBoID0gZS5zdWJzdHJpbmcoZS5sZW5ndGggLSBnKTsKICAgICAgICBkID0gZC5zdWJzdHJpbmcoMCwgZC5sZW5ndGggLSBnKTsKICAgICAgICBlID0gaCArIGUuc3Vic3RyaW5nKDAsIGUubGVuZ3RoIC0gZyk7CiAgICAgICAgZiA9IGggKyBmOwogICAgICB9CiAgICAgIGcgPSBkOwogICAgICBoID0gZTsKICAgICAgZm9yICh2YXIgbCA9IGYsIGsgPSBiKGQsIGUpICsgYihlLCBmKTsgZS5jaGFyQXQoMCkgPT09IGYuY2hhckF0KDApOykgewogICAgICAgIGQgKz0gZS5jaGFyQXQoMCk7CiAgICAgICAgZSA9IGUuc3Vic3RyaW5nKDEpICsgZi5jaGFyQXQoMCk7CiAgICAgICAgZiA9IGYuc3Vic3RyaW5nKDEpOwogICAgICAgIHZhciBtID0gYihkLCBlKSArIGIoZSwgZik7CiAgICAgICAgbSA+PSBrICYmIChrID0gbSwgZyA9IGQsIGggPSBlLCBsID0gZik7CiAgICAgIH0KICAgICAgYVtjIC0gMV1bMV0gIT0gZyAmJiAoZyA/IGFbYyAtIDFdWzFdID0gZyA6IChhLnNwbGljZShjIC0gMSwgMSksIGMtLSksIGFbY11bMV0gPSBoLCBsID8gYVtjICsgMV1bMV0gPSBsIDogKGEuc3BsaWNlKGMgKyAxLCAxKSwgYy0tKSk7CiAgICB9CiAgICBjKys7CiAgfQp9OwpkaWZmX21hdGNoX3BhdGNoLm5vbkFscGhhTnVtZXJpY1JlZ2V4XyA9IC9bXmEtekEtWjAtOV0vOwpkaWZmX21hdGNoX3BhdGNoLndoaXRlc3BhY2VSZWdleF8gPSAvXHMvOwpkaWZmX21hdGNoX3BhdGNoLmxpbmVicmVha1JlZ2V4XyA9IC9bXHJcbl0vOwpkaWZmX21hdGNoX3BhdGNoLmJsYW5rbGluZUVuZFJlZ2V4XyA9IC9cblxyP1xuJC87CmRpZmZfbWF0Y2hfcGF0Y2guYmxhbmtsaW5lU3RhcnRSZWdleF8gPSAvXlxyP1xuXHI/XG4vOwpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2NsZWFudXBFZmZpY2llbmN5ID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0gITEsIGMgPSBbXSwgZCA9IDAsIGUgPSBudWxsLCBmID0gMCwgZyA9ICExLCBoID0gITEsIGwgPSAhMSwgayA9ICExOyBmIDwgYS5sZW5ndGg7KSBhW2ZdWzBdID09IERJRkZfRVFVQUwgPyAoYVtmXVsxXS5sZW5ndGggPCB0aGlzLkRpZmZfRWRpdENvc3QgJiYgKGwgfHwgaykgPyAoY1tkKytdID0gZiwgZyA9IGwsIGggPSBrLCBlID0gYVtmXVsxXSkgOiAoZCA9IDAsIGUgPSBudWxsKSwgbCA9IGsgPSAhMSkgOiAoYVtmXVswXSA9PSBESUZGX0RFTEVURSA/IGsgPSAhMCA6IGwgPSAhMCwgZSAmJiAoZyAmJiBoICYmIGwgJiYgayB8fCBlLmxlbmd0aCA8IHRoaXMuRGlmZl9FZGl0Q29zdCAvIDIgJiYgMyA9PSBnICsgaCArIGwgKyBrKSAmJiAoYS5zcGxpY2UoY1tkIC0gMV0sIDAsIG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9ERUxFVEUsIGUpKSwgYVtjW2QgLSAxXSArIDFdWzBdID0gRElGRl9JTlNFUlQsIGQtLSwgZSA9IG51bGwsIGcgJiYgaCA/IChsID0gayA9ICEwLCBkID0gMCkgOiAoZC0tLCBmID0gMCA8IGQgPyBjW2QgLSAxXSA6IC0xLCBsID0gayA9ICExKSwgYiA9ICEwKSksIGYrKzsKICBiICYmIHRoaXMuZGlmZl9jbGVhbnVwTWVyZ2UoYSk7Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY2xlYW51cE1lcmdlID0gZnVuY3Rpb24gKGEpIHsKICBhLnB1c2gobmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCAiIikpOwogIGZvciAodmFyIGIgPSAwLCBjID0gMCwgZCA9IDAsIGUgPSAiIiwgZiA9ICIiLCBnOyBiIDwgYS5sZW5ndGg7KSBzd2l0Y2ggKGFbYl1bMF0pIHsKICAgIGNhc2UgRElGRl9JTlNFUlQ6CiAgICAgIGQrKzsKICAgICAgZiArPSBhW2JdWzFdOwogICAgICBiKys7CiAgICAgIGJyZWFrOwogICAgY2FzZSBESUZGX0RFTEVURToKICAgICAgYysrOwogICAgICBlICs9IGFbYl1bMV07CiAgICAgIGIrKzsKICAgICAgYnJlYWs7CiAgICBjYXNlIERJRkZfRVFVQUw6CiAgICAgIDEgPCBjICsgZCA/ICgwICE9PSBjICYmIDAgIT09IGQgJiYgKGcgPSB0aGlzLmRpZmZfY29tbW9uUHJlZml4KGYsIGUpLCAwICE9PSBnICYmICgwIDwgYiAtIGMgLSBkICYmIGFbYiAtIGMgLSBkIC0gMV1bMF0gPT0gRElGRl9FUVVBTCA/IGFbYiAtIGMgLSBkIC0gMV1bMV0gKz0gZi5zdWJzdHJpbmcoMCwgZykgOiAoYS5zcGxpY2UoMCwgMCwgbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBmLnN1YnN0cmluZygwLCBnKSkpLCBiKyspLCBmID0gZi5zdWJzdHJpbmcoZyksIGUgPSBlLnN1YnN0cmluZyhnKSksIGcgPSB0aGlzLmRpZmZfY29tbW9uU3VmZml4KGYsIGUpLCAwICE9PSBnICYmIChhW2JdWzFdID0gZi5zdWJzdHJpbmcoZi5sZW5ndGggLSBnKSArIGFbYl1bMV0sIGYgPSBmLnN1YnN0cmluZygwLCBmLmxlbmd0aCAtIGcpLCBlID0gZS5zdWJzdHJpbmcoMCwgZS5sZW5ndGggLSBnKSkpLCBiIC09IGMgKyBkLCBhLnNwbGljZShiLCBjICsgZCksIGUubGVuZ3RoICYmIChhLnNwbGljZShiLCAwLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfREVMRVRFLCBlKSksIGIrKyksIGYubGVuZ3RoICYmIChhLnNwbGljZShiLCAwLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfSU5TRVJULCBmKSksIGIrKyksIGIrKykgOiAwICE9PSBiICYmIGFbYiAtIDFdWzBdID09IERJRkZfRVFVQUwgPyAoYVtiIC0gMV1bMV0gKz0gYVtiXVsxXSwgYS5zcGxpY2UoYiwgMSkpIDogYisrLCBjID0gZCA9IDAsIGYgPSBlID0gIiI7CiAgfQogICIiID09PSBhW2EubGVuZ3RoIC0gMV1bMV0gJiYgYS5wb3AoKTsKICBjID0gITE7CiAgZm9yIChiID0gMTsgYiA8IGEubGVuZ3RoIC0gMTspIGFbYiAtIDFdWzBdID09IERJRkZfRVFVQUwgJiYgYVtiICsgMV1bMF0gPT0gRElGRl9FUVVBTCAmJiAoYVtiXVsxXS5zdWJzdHJpbmcoYVtiXVsxXS5sZW5ndGggLSBhW2IgLSAxXVsxXS5sZW5ndGgpID09IGFbYiAtIDFdWzFdID8gKGFbYl1bMV0gPSBhW2IgLSAxXVsxXSArIGFbYl1bMV0uc3Vic3RyaW5nKDAsIGFbYl1bMV0ubGVuZ3RoIC0gYVtiIC0gMV1bMV0ubGVuZ3RoKSwgYVtiICsgMV1bMV0gPSBhW2IgLSAxXVsxXSArIGFbYiArIDFdWzFdLCBhLnNwbGljZShiIC0gMSwgMSksIGMgPSAhMCkgOiBhW2JdWzFdLnN1YnN0cmluZygwLCBhW2IgKyAxXVsxXS5sZW5ndGgpID09IGFbYiArIDFdWzFdICYmIChhW2IgLSAxXVsxXSArPSBhW2IgKyAxXVsxXSwgYVtiXVsxXSA9IGFbYl1bMV0uc3Vic3RyaW5nKGFbYiArIDFdWzFdLmxlbmd0aCkgKyBhW2IgKyAxXVsxXSwgYS5zcGxpY2UoYiArIDEsIDEpLCBjID0gITApKSwgYisrOwogIGMgJiYgdGhpcy5kaWZmX2NsZWFudXBNZXJnZShhKTsKfTsKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl94SW5kZXggPSBmdW5jdGlvbiAoYSwgYikgewogIHZhciBjID0gMCwKICAgIGQgPSAwLAogICAgZSA9IDAsCiAgICBmID0gMCwKICAgIGc7CiAgZm9yIChnID0gMDsgZyA8IGEubGVuZ3RoOyBnKyspIHsKICAgIGFbZ11bMF0gIT09IERJRkZfSU5TRVJUICYmIChjICs9IGFbZ11bMV0ubGVuZ3RoKTsKICAgIGFbZ11bMF0gIT09IERJRkZfREVMRVRFICYmIChkICs9IGFbZ11bMV0ubGVuZ3RoKTsKICAgIGlmIChjID4gYikgYnJlYWs7CiAgICBlID0gYzsKICAgIGYgPSBkOwogIH0KICByZXR1cm4gYS5sZW5ndGggIT0gZyAmJiBhW2ddWzBdID09PSBESUZGX0RFTEVURSA/IGYgOiBmICsgKGIgLSBlKTsKfTsKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9wcmV0dHlIdG1sID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0gW10sIGMgPSAvJi9nLCBkID0gLzwvZywgZSA9IC8+L2csIGYgPSAvXG4vZywgZyA9IDA7IGcgPCBhLmxlbmd0aDsgZysrKSB7CiAgICB2YXIgaCA9IGFbZ11bMF0sCiAgICAgIGwgPSBhW2ddWzFdLnJlcGxhY2UoYywgIiZhbXA7IikucmVwbGFjZShkLCAiJmx0OyIpLnJlcGxhY2UoZSwgIiZndDsiKS5yZXBsYWNlKGYsICImcGFyYTs8YnI+Iik7CiAgICBzd2l0Y2ggKGgpIHsKICAgICAgY2FzZSBESUZGX0lOU0VSVDoKICAgICAgICBiW2ddID0gJzxpbnMgc3R5bGU9ImJhY2tncm91bmQ6I2U2ZmZlNjsiPicgKyBsICsgIjwvaW5zPiI7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgRElGRl9ERUxFVEU6CiAgICAgICAgYltnXSA9ICc8ZGVsIHN0eWxlPSJiYWNrZ3JvdW5kOiNmZmU2ZTY7Ij4nICsgbCArICI8L2RlbD4iOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIERJRkZfRVFVQUw6CiAgICAgICAgYltnXSA9ICI8c3Bhbj4iICsgbCArICI8L3NwYW4+IjsKICAgIH0KICB9CiAgcmV0dXJuIGIuam9pbigiIik7Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfdGV4dDEgPSBmdW5jdGlvbiAoYSkgewogIGZvciAodmFyIGIgPSBbXSwgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSBhW2NdWzBdICE9PSBESUZGX0lOU0VSVCAmJiAoYltjXSA9IGFbY11bMV0pOwogIHJldHVybiBiLmpvaW4oIiIpOwp9OwpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX3RleHQyID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0gW10sIGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykgYVtjXVswXSAhPT0gRElGRl9ERUxFVEUgJiYgKGJbY10gPSBhW2NdWzFdKTsKICByZXR1cm4gYi5qb2luKCIiKTsKfTsKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9sZXZlbnNodGVpbiA9IGZ1bmN0aW9uIChhKSB7CiAgZm9yICh2YXIgYiA9IDAsIGMgPSAwLCBkID0gMCwgZSA9IDA7IGUgPCBhLmxlbmd0aDsgZSsrKSB7CiAgICB2YXIgZiA9IGFbZV1bMV07CiAgICBzd2l0Y2ggKGFbZV1bMF0pIHsKICAgICAgY2FzZSBESUZGX0lOU0VSVDoKICAgICAgICBjICs9IGYubGVuZ3RoOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIERJRkZfREVMRVRFOgogICAgICAgIGQgKz0gZi5sZW5ndGg7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgRElGRl9FUVVBTDoKICAgICAgICBiICs9IE1hdGgubWF4KGMsIGQpLCBkID0gYyA9IDA7CiAgICB9CiAgfQogIHJldHVybiBiICs9IE1hdGgubWF4KGMsIGQpOwp9OwpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX3RvRGVsdGEgPSBmdW5jdGlvbiAoYSkgewogIGZvciAodmFyIGIgPSBbXSwgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSBzd2l0Y2ggKGFbY11bMF0pIHsKICAgIGNhc2UgRElGRl9JTlNFUlQ6CiAgICAgIGJbY10gPSAiKyIgKyBlbmNvZGVVUkkoYVtjXVsxXSk7CiAgICAgIGJyZWFrOwogICAgY2FzZSBESUZGX0RFTEVURToKICAgICAgYltjXSA9ICItIiArIGFbY11bMV0ubGVuZ3RoOwogICAgICBicmVhazsKICAgIGNhc2UgRElGRl9FUVVBTDoKICAgICAgYltjXSA9ICI9IiArIGFbY11bMV0ubGVuZ3RoOwogIH0KICByZXR1cm4gYi5qb2luKCJcdCIpLnJlcGxhY2UoLyUyMC9nLCAiICIpOwp9OwpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2Zyb21EZWx0YSA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgZm9yICh2YXIgYyA9IFtdLCBkID0gMCwgZSA9IDAsIGYgPSBiLnNwbGl0KC9cdC9nKSwgZyA9IDA7IGcgPCBmLmxlbmd0aDsgZysrKSB7CiAgICB2YXIgaCA9IGZbZ10uc3Vic3RyaW5nKDEpOwogICAgc3dpdGNoIChmW2ddLmNoYXJBdCgwKSkgewogICAgICBjYXNlICIrIjoKICAgICAgICB0cnkgewogICAgICAgICAgY1tkKytdID0gbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0lOU0VSVCwgZGVjb2RlVVJJKGgpKTsKICAgICAgICB9IGNhdGNoIChrKSB7CiAgICAgICAgICB0aHJvdyBFcnJvcigiSWxsZWdhbCBlc2NhcGUgaW4gZGlmZl9mcm9tRGVsdGE6ICIgKyBoKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIi0iOgogICAgICBjYXNlICI9IjoKICAgICAgICB2YXIgbCA9IHBhcnNlSW50KGgsIDEwKTsKICAgICAgICBpZiAoaXNOYU4obCkgfHwgMCA+IGwpIHRocm93IEVycm9yKCJJbnZhbGlkIG51bWJlciBpbiBkaWZmX2Zyb21EZWx0YTogIiArIGgpOwogICAgICAgIGggPSBhLnN1YnN0cmluZyhlLCBlICs9IGwpOwogICAgICAgICI9IiA9PSBmW2ddLmNoYXJBdCgwKSA/IGNbZCsrXSA9IG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgaCkgOiBjW2QrK10gPSBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfREVMRVRFLCBoKTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICBpZiAoZltnXSkgdGhyb3cgRXJyb3IoIkludmFsaWQgZGlmZiBvcGVyYXRpb24gaW4gZGlmZl9mcm9tRGVsdGE6ICIgKyBmW2ddKTsKICAgIH0KICB9CiAgaWYgKGUgIT0gYS5sZW5ndGgpIHRocm93IEVycm9yKCJEZWx0YSBsZW5ndGggKCIgKyBlICsgIikgZG9lcyBub3QgZXF1YWwgc291cmNlIHRleHQgbGVuZ3RoICgiICsgYS5sZW5ndGggKyAiKS4iKTsKICByZXR1cm4gYzsKfTsKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUubWF0Y2hfbWFpbiA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7CiAgaWYgKG51bGwgPT0gYSB8fCBudWxsID09IGIgfHwgbnVsbCA9PSBjKSB0aHJvdyBFcnJvcigiTnVsbCBpbnB1dC4gKG1hdGNoX21haW4pIik7CiAgYyA9IE1hdGgubWF4KDAsIE1hdGgubWluKGMsIGEubGVuZ3RoKSk7CiAgcmV0dXJuIGEgPT0gYiA/IDAgOiBhLmxlbmd0aCA/IGEuc3Vic3RyaW5nKGMsIGMgKyBiLmxlbmd0aCkgPT0gYiA/IGMgOiB0aGlzLm1hdGNoX2JpdGFwXyhhLCBiLCBjKSA6IC0xOwp9OwpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5tYXRjaF9iaXRhcF8gPSBmdW5jdGlvbiAoYSwgYiwgYykgewogIGZ1bmN0aW9uIGQoYSwgZCkgewogICAgdmFyIGUgPSBhIC8gYi5sZW5ndGgsCiAgICAgIGcgPSBNYXRoLmFicyhjIC0gZCk7CiAgICByZXR1cm4gZi5NYXRjaF9EaXN0YW5jZSA/IGUgKyBnIC8gZi5NYXRjaF9EaXN0YW5jZSA6IGcgPyAxIDogZTsKICB9CiAgaWYgKGIubGVuZ3RoID4gdGhpcy5NYXRjaF9NYXhCaXRzKSB0aHJvdyBFcnJvcigiUGF0dGVybiB0b28gbG9uZyBmb3IgdGhpcyBicm93c2VyLiIpOwogIHZhciBlID0gdGhpcy5tYXRjaF9hbHBoYWJldF8oYiksCiAgICBmID0gdGhpcywKICAgIGcgPSB0aGlzLk1hdGNoX1RocmVzaG9sZCwKICAgIGggPSBhLmluZGV4T2YoYiwgYyk7CiAgLTEgIT0gaCAmJiAoZyA9IE1hdGgubWluKGQoMCwgaCksIGcpLCBoID0gYS5sYXN0SW5kZXhPZihiLCBjICsgYi5sZW5ndGgpLCAtMSAhPSBoICYmIChnID0gTWF0aC5taW4oZCgwLCBoKSwgZykpKTsKICB2YXIgbCA9IDEgPDwgYi5sZW5ndGggLSAxOwogIGggPSAtMTsKICBmb3IgKHZhciBrLCBtLCBwID0gYi5sZW5ndGggKyBhLmxlbmd0aCwgeCwgdyA9IDA7IHcgPCBiLmxlbmd0aDsgdysrKSB7CiAgICBrID0gMDsKICAgIGZvciAobSA9IHA7IGsgPCBtOykgZCh3LCBjICsgbSkgPD0gZyA/IGsgPSBtIDogcCA9IG0sIG0gPSBNYXRoLmZsb29yKChwIC0gaykgLyAyICsgayk7CiAgICBwID0gbTsKICAgIGsgPSBNYXRoLm1heCgxLCBjIC0gbSArIDEpOwogICAgdmFyIHEgPSBNYXRoLm1pbihjICsgbSwgYS5sZW5ndGgpICsgYi5sZW5ndGg7CiAgICBtID0gQXJyYXkocSArIDIpOwogICAgZm9yIChtW3EgKyAxXSA9ICgxIDw8IHcpIC0gMTsgcSA+PSBrOyBxLS0pIHsKICAgICAgdmFyIHQgPSBlW2EuY2hhckF0KHEgLSAxKV07CiAgICAgIG1bcV0gPSAwID09PSB3ID8gKG1bcSArIDFdIDw8IDEgfCAxKSAmIHQgOiAobVtxICsgMV0gPDwgMSB8IDEpICYgdCB8ICh4W3EgKyAxXSB8IHhbcV0pIDw8IDEgfCAxIHwgeFtxICsgMV07CiAgICAgIGlmIChtW3FdICYgbCAmJiAodCA9IGQodywgcSAtIDEpLCB0IDw9IGcpKSBpZiAoZyA9IHQsIGggPSBxIC0gMSwgaCA+IGMpIGsgPSBNYXRoLm1heCgxLCAyICogYyAtIGgpO2Vsc2UgYnJlYWs7CiAgICB9CiAgICBpZiAoZCh3ICsgMSwgYykgPiBnKSBicmVhazsKICAgIHggPSBtOwogIH0KICByZXR1cm4gaDsKfTsKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUubWF0Y2hfYWxwaGFiZXRfID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0ge30sIGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykgYlthLmNoYXJBdChjKV0gPSAwOwogIGZvciAoYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSBiW2EuY2hhckF0KGMpXSB8PSAxIDw8IGEubGVuZ3RoIC0gYyAtIDE7CiAgcmV0dXJuIGI7Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLnBhdGNoX2FkZENvbnRleHRfID0gZnVuY3Rpb24gKGEsIGIpIHsKICBpZiAoMCAhPSBiLmxlbmd0aCkgewogICAgaWYgKG51bGwgPT09IGEuc3RhcnQyKSB0aHJvdyBFcnJvcigicGF0Y2ggbm90IGluaXRpYWxpemVkIik7CiAgICBmb3IgKHZhciBjID0gYi5zdWJzdHJpbmcoYS5zdGFydDIsIGEuc3RhcnQyICsgYS5sZW5ndGgxKSwgZCA9IDA7IGIuaW5kZXhPZihjKSAhPSBiLmxhc3RJbmRleE9mKGMpICYmIGMubGVuZ3RoIDwgdGhpcy5NYXRjaF9NYXhCaXRzIC0gdGhpcy5QYXRjaF9NYXJnaW4gLSB0aGlzLlBhdGNoX01hcmdpbjspIGQgKz0gdGhpcy5QYXRjaF9NYXJnaW4sIGMgPSBiLnN1YnN0cmluZyhhLnN0YXJ0MiAtIGQsIGEuc3RhcnQyICsgYS5sZW5ndGgxICsgZCk7CiAgICBkICs9IHRoaXMuUGF0Y2hfTWFyZ2luOwogICAgKGMgPSBiLnN1YnN0cmluZyhhLnN0YXJ0MiAtIGQsIGEuc3RhcnQyKSkgJiYgYS5kaWZmcy51bnNoaWZ0KG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgYykpOwogICAgKGQgPSBiLnN1YnN0cmluZyhhLnN0YXJ0MiArIGEubGVuZ3RoMSwgYS5zdGFydDIgKyBhLmxlbmd0aDEgKyBkKSkgJiYgYS5kaWZmcy5wdXNoKG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgZCkpOwogICAgYS5zdGFydDEgLT0gYy5sZW5ndGg7CiAgICBhLnN0YXJ0MiAtPSBjLmxlbmd0aDsKICAgIGEubGVuZ3RoMSArPSBjLmxlbmd0aCArIGQubGVuZ3RoOwogICAgYS5sZW5ndGgyICs9IGMubGVuZ3RoICsgZC5sZW5ndGg7CiAgfQp9OwpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5wYXRjaF9tYWtlID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsKICBpZiAoInN0cmluZyIgPT0gdHlwZW9mIGEgJiYgInN0cmluZyIgPT0gdHlwZW9mIGIgJiYgInVuZGVmaW5lZCIgPT0gdHlwZW9mIGMpIHsKICAgIHZhciBkID0gYTsKICAgIGIgPSB0aGlzLmRpZmZfbWFpbihkLCBiLCAhMCk7CiAgICAyIDwgYi5sZW5ndGggJiYgKHRoaXMuZGlmZl9jbGVhbnVwU2VtYW50aWMoYiksIHRoaXMuZGlmZl9jbGVhbnVwRWZmaWNpZW5jeShiKSk7CiAgfSBlbHNlIGlmIChhICYmICJvYmplY3QiID09IHR5cGVvZiBhICYmICJ1bmRlZmluZWQiID09IHR5cGVvZiBiICYmICJ1bmRlZmluZWQiID09IHR5cGVvZiBjKSBiID0gYSwgZCA9IHRoaXMuZGlmZl90ZXh0MShiKTtlbHNlIGlmICgic3RyaW5nIiA9PSB0eXBlb2YgYSAmJiBiICYmICJvYmplY3QiID09IHR5cGVvZiBiICYmICJ1bmRlZmluZWQiID09IHR5cGVvZiBjKSBkID0gYTtlbHNlIGlmICgic3RyaW5nIiA9PSB0eXBlb2YgYSAmJiAic3RyaW5nIiA9PSB0eXBlb2YgYiAmJiBjICYmICJvYmplY3QiID09IHR5cGVvZiBjKSBkID0gYSwgYiA9IGM7ZWxzZSB0aHJvdyBFcnJvcigiVW5rbm93biBjYWxsIGZvcm1hdCB0byBwYXRjaF9tYWtlLiIpOwogIGlmICgwID09PSBiLmxlbmd0aCkgcmV0dXJuIFtdOwogIGMgPSBbXTsKICBhID0gbmV3IGRpZmZfbWF0Y2hfcGF0Y2gucGF0Y2hfb2JqKCk7CiAgZm9yICh2YXIgZSA9IDAsIGYgPSAwLCBnID0gMCwgaCA9IGQsIGwgPSAwOyBsIDwgYi5sZW5ndGg7IGwrKykgewogICAgdmFyIGsgPSBiW2xdWzBdLAogICAgICBtID0gYltsXVsxXTsKICAgIGUgfHwgayA9PT0gRElGRl9FUVVBTCB8fCAoYS5zdGFydDEgPSBmLCBhLnN0YXJ0MiA9IGcpOwogICAgc3dpdGNoIChrKSB7CiAgICAgIGNhc2UgRElGRl9JTlNFUlQ6CiAgICAgICAgYS5kaWZmc1tlKytdID0gYltsXTsKICAgICAgICBhLmxlbmd0aDIgKz0gbS5sZW5ndGg7CiAgICAgICAgZCA9IGQuc3Vic3RyaW5nKDAsIGcpICsgbSArIGQuc3Vic3RyaW5nKGcpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIERJRkZfREVMRVRFOgogICAgICAgIGEubGVuZ3RoMSArPSBtLmxlbmd0aDsKICAgICAgICBhLmRpZmZzW2UrK10gPSBiW2xdOwogICAgICAgIGQgPSBkLnN1YnN0cmluZygwLCBnKSArIGQuc3Vic3RyaW5nKGcgKyBtLmxlbmd0aCk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgRElGRl9FUVVBTDoKICAgICAgICBtLmxlbmd0aCA8PSAyICogdGhpcy5QYXRjaF9NYXJnaW4gJiYgZSAmJiBiLmxlbmd0aCAhPSBsICsgMSA/IChhLmRpZmZzW2UrK10gPSBiW2xdLCBhLmxlbmd0aDEgKz0gbS5sZW5ndGgsIGEubGVuZ3RoMiArPSBtLmxlbmd0aCkgOiBtLmxlbmd0aCA+PSAyICogdGhpcy5QYXRjaF9NYXJnaW4gJiYgZSAmJiAodGhpcy5wYXRjaF9hZGRDb250ZXh0XyhhLCBoKSwgYy5wdXNoKGEpLCBhID0gbmV3IGRpZmZfbWF0Y2hfcGF0Y2gucGF0Y2hfb2JqKCksIGUgPSAwLCBoID0gZCwgZiA9IGcpOwogICAgfQogICAgayAhPT0gRElGRl9JTlNFUlQgJiYgKGYgKz0gbS5sZW5ndGgpOwogICAgayAhPT0gRElGRl9ERUxFVEUgJiYgKGcgKz0gbS5sZW5ndGgpOwogIH0KICBlICYmICh0aGlzLnBhdGNoX2FkZENvbnRleHRfKGEsIGgpLCBjLnB1c2goYSkpOwogIHJldHVybiBjOwp9OwpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5wYXRjaF9kZWVwQ29weSA9IGZ1bmN0aW9uIChhKSB7CiAgZm9yICh2YXIgYiA9IFtdLCBjID0gMDsgYyA8IGEubGVuZ3RoOyBjKyspIHsKICAgIHZhciBkID0gYVtjXSwKICAgICAgZSA9IG5ldyBkaWZmX21hdGNoX3BhdGNoLnBhdGNoX29iaigpOwogICAgZS5kaWZmcyA9IFtdOwogICAgZm9yICh2YXIgZiA9IDA7IGYgPCBkLmRpZmZzLmxlbmd0aDsgZisrKSBlLmRpZmZzW2ZdID0gbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihkLmRpZmZzW2ZdWzBdLCBkLmRpZmZzW2ZdWzFdKTsKICAgIGUuc3RhcnQxID0gZC5zdGFydDE7CiAgICBlLnN0YXJ0MiA9IGQuc3RhcnQyOwogICAgZS5sZW5ndGgxID0gZC5sZW5ndGgxOwogICAgZS5sZW5ndGgyID0gZC5sZW5ndGgyOwogICAgYltjXSA9IGU7CiAgfQogIHJldHVybiBiOwp9OwpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5wYXRjaF9hcHBseSA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgaWYgKDAgPT0gYS5sZW5ndGgpIHJldHVybiBbYiwgW11dOwogIGEgPSB0aGlzLnBhdGNoX2RlZXBDb3B5KGEpOwogIHZhciBjID0gdGhpcy5wYXRjaF9hZGRQYWRkaW5nKGEpOwogIGIgPSBjICsgYiArIGM7CiAgdGhpcy5wYXRjaF9zcGxpdE1heChhKTsKICBmb3IgKHZhciBkID0gMCwgZSA9IFtdLCBmID0gMDsgZiA8IGEubGVuZ3RoOyBmKyspIHsKICAgIHZhciBnID0gYVtmXS5zdGFydDIgKyBkLAogICAgICBoID0gdGhpcy5kaWZmX3RleHQxKGFbZl0uZGlmZnMpLAogICAgICBsID0gLTE7CiAgICBpZiAoaC5sZW5ndGggPiB0aGlzLk1hdGNoX01heEJpdHMpIHsKICAgICAgdmFyIGsgPSB0aGlzLm1hdGNoX21haW4oYiwgaC5zdWJzdHJpbmcoMCwgdGhpcy5NYXRjaF9NYXhCaXRzKSwgZyk7CiAgICAgIC0xICE9IGsgJiYgKGwgPSB0aGlzLm1hdGNoX21haW4oYiwgaC5zdWJzdHJpbmcoaC5sZW5ndGggLSB0aGlzLk1hdGNoX01heEJpdHMpLCBnICsgaC5sZW5ndGggLSB0aGlzLk1hdGNoX01heEJpdHMpLCAtMSA9PSBsIHx8IGsgPj0gbCkgJiYgKGsgPSAtMSk7CiAgICB9IGVsc2UgayA9IHRoaXMubWF0Y2hfbWFpbihiLCBoLCBnKTsKICAgIGlmICgtMSA9PSBrKSBlW2ZdID0gITEsIGQgLT0gYVtmXS5sZW5ndGgyIC0gYVtmXS5sZW5ndGgxO2Vsc2UgaWYgKGVbZl0gPSAhMCwgZCA9IGsgLSBnLCBnID0gLTEgPT0gbCA/IGIuc3Vic3RyaW5nKGssIGsgKyBoLmxlbmd0aCkgOiBiLnN1YnN0cmluZyhrLCBsICsgdGhpcy5NYXRjaF9NYXhCaXRzKSwgaCA9PSBnKSBiID0gYi5zdWJzdHJpbmcoMCwgaykgKyB0aGlzLmRpZmZfdGV4dDIoYVtmXS5kaWZmcykgKyBiLnN1YnN0cmluZyhrICsgaC5sZW5ndGgpO2Vsc2UgaWYgKGcgPSB0aGlzLmRpZmZfbWFpbihoLCBnLCAhMSksIGgubGVuZ3RoID4gdGhpcy5NYXRjaF9NYXhCaXRzICYmIHRoaXMuZGlmZl9sZXZlbnNodGVpbihnKSAvIGgubGVuZ3RoID4gdGhpcy5QYXRjaF9EZWxldGVUaHJlc2hvbGQpIGVbZl0gPSAhMTtlbHNlIHsKICAgICAgdGhpcy5kaWZmX2NsZWFudXBTZW1hbnRpY0xvc3NsZXNzKGcpOwogICAgICBoID0gMDsKICAgICAgdmFyIG07CiAgICAgIGZvciAobCA9IDA7IGwgPCBhW2ZdLmRpZmZzLmxlbmd0aDsgbCsrKSB7CiAgICAgICAgdmFyIHAgPSBhW2ZdLmRpZmZzW2xdOwogICAgICAgIHBbMF0gIT09IERJRkZfRVFVQUwgJiYgKG0gPSB0aGlzLmRpZmZfeEluZGV4KGcsIGgpKTsKICAgICAgICBwWzBdID09PSBESUZGX0lOU0VSVCA/IGIgPSBiLnN1YnN0cmluZygwLCBrICsgbSkgKyBwWzFdICsgYi5zdWJzdHJpbmcoayArIG0pIDogcFswXSA9PT0gRElGRl9ERUxFVEUgJiYgKGIgPSBiLnN1YnN0cmluZygwLCBrICsgbSkgKyBiLnN1YnN0cmluZyhrICsgdGhpcy5kaWZmX3hJbmRleChnLCBoICsgcFsxXS5sZW5ndGgpKSk7CiAgICAgICAgcFswXSAhPT0gRElGRl9ERUxFVEUgJiYgKGggKz0gcFsxXS5sZW5ndGgpOwogICAgICB9CiAgICB9CiAgfQogIGIgPSBiLnN1YnN0cmluZyhjLmxlbmd0aCwgYi5sZW5ndGggLSBjLmxlbmd0aCk7CiAgcmV0dXJuIFtiLCBlXTsKfTsKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUucGF0Y2hfYWRkUGFkZGluZyA9IGZ1bmN0aW9uIChhKSB7CiAgZm9yICh2YXIgYiA9IHRoaXMuUGF0Y2hfTWFyZ2luLCBjID0gIiIsIGQgPSAxOyBkIDw9IGI7IGQrKykgYyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGQpOwogIGZvciAoZCA9IDA7IGQgPCBhLmxlbmd0aDsgZCsrKSBhW2RdLnN0YXJ0MSArPSBiLCBhW2RdLnN0YXJ0MiArPSBiOwogIGQgPSBhWzBdOwogIHZhciBlID0gZC5kaWZmczsKICBpZiAoMCA9PSBlLmxlbmd0aCB8fCBlWzBdWzBdICE9IERJRkZfRVFVQUwpIGUudW5zaGlmdChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGMpKSwgZC5zdGFydDEgLT0gYiwgZC5zdGFydDIgLT0gYiwgZC5sZW5ndGgxICs9IGIsIGQubGVuZ3RoMiArPSBiO2Vsc2UgaWYgKGIgPiBlWzBdWzFdLmxlbmd0aCkgewogICAgdmFyIGYgPSBiIC0gZVswXVsxXS5sZW5ndGg7CiAgICBlWzBdWzFdID0gYy5zdWJzdHJpbmcoZVswXVsxXS5sZW5ndGgpICsgZVswXVsxXTsKICAgIGQuc3RhcnQxIC09IGY7CiAgICBkLnN0YXJ0MiAtPSBmOwogICAgZC5sZW5ndGgxICs9IGY7CiAgICBkLmxlbmd0aDIgKz0gZjsKICB9CiAgZCA9IGFbYS5sZW5ndGggLSAxXTsKICBlID0gZC5kaWZmczsKICAwID09IGUubGVuZ3RoIHx8IGVbZS5sZW5ndGggLSAxXVswXSAhPSBESUZGX0VRVUFMID8gKGUucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGMpKSwgZC5sZW5ndGgxICs9IGIsIGQubGVuZ3RoMiArPSBiKSA6IGIgPiBlW2UubGVuZ3RoIC0gMV1bMV0ubGVuZ3RoICYmIChmID0gYiAtIGVbZS5sZW5ndGggLSAxXVsxXS5sZW5ndGgsIGVbZS5sZW5ndGggLSAxXVsxXSArPSBjLnN1YnN0cmluZygwLCBmKSwgZC5sZW5ndGgxICs9IGYsIGQubGVuZ3RoMiArPSBmKTsKICByZXR1cm4gYzsKfTsKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUucGF0Y2hfc3BsaXRNYXggPSBmdW5jdGlvbiAoYSkgewogIGZvciAodmFyIGIgPSB0aGlzLk1hdGNoX01heEJpdHMsIGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykgaWYgKCEoYVtjXS5sZW5ndGgxIDw9IGIpKSB7CiAgICB2YXIgZCA9IGFbY107CiAgICBhLnNwbGljZShjLS0sIDEpOwogICAgZm9yICh2YXIgZSA9IGQuc3RhcnQxLCBmID0gZC5zdGFydDIsIGcgPSAiIjsgMCAhPT0gZC5kaWZmcy5sZW5ndGg7KSB7CiAgICAgIHZhciBoID0gbmV3IGRpZmZfbWF0Y2hfcGF0Y2gucGF0Y2hfb2JqKCksCiAgICAgICAgbCA9ICEwOwogICAgICBoLnN0YXJ0MSA9IGUgLSBnLmxlbmd0aDsKICAgICAgaC5zdGFydDIgPSBmIC0gZy5sZW5ndGg7CiAgICAgICIiICE9PSBnICYmIChoLmxlbmd0aDEgPSBoLmxlbmd0aDIgPSBnLmxlbmd0aCwgaC5kaWZmcy5wdXNoKG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgZykpKTsKICAgICAgZm9yICg7IDAgIT09IGQuZGlmZnMubGVuZ3RoICYmIGgubGVuZ3RoMSA8IGIgLSB0aGlzLlBhdGNoX01hcmdpbjspIHsKICAgICAgICBnID0gZC5kaWZmc1swXVswXTsKICAgICAgICB2YXIgayA9IGQuZGlmZnNbMF1bMV07CiAgICAgICAgZyA9PT0gRElGRl9JTlNFUlQgPyAoaC5sZW5ndGgyICs9IGsubGVuZ3RoLCBmICs9IGsubGVuZ3RoLCBoLmRpZmZzLnB1c2goZC5kaWZmcy5zaGlmdCgpKSwgbCA9ICExKSA6IGcgPT09IERJRkZfREVMRVRFICYmIDEgPT0gaC5kaWZmcy5sZW5ndGggJiYgaC5kaWZmc1swXVswXSA9PSBESUZGX0VRVUFMICYmIGsubGVuZ3RoID4gMiAqIGIgPyAoaC5sZW5ndGgxICs9IGsubGVuZ3RoLCBlICs9IGsubGVuZ3RoLCBsID0gITEsIGguZGlmZnMucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKGcsIGspKSwgZC5kaWZmcy5zaGlmdCgpKSA6IChrID0gay5zdWJzdHJpbmcoMCwgYiAtIGgubGVuZ3RoMSAtIHRoaXMuUGF0Y2hfTWFyZ2luKSwgaC5sZW5ndGgxICs9IGsubGVuZ3RoLCBlICs9IGsubGVuZ3RoLCBnID09PSBESUZGX0VRVUFMID8gKGgubGVuZ3RoMiArPSBrLmxlbmd0aCwgZiArPSBrLmxlbmd0aCkgOiBsID0gITEsIGguZGlmZnMucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKGcsIGspKSwgayA9PSBkLmRpZmZzWzBdWzFdID8gZC5kaWZmcy5zaGlmdCgpIDogZC5kaWZmc1swXVsxXSA9IGQuZGlmZnNbMF1bMV0uc3Vic3RyaW5nKGsubGVuZ3RoKSk7CiAgICAgIH0KICAgICAgZyA9IHRoaXMuZGlmZl90ZXh0MihoLmRpZmZzKTsKICAgICAgZyA9IGcuc3Vic3RyaW5nKGcubGVuZ3RoIC0gdGhpcy5QYXRjaF9NYXJnaW4pOwogICAgICBrID0gdGhpcy5kaWZmX3RleHQxKGQuZGlmZnMpLnN1YnN0cmluZygwLCB0aGlzLlBhdGNoX01hcmdpbik7CiAgICAgICIiICE9PSBrICYmIChoLmxlbmd0aDEgKz0gay5sZW5ndGgsIGgubGVuZ3RoMiArPSBrLmxlbmd0aCwgMCAhPT0gaC5kaWZmcy5sZW5ndGggJiYgaC5kaWZmc1toLmRpZmZzLmxlbmd0aCAtIDFdWzBdID09PSBESUZGX0VRVUFMID8gaC5kaWZmc1toLmRpZmZzLmxlbmd0aCAtIDFdWzFdICs9IGsgOiBoLmRpZmZzLnB1c2gobmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBrKSkpOwogICAgICBsIHx8IGEuc3BsaWNlKCsrYywgMCwgaCk7CiAgICB9CiAgfQp9OwpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5wYXRjaF90b1RleHQgPSBmdW5jdGlvbiAoYSkgewogIGZvciAodmFyIGIgPSBbXSwgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSBiW2NdID0gYVtjXTsKICByZXR1cm4gYi5qb2luKCIiKTsKfTsKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUucGF0Y2hfZnJvbVRleHQgPSBmdW5jdGlvbiAoYSkgewogIHZhciBiID0gW107CiAgaWYgKCFhKSByZXR1cm4gYjsKICBhID0gYS5zcGxpdCgiXG4iKTsKICBmb3IgKHZhciBjID0gMCwgZCA9IC9eQEAgLShcZCspLD8oXGQqKSBcKyhcZCspLD8oXGQqKSBAQCQvOyBjIDwgYS5sZW5ndGg7KSB7CiAgICB2YXIgZSA9IGFbY10ubWF0Y2goZCk7CiAgICBpZiAoIWUpIHRocm93IEVycm9yKCJJbnZhbGlkIHBhdGNoIHN0cmluZzogIiArIGFbY10pOwogICAgdmFyIGYgPSBuZXcgZGlmZl9tYXRjaF9wYXRjaC5wYXRjaF9vYmooKTsKICAgIGIucHVzaChmKTsKICAgIGYuc3RhcnQxID0gcGFyc2VJbnQoZVsxXSwgMTApOwogICAgIiIgPT09IGVbMl0gPyAoZi5zdGFydDEtLSwgZi5sZW5ndGgxID0gMSkgOiAiMCIgPT0gZVsyXSA/IGYubGVuZ3RoMSA9IDAgOiAoZi5zdGFydDEtLSwgZi5sZW5ndGgxID0gcGFyc2VJbnQoZVsyXSwgMTApKTsKICAgIGYuc3RhcnQyID0gcGFyc2VJbnQoZVszXSwgMTApOwogICAgIiIgPT09IGVbNF0gPyAoZi5zdGFydDItLSwgZi5sZW5ndGgyID0gMSkgOiAiMCIgPT0gZVs0XSA/IGYubGVuZ3RoMiA9IDAgOiAoZi5zdGFydDItLSwgZi5sZW5ndGgyID0gcGFyc2VJbnQoZVs0XSwgMTApKTsKICAgIGZvciAoYysrOyBjIDwgYS5sZW5ndGg7KSB7CiAgICAgIGUgPSBhW2NdLmNoYXJBdCgwKTsKICAgICAgdHJ5IHsKICAgICAgICB2YXIgZyA9IGRlY29kZVVSSShhW2NdLnN1YnN0cmluZygxKSk7CiAgICAgIH0gY2F0Y2ggKGgpIHsKICAgICAgICB0aHJvdyBFcnJvcigiSWxsZWdhbCBlc2NhcGUgaW4gcGF0Y2hfZnJvbVRleHQ6ICIgKyBnKTsKICAgICAgfQogICAgICBpZiAoIi0iID09IGUpIGYuZGlmZnMucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfREVMRVRFLCBnKSk7ZWxzZSBpZiAoIisiID09IGUpIGYuZGlmZnMucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfSU5TRVJULCBnKSk7ZWxzZSBpZiAoIiAiID09IGUpIGYuZGlmZnMucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGcpKTtlbHNlIGlmICgiQCIgPT0gZSkgYnJlYWs7ZWxzZSBpZiAoIiIgIT09IGUpIHRocm93IEVycm9yKCdJbnZhbGlkIHBhdGNoIG1vZGUgIicgKyBlICsgJyIgaW46ICcgKyBnKTsKICAgICAgYysrOwogICAgfQogIH0KICByZXR1cm4gYjsKfTsKZGlmZl9tYXRjaF9wYXRjaC5wYXRjaF9vYmogPSBmdW5jdGlvbiAoKSB7CiAgdGhpcy5kaWZmcyA9IFtdOwogIHRoaXMuc3RhcnQyID0gdGhpcy5zdGFydDEgPSBudWxsOwogIHRoaXMubGVuZ3RoMiA9IHRoaXMubGVuZ3RoMSA9IDA7Cn07CmRpZmZfbWF0Y2hfcGF0Y2gucGF0Y2hfb2JqLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKICBmb3IgKHZhciBhID0gWyJAQCAtIiArICgwID09PSB0aGlzLmxlbmd0aDEgPyB0aGlzLnN0YXJ0MSArICIsMCIgOiAxID09IHRoaXMubGVuZ3RoMSA/IHRoaXMuc3RhcnQxICsgMSA6IHRoaXMuc3RhcnQxICsgMSArICIsIiArIHRoaXMubGVuZ3RoMSkgKyAiICsiICsgKDAgPT09IHRoaXMubGVuZ3RoMiA/IHRoaXMuc3RhcnQyICsgIiwwIiA6IDEgPT0gdGhpcy5sZW5ndGgyID8gdGhpcy5zdGFydDIgKyAxIDogdGhpcy5zdGFydDIgKyAxICsgIiwiICsgdGhpcy5sZW5ndGgyKSArICIgQEBcbiJdLCBiLCBjID0gMDsgYyA8IHRoaXMuZGlmZnMubGVuZ3RoOyBjKyspIHsKICAgIHN3aXRjaCAodGhpcy5kaWZmc1tjXVswXSkgewogICAgICBjYXNlIERJRkZfSU5TRVJUOgogICAgICAgIGIgPSAiKyI7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgRElGRl9ERUxFVEU6CiAgICAgICAgYiA9ICItIjsKICAgICAgICBicmVhazsKICAgICAgY2FzZSBESUZGX0VRVUFMOgogICAgICAgIGIgPSAiICI7CiAgICB9CiAgICBhW2MgKyAxXSA9IGIgKyBlbmNvZGVVUkkodGhpcy5kaWZmc1tjXVsxXSkgKyAiXG4iOwogIH0KICByZXR1cm4gYS5qb2luKCIiKS5yZXBsYWNlKC8lMjAvZywgIiAiKTsKfTsKdGhpcy5kaWZmX21hdGNoX3BhdGNoID0gZGlmZl9tYXRjaF9wYXRjaDsKdGhpcy5ESUZGX0RFTEVURSA9IERJRkZfREVMRVRFOwp0aGlzLkRJRkZfSU5TRVJUID0gRElGRl9JTlNFUlQ7CnRoaXMuRElGRl9FUVVBTCA9IERJRkZfRVFVQUw7CndpbmRvdy5kaWZmX21hdGNoX3BhdGNoID0gZGlmZl9tYXRjaF9wYXRjaDsKd2luZG93LkRJRkZfSU5TRVJUID0gRElGRl9JTlNFUlQ7CndpbmRvdy5ESUZGX0RFTEVURSA9IERJRkZfREVMRVRFOwp3aW5kb3cuRElGRl9FUVVBTCA9IERJRkZfRVFVQUw7"},null]}