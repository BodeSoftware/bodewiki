{"remainingRequest":"/Users/shanebeal/Desktop/bodewiki/node_modules/babel-loader/lib/index.js??ref--0-1!/Users/shanebeal/Desktop/bodewiki/client/libs/codemirror-merge/diff-match-patch.js","dependencies":[{"path":"/Users/shanebeal/Desktop/bodewiki/client/libs/codemirror-merge/diff-match-patch.js","mtime":1742769082000},{"path":"/Users/shanebeal/Desktop/bodewiki/.babelrc","mtime":1742797763162},{"path":"/Users/shanebeal/Desktop/bodewiki/node_modules/cache-loader/dist/cjs.js","mtime":1742797622487},{"path":"/Users/shanebeal/Desktop/bodewiki/node_modules/babel-loader/lib/index.js","mtime":1742797622325}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIGRpZmZfbWF0Y2hfcGF0Y2ggPSBmdW5jdGlvbiBkaWZmX21hdGNoX3BhdGNoKCkgewogIHRoaXMuRGlmZl9UaW1lb3V0ID0gMTsKICB0aGlzLkRpZmZfRWRpdENvc3QgPSA0OwogIHRoaXMuTWF0Y2hfVGhyZXNob2xkID0gLjU7CiAgdGhpcy5NYXRjaF9EaXN0YW5jZSA9IDFFMzsKICB0aGlzLlBhdGNoX0RlbGV0ZVRocmVzaG9sZCA9IC41OwogIHRoaXMuUGF0Y2hfTWFyZ2luID0gNDsKICB0aGlzLk1hdGNoX01heEJpdHMgPSAzMjsKfSwKICAgIERJRkZfREVMRVRFID0gLTEsCiAgICBESUZGX0lOU0VSVCA9IDEsCiAgICBESUZGX0VRVUFMID0gMDsKCmRpZmZfbWF0Y2hfcGF0Y2guRGlmZiA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgdGhpc1swXSA9IGE7CiAgdGhpc1sxXSA9IGI7Cn07CgpkaWZmX21hdGNoX3BhdGNoLkRpZmYucHJvdG90eXBlLmxlbmd0aCA9IDI7CgpkaWZmX21hdGNoX3BhdGNoLkRpZmYucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewogIHJldHVybiB0aGlzWzBdICsgIiwiICsgdGhpc1sxXTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfbWFpbiA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7CiAgInVuZGVmaW5lZCIgPT0gdHlwZW9mIGQgJiYgKGQgPSAwID49IHRoaXMuRGlmZl9UaW1lb3V0ID8gTnVtYmVyLk1BWF9WQUxVRSA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgMUUzICogdGhpcy5EaWZmX1RpbWVvdXQpOwogIGlmIChudWxsID09IGEgfHwgbnVsbCA9PSBiKSB0aHJvdyBFcnJvcigiTnVsbCBpbnB1dC4gKGRpZmZfbWFpbikiKTsKICBpZiAoYSA9PSBiKSByZXR1cm4gYSA/IFtuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGEpXSA6IFtdOwogICJ1bmRlZmluZWQiID09IHR5cGVvZiBjICYmIChjID0gITApOwogIHZhciBlID0gYywKICAgICAgZiA9IHRoaXMuZGlmZl9jb21tb25QcmVmaXgoYSwgYik7CiAgYyA9IGEuc3Vic3RyaW5nKDAsIGYpOwogIGEgPSBhLnN1YnN0cmluZyhmKTsKICBiID0gYi5zdWJzdHJpbmcoZik7CiAgZiA9IHRoaXMuZGlmZl9jb21tb25TdWZmaXgoYSwgYik7CiAgdmFyIGcgPSBhLnN1YnN0cmluZyhhLmxlbmd0aCAtIGYpOwogIGEgPSBhLnN1YnN0cmluZygwLCBhLmxlbmd0aCAtIGYpOwogIGIgPSBiLnN1YnN0cmluZygwLCBiLmxlbmd0aCAtIGYpOwogIGEgPSB0aGlzLmRpZmZfY29tcHV0ZV8oYSwgYiwgZSwgZCk7CiAgYyAmJiBhLnVuc2hpZnQobmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBjKSk7CiAgZyAmJiBhLnB1c2gobmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBnKSk7CiAgdGhpcy5kaWZmX2NsZWFudXBNZXJnZShhKTsKICByZXR1cm4gYTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY29tcHV0ZV8gPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgewogIGlmICghYSkgcmV0dXJuIFtuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfSU5TRVJULCBiKV07CiAgaWYgKCFiKSByZXR1cm4gW25ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9ERUxFVEUsIGEpXTsKICB2YXIgZSA9IGEubGVuZ3RoID4gYi5sZW5ndGggPyBhIDogYiwKICAgICAgZiA9IGEubGVuZ3RoID4gYi5sZW5ndGggPyBiIDogYSwKICAgICAgZyA9IGUuaW5kZXhPZihmKTsKICByZXR1cm4gLTEgIT0gZyA/IChjID0gW25ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9JTlNFUlQsIGUuc3Vic3RyaW5nKDAsIGcpKSwgbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBmKSwgbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0lOU0VSVCwgZS5zdWJzdHJpbmcoZyArIGYubGVuZ3RoKSldLCBhLmxlbmd0aCA+IGIubGVuZ3RoICYmIChjWzBdWzBdID0gY1syXVswXSA9IERJRkZfREVMRVRFKSwgYykgOiAxID09IGYubGVuZ3RoID8gW25ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9ERUxFVEUsIGEpLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfSU5TRVJULCBiKV0gOiAoZSA9IHRoaXMuZGlmZl9oYWxmTWF0Y2hfKGEsIGIpKSA/IChiID0gZVsxXSwgZiA9IGVbM10sIGEgPSBlWzRdLCBlID0gdGhpcy5kaWZmX21haW4oZVswXSwgZVsyXSwgYywgZCksIGMgPSB0aGlzLmRpZmZfbWFpbihiLCBmLCBjLCBkKSwgZS5jb25jYXQoW25ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgYSldLCBjKSkgOiBjICYmIDEwMCA8IGEubGVuZ3RoICYmIDEwMCA8IGIubGVuZ3RoID8gdGhpcy5kaWZmX2xpbmVNb2RlXyhhLCBiLCBkKSA6IHRoaXMuZGlmZl9iaXNlY3RfKGEsIGIsIGQpOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9saW5lTW9kZV8gPSBmdW5jdGlvbiAoYSwgYiwgYykgewogIHZhciBkID0gdGhpcy5kaWZmX2xpbmVzVG9DaGFyc18oYSwgYik7CiAgYSA9IGQuY2hhcnMxOwogIGIgPSBkLmNoYXJzMjsKICBkID0gZC5saW5lQXJyYXk7CiAgYSA9IHRoaXMuZGlmZl9tYWluKGEsIGIsICExLCBjKTsKICB0aGlzLmRpZmZfY2hhcnNUb0xpbmVzXyhhLCBkKTsKICB0aGlzLmRpZmZfY2xlYW51cFNlbWFudGljKGEpOwogIGEucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsICIiKSk7CgogIGZvciAodmFyIGUgPSBkID0gYiA9IDAsIGYgPSAiIiwgZyA9ICIiOyBiIDwgYS5sZW5ndGg7KSB7CiAgICBzd2l0Y2ggKGFbYl1bMF0pIHsKICAgICAgY2FzZSBESUZGX0lOU0VSVDoKICAgICAgICBlKys7CiAgICAgICAgZyArPSBhW2JdWzFdOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBESUZGX0RFTEVURToKICAgICAgICBkKys7CiAgICAgICAgZiArPSBhW2JdWzFdOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBESUZGX0VRVUFMOgogICAgICAgIGlmICgxIDw9IGQgJiYgMSA8PSBlKSB7CiAgICAgICAgICBhLnNwbGljZShiIC0gZCAtIGUsIGQgKyBlKTsKICAgICAgICAgIGIgPSBiIC0gZCAtIGU7CiAgICAgICAgICBkID0gdGhpcy5kaWZmX21haW4oZiwgZywgITEsIGMpOwoKICAgICAgICAgIGZvciAoZSA9IGQubGVuZ3RoIC0gMTsgMCA8PSBlOyBlLS0pIHsKICAgICAgICAgICAgYS5zcGxpY2UoYiwgMCwgZFtlXSk7CiAgICAgICAgICB9CgogICAgICAgICAgYiArPSBkLmxlbmd0aDsKICAgICAgICB9CgogICAgICAgIGQgPSBlID0gMDsKICAgICAgICBnID0gZiA9ICIiOwogICAgfQoKICAgIGIrKzsKICB9CgogIGEucG9wKCk7CiAgcmV0dXJuIGE7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2Jpc2VjdF8gPSBmdW5jdGlvbiAoYSwgYiwgYykgewogIGZvciAodmFyIGQgPSBhLmxlbmd0aCwgZSA9IGIubGVuZ3RoLCBmID0gTWF0aC5jZWlsKChkICsgZSkgLyAyKSwgZyA9IDIgKiBmLCBoID0gQXJyYXkoZyksIGwgPSBBcnJheShnKSwgayA9IDA7IGsgPCBnOyBrKyspIHsKICAgIGhba10gPSAtMSwgbFtrXSA9IC0xOwogIH0KCiAgaFtmICsgMV0gPSAwOwogIGxbZiArIDFdID0gMDsKICBrID0gZCAtIGU7CgogIGZvciAodmFyIG0gPSAwICE9IGsgJSAyLCBwID0gMCwgeCA9IDAsIHcgPSAwLCBxID0gMCwgdCA9IDA7IHQgPCBmICYmICEobmV3IERhdGUoKS5nZXRUaW1lKCkgPiBjKTsgdCsrKSB7CiAgICBmb3IgKHZhciB2ID0gLXQgKyBwOyB2IDw9IHQgLSB4OyB2ICs9IDIpIHsKICAgICAgdmFyIG4gPSBmICsgdjsKICAgICAgdmFyIHIgPSB2ID09IC10IHx8IHYgIT0gdCAmJiBoW24gLSAxXSA8IGhbbiArIDFdID8gaFtuICsgMV0gOiBoW24gLSAxXSArIDE7CgogICAgICBmb3IgKHZhciB5ID0gciAtIHY7IHIgPCBkICYmIHkgPCBlICYmIGEuY2hhckF0KHIpID09IGIuY2hhckF0KHkpOykgewogICAgICAgIHIrKywgeSsrOwogICAgICB9CgogICAgICBoW25dID0gcjsKICAgICAgaWYgKHIgPiBkKSB4ICs9IDI7ZWxzZSBpZiAoeSA+IGUpIHAgKz0gMjtlbHNlIGlmIChtICYmIChuID0gZiArIGsgLSB2LCAwIDw9IG4gJiYgbiA8IGcgJiYgLTEgIT0gbFtuXSkpIHsKICAgICAgICB2YXIgdSA9IGQgLSBsW25dOwogICAgICAgIGlmIChyID49IHUpIHJldHVybiB0aGlzLmRpZmZfYmlzZWN0U3BsaXRfKGEsIGIsIHIsIHksIGMpOwogICAgICB9CiAgICB9CgogICAgZm9yICh2ID0gLXQgKyB3OyB2IDw9IHQgLSBxOyB2ICs9IDIpIHsKICAgICAgbiA9IGYgKyB2OwogICAgICB1ID0gdiA9PSAtdCB8fCB2ICE9IHQgJiYgbFtuIC0gMV0gPCBsW24gKyAxXSA/IGxbbiArIDFdIDogbFtuIC0gMV0gKyAxOwoKICAgICAgZm9yIChyID0gdSAtIHY7IHUgPCBkICYmIHIgPCBlICYmIGEuY2hhckF0KGQgLSB1IC0gMSkgPT0gYi5jaGFyQXQoZSAtIHIgLSAxKTspIHsKICAgICAgICB1KyssIHIrKzsKICAgICAgfQoKICAgICAgbFtuXSA9IHU7CiAgICAgIGlmICh1ID4gZCkgcSArPSAyO2Vsc2UgaWYgKHIgPiBlKSB3ICs9IDI7ZWxzZSBpZiAoIW0gJiYgKG4gPSBmICsgayAtIHYsIDAgPD0gbiAmJiBuIDwgZyAmJiAtMSAhPSBoW25dICYmIChyID0gaFtuXSwgeSA9IGYgKyByIC0gbiwgdSA9IGQgLSB1LCByID49IHUpKSkgcmV0dXJuIHRoaXMuZGlmZl9iaXNlY3RTcGxpdF8oYSwgYiwgciwgeSwgYyk7CiAgICB9CiAgfQoKICByZXR1cm4gW25ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9ERUxFVEUsIGEpLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfSU5TRVJULCBiKV07Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2Jpc2VjdFNwbGl0XyA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkLCBlKSB7CiAgdmFyIGYgPSBhLnN1YnN0cmluZygwLCBjKSwKICAgICAgZyA9IGIuc3Vic3RyaW5nKDAsIGQpOwogIGEgPSBhLnN1YnN0cmluZyhjKTsKICBiID0gYi5zdWJzdHJpbmcoZCk7CiAgZiA9IHRoaXMuZGlmZl9tYWluKGYsIGcsICExLCBlKTsKICBlID0gdGhpcy5kaWZmX21haW4oYSwgYiwgITEsIGUpOwogIHJldHVybiBmLmNvbmNhdChlKTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfbGluZXNUb0NoYXJzXyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgZnVuY3Rpb24gYyhhKSB7CiAgICBmb3IgKHZhciBiID0gIiIsIGMgPSAwLCBnID0gLTEsIGggPSBkLmxlbmd0aDsgZyA8IGEubGVuZ3RoIC0gMTspIHsKICAgICAgZyA9IGEuaW5kZXhPZigiXG4iLCBjKTsKICAgICAgLTEgPT0gZyAmJiAoZyA9IGEubGVuZ3RoIC0gMSk7CiAgICAgIHZhciBsID0gYS5zdWJzdHJpbmcoYywgZyArIDEpOwogICAgICAoZS5oYXNPd25Qcm9wZXJ0eSA/IGUuaGFzT3duUHJvcGVydHkobCkgOiB2b2lkIDAgIT09IGVbbF0pID8gYiArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGVbbF0pIDogKGggPT0gZiAmJiAobCA9IGEuc3Vic3RyaW5nKGMpLCBnID0gYS5sZW5ndGgpLCBiICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoaCksIGVbbF0gPSBoLCBkW2grK10gPSBsKTsKICAgICAgYyA9IGcgKyAxOwogICAgfQoKICAgIHJldHVybiBiOwogIH0KCiAgdmFyIGQgPSBbXSwKICAgICAgZSA9IHt9OwogIGRbMF0gPSAiIjsKICB2YXIgZiA9IDRFNCwKICAgICAgZyA9IGMoYSk7CiAgZiA9IDY1NTM1OwogIHZhciBoID0gYyhiKTsKICByZXR1cm4gewogICAgY2hhcnMxOiBnLAogICAgY2hhcnMyOiBoLAogICAgbGluZUFycmF5OiBkCiAgfTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY2hhcnNUb0xpbmVzXyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgZm9yICh2YXIgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSB7CiAgICBmb3IgKHZhciBkID0gYVtjXVsxXSwgZSA9IFtdLCBmID0gMDsgZiA8IGQubGVuZ3RoOyBmKyspIHsKICAgICAgZVtmXSA9IGJbZC5jaGFyQ29kZUF0KGYpXTsKICAgIH0KCiAgICBhW2NdWzFdID0gZS5qb2luKCIiKTsKICB9Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2NvbW1vblByZWZpeCA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgaWYgKCFhIHx8ICFiIHx8IGEuY2hhckF0KDApICE9IGIuY2hhckF0KDApKSByZXR1cm4gMDsKCiAgZm9yICh2YXIgYyA9IDAsIGQgPSBNYXRoLm1pbihhLmxlbmd0aCwgYi5sZW5ndGgpLCBlID0gZCwgZiA9IDA7IGMgPCBlOykgewogICAgYS5zdWJzdHJpbmcoZiwgZSkgPT0gYi5zdWJzdHJpbmcoZiwgZSkgPyBmID0gYyA9IGUgOiBkID0gZSwgZSA9IE1hdGguZmxvb3IoKGQgLSBjKSAvIDIgKyBjKTsKICB9CgogIHJldHVybiBlOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9jb21tb25TdWZmaXggPSBmdW5jdGlvbiAoYSwgYikgewogIGlmICghYSB8fCAhYiB8fCBhLmNoYXJBdChhLmxlbmd0aCAtIDEpICE9IGIuY2hhckF0KGIubGVuZ3RoIC0gMSkpIHJldHVybiAwOwoKICBmb3IgKHZhciBjID0gMCwgZCA9IE1hdGgubWluKGEubGVuZ3RoLCBiLmxlbmd0aCksIGUgPSBkLCBmID0gMDsgYyA8IGU7KSB7CiAgICBhLnN1YnN0cmluZyhhLmxlbmd0aCAtIGUsIGEubGVuZ3RoIC0gZikgPT0gYi5zdWJzdHJpbmcoYi5sZW5ndGggLSBlLCBiLmxlbmd0aCAtIGYpID8gZiA9IGMgPSBlIDogZCA9IGUsIGUgPSBNYXRoLmZsb29yKChkIC0gYykgLyAyICsgYyk7CiAgfQoKICByZXR1cm4gZTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY29tbW9uT3ZlcmxhcF8gPSBmdW5jdGlvbiAoYSwgYikgewogIHZhciBjID0gYS5sZW5ndGgsCiAgICAgIGQgPSBiLmxlbmd0aDsKICBpZiAoMCA9PSBjIHx8IDAgPT0gZCkgcmV0dXJuIDA7CiAgYyA+IGQgPyBhID0gYS5zdWJzdHJpbmcoYyAtIGQpIDogYyA8IGQgJiYgKGIgPSBiLnN1YnN0cmluZygwLCBjKSk7CiAgYyA9IE1hdGgubWluKGMsIGQpOwogIGlmIChhID09IGIpIHJldHVybiBjOwogIGQgPSAwOwoKICBmb3IgKHZhciBlID0gMTs7KSB7CiAgICB2YXIgZiA9IGEuc3Vic3RyaW5nKGMgLSBlKTsKICAgIGYgPSBiLmluZGV4T2YoZik7CiAgICBpZiAoLTEgPT0gZikgcmV0dXJuIGQ7CiAgICBlICs9IGY7CiAgICBpZiAoMCA9PSBmIHx8IGEuc3Vic3RyaW5nKGMgLSBlKSA9PSBiLnN1YnN0cmluZygwLCBlKSkgZCA9IGUsIGUrKzsKICB9Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2hhbGZNYXRjaF8gPSBmdW5jdGlvbiAoYSwgYikgewogIGZ1bmN0aW9uIGMoYSwgYiwgYykgewogICAgZm9yICh2YXIgZCA9IGEuc3Vic3RyaW5nKGMsIGMgKyBNYXRoLmZsb29yKGEubGVuZ3RoIC8gNCkpLCBlID0gLTEsIGcgPSAiIiwgaCwgaywgbCwgbTsgLTEgIT0gKGUgPSBiLmluZGV4T2YoZCwgZSArIDEpKTspIHsKICAgICAgdmFyIHAgPSBmLmRpZmZfY29tbW9uUHJlZml4KGEuc3Vic3RyaW5nKGMpLCBiLnN1YnN0cmluZyhlKSksCiAgICAgICAgICB1ID0gZi5kaWZmX2NvbW1vblN1ZmZpeChhLnN1YnN0cmluZygwLCBjKSwgYi5zdWJzdHJpbmcoMCwgZSkpOwogICAgICBnLmxlbmd0aCA8IHUgKyBwICYmIChnID0gYi5zdWJzdHJpbmcoZSAtIHUsIGUpICsgYi5zdWJzdHJpbmcoZSwgZSArIHApLCBoID0gYS5zdWJzdHJpbmcoMCwgYyAtIHUpLCBrID0gYS5zdWJzdHJpbmcoYyArIHApLCBsID0gYi5zdWJzdHJpbmcoMCwgZSAtIHUpLCBtID0gYi5zdWJzdHJpbmcoZSArIHApKTsKICAgIH0KCiAgICByZXR1cm4gMiAqIGcubGVuZ3RoID49IGEubGVuZ3RoID8gW2gsIGssIGwsIG0sIGddIDogbnVsbDsKICB9CgogIGlmICgwID49IHRoaXMuRGlmZl9UaW1lb3V0KSByZXR1cm4gbnVsbDsKICB2YXIgZCA9IGEubGVuZ3RoID4gYi5sZW5ndGggPyBhIDogYiwKICAgICAgZSA9IGEubGVuZ3RoID4gYi5sZW5ndGggPyBiIDogYTsKICBpZiAoNCA+IGQubGVuZ3RoIHx8IDIgKiBlLmxlbmd0aCA8IGQubGVuZ3RoKSByZXR1cm4gbnVsbDsKICB2YXIgZiA9IHRoaXMsCiAgICAgIGcgPSBjKGQsIGUsIE1hdGguY2VpbChkLmxlbmd0aCAvIDQpKTsKICBkID0gYyhkLCBlLCBNYXRoLmNlaWwoZC5sZW5ndGggLyAyKSk7CiAgaWYgKGcgfHwgZCkgZyA9IGQgPyBnID8gZ1s0XS5sZW5ndGggPiBkWzRdLmxlbmd0aCA/IGcgOiBkIDogZCA6IGc7ZWxzZSByZXR1cm4gbnVsbDsKCiAgaWYgKGEubGVuZ3RoID4gYi5sZW5ndGgpIHsKICAgIGQgPSBnWzBdOwogICAgZSA9IGdbMV07CiAgICB2YXIgaCA9IGdbMl07CiAgICB2YXIgbCA9IGdbM107CiAgfSBlbHNlIGggPSBnWzBdLCBsID0gZ1sxXSwgZCA9IGdbMl0sIGUgPSBnWzNdOwoKICByZXR1cm4gW2QsIGUsIGgsIGwsIGdbNF1dOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl9jbGVhbnVwU2VtYW50aWMgPSBmdW5jdGlvbiAoYSkgewogIGZvciAodmFyIGIgPSAhMSwgYyA9IFtdLCBkID0gMCwgZSA9IG51bGwsIGYgPSAwLCBnID0gMCwgaCA9IDAsIGwgPSAwLCBrID0gMDsgZiA8IGEubGVuZ3RoOykgewogICAgYVtmXVswXSA9PSBESUZGX0VRVUFMID8gKGNbZCsrXSA9IGYsIGcgPSBsLCBoID0gaywgayA9IGwgPSAwLCBlID0gYVtmXVsxXSkgOiAoYVtmXVswXSA9PSBESUZGX0lOU0VSVCA/IGwgKz0gYVtmXVsxXS5sZW5ndGggOiBrICs9IGFbZl1bMV0ubGVuZ3RoLCBlICYmIGUubGVuZ3RoIDw9IE1hdGgubWF4KGcsIGgpICYmIGUubGVuZ3RoIDw9IE1hdGgubWF4KGwsIGspICYmIChhLnNwbGljZShjW2QgLSAxXSwgMCwgbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0RFTEVURSwgZSkpLCBhW2NbZCAtIDFdICsgMV1bMF0gPSBESUZGX0lOU0VSVCwgZC0tLCBkLS0sIGYgPSAwIDwgZCA/IGNbZCAtIDFdIDogLTEsIGsgPSBsID0gaCA9IGcgPSAwLCBlID0gbnVsbCwgYiA9ICEwKSksIGYrKzsKICB9CgogIGIgJiYgdGhpcy5kaWZmX2NsZWFudXBNZXJnZShhKTsKICB0aGlzLmRpZmZfY2xlYW51cFNlbWFudGljTG9zc2xlc3MoYSk7CgogIGZvciAoZiA9IDE7IGYgPCBhLmxlbmd0aDspIHsKICAgIGlmIChhW2YgLSAxXVswXSA9PSBESUZGX0RFTEVURSAmJiBhW2ZdWzBdID09IERJRkZfSU5TRVJUKSB7CiAgICAgIGIgPSBhW2YgLSAxXVsxXTsKICAgICAgYyA9IGFbZl1bMV07CiAgICAgIGQgPSB0aGlzLmRpZmZfY29tbW9uT3ZlcmxhcF8oYiwgYyk7CiAgICAgIGUgPSB0aGlzLmRpZmZfY29tbW9uT3ZlcmxhcF8oYywgYik7CgogICAgICBpZiAoZCA+PSBlKSB7CiAgICAgICAgaWYgKGQgPj0gYi5sZW5ndGggLyAyIHx8IGQgPj0gYy5sZW5ndGggLyAyKSBhLnNwbGljZShmLCAwLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGMuc3Vic3RyaW5nKDAsIGQpKSksIGFbZiAtIDFdWzFdID0gYi5zdWJzdHJpbmcoMCwgYi5sZW5ndGggLSBkKSwgYVtmICsgMV1bMV0gPSBjLnN1YnN0cmluZyhkKSwgZisrOwogICAgICB9IGVsc2UgaWYgKGUgPj0gYi5sZW5ndGggLyAyIHx8IGUgPj0gYy5sZW5ndGggLyAyKSBhLnNwbGljZShmLCAwLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGIuc3Vic3RyaW5nKDAsIGUpKSksIGFbZiAtIDFdWzBdID0gRElGRl9JTlNFUlQsIGFbZiAtIDFdWzFdID0gYy5zdWJzdHJpbmcoMCwgYy5sZW5ndGggLSBlKSwgYVtmICsgMV1bMF0gPSBESUZGX0RFTEVURSwgYVtmICsgMV1bMV0gPSBiLnN1YnN0cmluZyhlKSwgZisrOwoKICAgICAgZisrOwogICAgfQoKICAgIGYrKzsKICB9Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2NsZWFudXBTZW1hbnRpY0xvc3NsZXNzID0gZnVuY3Rpb24gKGEpIHsKICBmdW5jdGlvbiBiKGEsIGIpIHsKICAgIGlmICghYSB8fCAhYikgcmV0dXJuIDY7CiAgICB2YXIgYyA9IGEuY2hhckF0KGEubGVuZ3RoIC0gMSksCiAgICAgICAgZCA9IGIuY2hhckF0KDApLAogICAgICAgIGUgPSBjLm1hdGNoKGRpZmZfbWF0Y2hfcGF0Y2gubm9uQWxwaGFOdW1lcmljUmVnZXhfKSwKICAgICAgICBmID0gZC5tYXRjaChkaWZmX21hdGNoX3BhdGNoLm5vbkFscGhhTnVtZXJpY1JlZ2V4XyksCiAgICAgICAgZyA9IGUgJiYgYy5tYXRjaChkaWZmX21hdGNoX3BhdGNoLndoaXRlc3BhY2VSZWdleF8pLAogICAgICAgIGggPSBmICYmIGQubWF0Y2goZGlmZl9tYXRjaF9wYXRjaC53aGl0ZXNwYWNlUmVnZXhfKTsKICAgIGMgPSBnICYmIGMubWF0Y2goZGlmZl9tYXRjaF9wYXRjaC5saW5lYnJlYWtSZWdleF8pOwogICAgZCA9IGggJiYgZC5tYXRjaChkaWZmX21hdGNoX3BhdGNoLmxpbmVicmVha1JlZ2V4Xyk7CiAgICB2YXIgayA9IGMgJiYgYS5tYXRjaChkaWZmX21hdGNoX3BhdGNoLmJsYW5rbGluZUVuZFJlZ2V4XyksCiAgICAgICAgbCA9IGQgJiYgYi5tYXRjaChkaWZmX21hdGNoX3BhdGNoLmJsYW5rbGluZVN0YXJ0UmVnZXhfKTsKICAgIHJldHVybiBrIHx8IGwgPyA1IDogYyB8fCBkID8gNCA6IGUgJiYgIWcgJiYgaCA/IDMgOiBnIHx8IGggPyAyIDogZSB8fCBmID8gMSA6IDA7CiAgfQoKICBmb3IgKHZhciBjID0gMTsgYyA8IGEubGVuZ3RoIC0gMTspIHsKICAgIGlmIChhW2MgLSAxXVswXSA9PSBESUZGX0VRVUFMICYmIGFbYyArIDFdWzBdID09IERJRkZfRVFVQUwpIHsKICAgICAgdmFyIGQgPSBhW2MgLSAxXVsxXSwKICAgICAgICAgIGUgPSBhW2NdWzFdLAogICAgICAgICAgZiA9IGFbYyArIDFdWzFdLAogICAgICAgICAgZyA9IHRoaXMuZGlmZl9jb21tb25TdWZmaXgoZCwgZSk7CgogICAgICBpZiAoZykgewogICAgICAgIHZhciBoID0gZS5zdWJzdHJpbmcoZS5sZW5ndGggLSBnKTsKICAgICAgICBkID0gZC5zdWJzdHJpbmcoMCwgZC5sZW5ndGggLSBnKTsKICAgICAgICBlID0gaCArIGUuc3Vic3RyaW5nKDAsIGUubGVuZ3RoIC0gZyk7CiAgICAgICAgZiA9IGggKyBmOwogICAgICB9CgogICAgICBnID0gZDsKICAgICAgaCA9IGU7CgogICAgICBmb3IgKHZhciBsID0gZiwgayA9IGIoZCwgZSkgKyBiKGUsIGYpOyBlLmNoYXJBdCgwKSA9PT0gZi5jaGFyQXQoMCk7KSB7CiAgICAgICAgZCArPSBlLmNoYXJBdCgwKTsKICAgICAgICBlID0gZS5zdWJzdHJpbmcoMSkgKyBmLmNoYXJBdCgwKTsKICAgICAgICBmID0gZi5zdWJzdHJpbmcoMSk7CiAgICAgICAgdmFyIG0gPSBiKGQsIGUpICsgYihlLCBmKTsKICAgICAgICBtID49IGsgJiYgKGsgPSBtLCBnID0gZCwgaCA9IGUsIGwgPSBmKTsKICAgICAgfQoKICAgICAgYVtjIC0gMV1bMV0gIT0gZyAmJiAoZyA/IGFbYyAtIDFdWzFdID0gZyA6IChhLnNwbGljZShjIC0gMSwgMSksIGMtLSksIGFbY11bMV0gPSBoLCBsID8gYVtjICsgMV1bMV0gPSBsIDogKGEuc3BsaWNlKGMgKyAxLCAxKSwgYy0tKSk7CiAgICB9CgogICAgYysrOwogIH0KfTsKCmRpZmZfbWF0Y2hfcGF0Y2gubm9uQWxwaGFOdW1lcmljUmVnZXhfID0gL1teYS16QS1aMC05XS87CmRpZmZfbWF0Y2hfcGF0Y2gud2hpdGVzcGFjZVJlZ2V4XyA9IC9ccy87CmRpZmZfbWF0Y2hfcGF0Y2gubGluZWJyZWFrUmVnZXhfID0gL1tcclxuXS87CmRpZmZfbWF0Y2hfcGF0Y2guYmxhbmtsaW5lRW5kUmVnZXhfID0gL1xuXHI/XG4kLzsKZGlmZl9tYXRjaF9wYXRjaC5ibGFua2xpbmVTdGFydFJlZ2V4XyA9IC9eXHI/XG5ccj9cbi87CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2NsZWFudXBFZmZpY2llbmN5ID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0gITEsIGMgPSBbXSwgZCA9IDAsIGUgPSBudWxsLCBmID0gMCwgZyA9ICExLCBoID0gITEsIGwgPSAhMSwgayA9ICExOyBmIDwgYS5sZW5ndGg7KSB7CiAgICBhW2ZdWzBdID09IERJRkZfRVFVQUwgPyAoYVtmXVsxXS5sZW5ndGggPCB0aGlzLkRpZmZfRWRpdENvc3QgJiYgKGwgfHwgaykgPyAoY1tkKytdID0gZiwgZyA9IGwsIGggPSBrLCBlID0gYVtmXVsxXSkgOiAoZCA9IDAsIGUgPSBudWxsKSwgbCA9IGsgPSAhMSkgOiAoYVtmXVswXSA9PSBESUZGX0RFTEVURSA/IGsgPSAhMCA6IGwgPSAhMCwgZSAmJiAoZyAmJiBoICYmIGwgJiYgayB8fCBlLmxlbmd0aCA8IHRoaXMuRGlmZl9FZGl0Q29zdCAvIDIgJiYgMyA9PSBnICsgaCArIGwgKyBrKSAmJiAoYS5zcGxpY2UoY1tkIC0gMV0sIDAsIG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9ERUxFVEUsIGUpKSwgYVtjW2QgLSAxXSArIDFdWzBdID0gRElGRl9JTlNFUlQsIGQtLSwgZSA9IG51bGwsIGcgJiYgaCA/IChsID0gayA9ICEwLCBkID0gMCkgOiAoZC0tLCBmID0gMCA8IGQgPyBjW2QgLSAxXSA6IC0xLCBsID0gayA9ICExKSwgYiA9ICEwKSksIGYrKzsKICB9CgogIGIgJiYgdGhpcy5kaWZmX2NsZWFudXBNZXJnZShhKTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfY2xlYW51cE1lcmdlID0gZnVuY3Rpb24gKGEpIHsKICBhLnB1c2gobmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCAiIikpOwoKICBmb3IgKHZhciBiID0gMCwgYyA9IDAsIGQgPSAwLCBlID0gIiIsIGYgPSAiIiwgZzsgYiA8IGEubGVuZ3RoOykgewogICAgc3dpdGNoIChhW2JdWzBdKSB7CiAgICAgIGNhc2UgRElGRl9JTlNFUlQ6CiAgICAgICAgZCsrOwogICAgICAgIGYgKz0gYVtiXVsxXTsKICAgICAgICBiKys7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIERJRkZfREVMRVRFOgogICAgICAgIGMrKzsKICAgICAgICBlICs9IGFbYl1bMV07CiAgICAgICAgYisrOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBESUZGX0VRVUFMOgogICAgICAgIDEgPCBjICsgZCA/ICgwICE9PSBjICYmIDAgIT09IGQgJiYgKGcgPSB0aGlzLmRpZmZfY29tbW9uUHJlZml4KGYsIGUpLCAwICE9PSBnICYmICgwIDwgYiAtIGMgLSBkICYmIGFbYiAtIGMgLSBkIC0gMV1bMF0gPT0gRElGRl9FUVVBTCA/IGFbYiAtIGMgLSBkIC0gMV1bMV0gKz0gZi5zdWJzdHJpbmcoMCwgZykgOiAoYS5zcGxpY2UoMCwgMCwgbmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBmLnN1YnN0cmluZygwLCBnKSkpLCBiKyspLCBmID0gZi5zdWJzdHJpbmcoZyksIGUgPSBlLnN1YnN0cmluZyhnKSksIGcgPSB0aGlzLmRpZmZfY29tbW9uU3VmZml4KGYsIGUpLCAwICE9PSBnICYmIChhW2JdWzFdID0gZi5zdWJzdHJpbmcoZi5sZW5ndGggLSBnKSArIGFbYl1bMV0sIGYgPSBmLnN1YnN0cmluZygwLCBmLmxlbmd0aCAtIGcpLCBlID0gZS5zdWJzdHJpbmcoMCwgZS5sZW5ndGggLSBnKSkpLCBiIC09IGMgKyBkLCBhLnNwbGljZShiLCBjICsgZCksIGUubGVuZ3RoICYmIChhLnNwbGljZShiLCAwLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfREVMRVRFLCBlKSksIGIrKyksIGYubGVuZ3RoICYmIChhLnNwbGljZShiLCAwLCBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfSU5TRVJULCBmKSksIGIrKyksIGIrKykgOiAwICE9PSBiICYmIGFbYiAtIDFdWzBdID09IERJRkZfRVFVQUwgPyAoYVtiIC0gMV1bMV0gKz0gYVtiXVsxXSwgYS5zcGxpY2UoYiwgMSkpIDogYisrLCBjID0gZCA9IDAsIGYgPSBlID0gIiI7CiAgICB9CiAgfQoKICAiIiA9PT0gYVthLmxlbmd0aCAtIDFdWzFdICYmIGEucG9wKCk7CiAgYyA9ICExOwoKICBmb3IgKGIgPSAxOyBiIDwgYS5sZW5ndGggLSAxOykgewogICAgYVtiIC0gMV1bMF0gPT0gRElGRl9FUVVBTCAmJiBhW2IgKyAxXVswXSA9PSBESUZGX0VRVUFMICYmIChhW2JdWzFdLnN1YnN0cmluZyhhW2JdWzFdLmxlbmd0aCAtIGFbYiAtIDFdWzFdLmxlbmd0aCkgPT0gYVtiIC0gMV1bMV0gPyAoYVtiXVsxXSA9IGFbYiAtIDFdWzFdICsgYVtiXVsxXS5zdWJzdHJpbmcoMCwgYVtiXVsxXS5sZW5ndGggLSBhW2IgLSAxXVsxXS5sZW5ndGgpLCBhW2IgKyAxXVsxXSA9IGFbYiAtIDFdWzFdICsgYVtiICsgMV1bMV0sIGEuc3BsaWNlKGIgLSAxLCAxKSwgYyA9ICEwKSA6IGFbYl1bMV0uc3Vic3RyaW5nKDAsIGFbYiArIDFdWzFdLmxlbmd0aCkgPT0gYVtiICsgMV1bMV0gJiYgKGFbYiAtIDFdWzFdICs9IGFbYiArIDFdWzFdLCBhW2JdWzFdID0gYVtiXVsxXS5zdWJzdHJpbmcoYVtiICsgMV1bMV0ubGVuZ3RoKSArIGFbYiArIDFdWzFdLCBhLnNwbGljZShiICsgMSwgMSksIGMgPSAhMCkpLCBiKys7CiAgfQoKICBjICYmIHRoaXMuZGlmZl9jbGVhbnVwTWVyZ2UoYSk7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX3hJbmRleCA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgdmFyIGMgPSAwLAogICAgICBkID0gMCwKICAgICAgZSA9IDAsCiAgICAgIGYgPSAwLAogICAgICBnOwoKICBmb3IgKGcgPSAwOyBnIDwgYS5sZW5ndGg7IGcrKykgewogICAgYVtnXVswXSAhPT0gRElGRl9JTlNFUlQgJiYgKGMgKz0gYVtnXVsxXS5sZW5ndGgpOwogICAgYVtnXVswXSAhPT0gRElGRl9ERUxFVEUgJiYgKGQgKz0gYVtnXVsxXS5sZW5ndGgpOwogICAgaWYgKGMgPiBiKSBicmVhazsKICAgIGUgPSBjOwogICAgZiA9IGQ7CiAgfQoKICByZXR1cm4gYS5sZW5ndGggIT0gZyAmJiBhW2ddWzBdID09PSBESUZGX0RFTEVURSA/IGYgOiBmICsgKGIgLSBlKTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfcHJldHR5SHRtbCA9IGZ1bmN0aW9uIChhKSB7CiAgZm9yICh2YXIgYiA9IFtdLCBjID0gLyYvZywgZCA9IC88L2csIGUgPSAvPi9nLCBmID0gL1xuL2csIGcgPSAwOyBnIDwgYS5sZW5ndGg7IGcrKykgewogICAgdmFyIGggPSBhW2ddWzBdLAogICAgICAgIGwgPSBhW2ddWzFdLnJlcGxhY2UoYywgIiZhbXA7IikucmVwbGFjZShkLCAiJmx0OyIpLnJlcGxhY2UoZSwgIiZndDsiKS5yZXBsYWNlKGYsICImcGFyYTs8YnI+Iik7CgogICAgc3dpdGNoIChoKSB7CiAgICAgIGNhc2UgRElGRl9JTlNFUlQ6CiAgICAgICAgYltnXSA9ICc8aW5zIHN0eWxlPSJiYWNrZ3JvdW5kOiNlNmZmZTY7Ij4nICsgbCArICI8L2lucz4iOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBESUZGX0RFTEVURToKICAgICAgICBiW2ddID0gJzxkZWwgc3R5bGU9ImJhY2tncm91bmQ6I2ZmZTZlNjsiPicgKyBsICsgIjwvZGVsPiI7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIERJRkZfRVFVQUw6CiAgICAgICAgYltnXSA9ICI8c3Bhbj4iICsgbCArICI8L3NwYW4+IjsKICAgIH0KICB9CgogIHJldHVybiBiLmpvaW4oIiIpOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl90ZXh0MSA9IGZ1bmN0aW9uIChhKSB7CiAgZm9yICh2YXIgYiA9IFtdLCBjID0gMDsgYyA8IGEubGVuZ3RoOyBjKyspIHsKICAgIGFbY11bMF0gIT09IERJRkZfSU5TRVJUICYmIChiW2NdID0gYVtjXVsxXSk7CiAgfQoKICByZXR1cm4gYi5qb2luKCIiKTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLmRpZmZfdGV4dDIgPSBmdW5jdGlvbiAoYSkgewogIGZvciAodmFyIGIgPSBbXSwgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSB7CiAgICBhW2NdWzBdICE9PSBESUZGX0RFTEVURSAmJiAoYltjXSA9IGFbY11bMV0pOwogIH0KCiAgcmV0dXJuIGIuam9pbigiIik7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2xldmVuc2h0ZWluID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0gMCwgYyA9IDAsIGQgPSAwLCBlID0gMDsgZSA8IGEubGVuZ3RoOyBlKyspIHsKICAgIHZhciBmID0gYVtlXVsxXTsKCiAgICBzd2l0Y2ggKGFbZV1bMF0pIHsKICAgICAgY2FzZSBESUZGX0lOU0VSVDoKICAgICAgICBjICs9IGYubGVuZ3RoOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBESUZGX0RFTEVURToKICAgICAgICBkICs9IGYubGVuZ3RoOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBESUZGX0VRVUFMOgogICAgICAgIGIgKz0gTWF0aC5tYXgoYywgZCksIGQgPSBjID0gMDsKICAgIH0KICB9CgogIHJldHVybiBiICs9IE1hdGgubWF4KGMsIGQpOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUuZGlmZl90b0RlbHRhID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0gW10sIGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykgewogICAgc3dpdGNoIChhW2NdWzBdKSB7CiAgICAgIGNhc2UgRElGRl9JTlNFUlQ6CiAgICAgICAgYltjXSA9ICIrIiArIGVuY29kZVVSSShhW2NdWzFdKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgRElGRl9ERUxFVEU6CiAgICAgICAgYltjXSA9ICItIiArIGFbY11bMV0ubGVuZ3RoOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBESUZGX0VRVUFMOgogICAgICAgIGJbY10gPSAiPSIgKyBhW2NdWzFdLmxlbmd0aDsKICAgIH0KICB9CgogIHJldHVybiBiLmpvaW4oIlx0IikucmVwbGFjZSgvJTIwL2csICIgIik7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5kaWZmX2Zyb21EZWx0YSA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgZm9yICh2YXIgYyA9IFtdLCBkID0gMCwgZSA9IDAsIGYgPSBiLnNwbGl0KC9cdC9nKSwgZyA9IDA7IGcgPCBmLmxlbmd0aDsgZysrKSB7CiAgICB2YXIgaCA9IGZbZ10uc3Vic3RyaW5nKDEpOwoKICAgIHN3aXRjaCAoZltnXS5jaGFyQXQoMCkpIHsKICAgICAgY2FzZSAiKyI6CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNbZCsrXSA9IG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9JTlNFUlQsIGRlY29kZVVSSShoKSk7CiAgICAgICAgfSBjYXRjaCAoaykgewogICAgICAgICAgdGhyb3cgRXJyb3IoIklsbGVnYWwgZXNjYXBlIGluIGRpZmZfZnJvbURlbHRhOiAiICsgaCk7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgIi0iOgogICAgICBjYXNlICI9IjoKICAgICAgICB2YXIgbCA9IHBhcnNlSW50KGgsIDEwKTsKICAgICAgICBpZiAoaXNOYU4obCkgfHwgMCA+IGwpIHRocm93IEVycm9yKCJJbnZhbGlkIG51bWJlciBpbiBkaWZmX2Zyb21EZWx0YTogIiArIGgpOwogICAgICAgIGggPSBhLnN1YnN0cmluZyhlLCBlICs9IGwpOwogICAgICAgICI9IiA9PSBmW2ddLmNoYXJBdCgwKSA/IGNbZCsrXSA9IG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgaCkgOiBjW2QrK10gPSBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfREVMRVRFLCBoKTsKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgaWYgKGZbZ10pIHRocm93IEVycm9yKCJJbnZhbGlkIGRpZmYgb3BlcmF0aW9uIGluIGRpZmZfZnJvbURlbHRhOiAiICsgZltnXSk7CiAgICB9CiAgfQoKICBpZiAoZSAhPSBhLmxlbmd0aCkgdGhyb3cgRXJyb3IoIkRlbHRhIGxlbmd0aCAoIiArIGUgKyAiKSBkb2VzIG5vdCBlcXVhbCBzb3VyY2UgdGV4dCBsZW5ndGggKCIgKyBhLmxlbmd0aCArICIpLiIpOwogIHJldHVybiBjOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUubWF0Y2hfbWFpbiA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7CiAgaWYgKG51bGwgPT0gYSB8fCBudWxsID09IGIgfHwgbnVsbCA9PSBjKSB0aHJvdyBFcnJvcigiTnVsbCBpbnB1dC4gKG1hdGNoX21haW4pIik7CiAgYyA9IE1hdGgubWF4KDAsIE1hdGgubWluKGMsIGEubGVuZ3RoKSk7CiAgcmV0dXJuIGEgPT0gYiA/IDAgOiBhLmxlbmd0aCA/IGEuc3Vic3RyaW5nKGMsIGMgKyBiLmxlbmd0aCkgPT0gYiA/IGMgOiB0aGlzLm1hdGNoX2JpdGFwXyhhLCBiLCBjKSA6IC0xOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUubWF0Y2hfYml0YXBfID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsKICBmdW5jdGlvbiBkKGEsIGQpIHsKICAgIHZhciBlID0gYSAvIGIubGVuZ3RoLAogICAgICAgIGcgPSBNYXRoLmFicyhjIC0gZCk7CiAgICByZXR1cm4gZi5NYXRjaF9EaXN0YW5jZSA/IGUgKyBnIC8gZi5NYXRjaF9EaXN0YW5jZSA6IGcgPyAxIDogZTsKICB9CgogIGlmIChiLmxlbmd0aCA+IHRoaXMuTWF0Y2hfTWF4Qml0cykgdGhyb3cgRXJyb3IoIlBhdHRlcm4gdG9vIGxvbmcgZm9yIHRoaXMgYnJvd3Nlci4iKTsKICB2YXIgZSA9IHRoaXMubWF0Y2hfYWxwaGFiZXRfKGIpLAogICAgICBmID0gdGhpcywKICAgICAgZyA9IHRoaXMuTWF0Y2hfVGhyZXNob2xkLAogICAgICBoID0gYS5pbmRleE9mKGIsIGMpOwogIC0xICE9IGggJiYgKGcgPSBNYXRoLm1pbihkKDAsIGgpLCBnKSwgaCA9IGEubGFzdEluZGV4T2YoYiwgYyArIGIubGVuZ3RoKSwgLTEgIT0gaCAmJiAoZyA9IE1hdGgubWluKGQoMCwgaCksIGcpKSk7CiAgdmFyIGwgPSAxIDw8IGIubGVuZ3RoIC0gMTsKICBoID0gLTE7CgogIGZvciAodmFyIGssIG0sIHAgPSBiLmxlbmd0aCArIGEubGVuZ3RoLCB4LCB3ID0gMDsgdyA8IGIubGVuZ3RoOyB3KyspIHsKICAgIGsgPSAwOwoKICAgIGZvciAobSA9IHA7IGsgPCBtOykgewogICAgICBkKHcsIGMgKyBtKSA8PSBnID8gayA9IG0gOiBwID0gbSwgbSA9IE1hdGguZmxvb3IoKHAgLSBrKSAvIDIgKyBrKTsKICAgIH0KCiAgICBwID0gbTsKICAgIGsgPSBNYXRoLm1heCgxLCBjIC0gbSArIDEpOwogICAgdmFyIHEgPSBNYXRoLm1pbihjICsgbSwgYS5sZW5ndGgpICsgYi5sZW5ndGg7CiAgICBtID0gQXJyYXkocSArIDIpOwoKICAgIGZvciAobVtxICsgMV0gPSAoMSA8PCB3KSAtIDE7IHEgPj0gazsgcS0tKSB7CiAgICAgIHZhciB0ID0gZVthLmNoYXJBdChxIC0gMSldOwogICAgICBtW3FdID0gMCA9PT0gdyA/IChtW3EgKyAxXSA8PCAxIHwgMSkgJiB0IDogKG1bcSArIDFdIDw8IDEgfCAxKSAmIHQgfCAoeFtxICsgMV0gfCB4W3FdKSA8PCAxIHwgMSB8IHhbcSArIDFdOwogICAgICBpZiAobVtxXSAmIGwgJiYgKHQgPSBkKHcsIHEgLSAxKSwgdCA8PSBnKSkgaWYgKGcgPSB0LCBoID0gcSAtIDEsIGggPiBjKSBrID0gTWF0aC5tYXgoMSwgMiAqIGMgLSBoKTtlbHNlIGJyZWFrOwogICAgfQoKICAgIGlmIChkKHcgKyAxLCBjKSA+IGcpIGJyZWFrOwogICAgeCA9IG07CiAgfQoKICByZXR1cm4gaDsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLm1hdGNoX2FscGhhYmV0XyA9IGZ1bmN0aW9uIChhKSB7CiAgZm9yICh2YXIgYiA9IHt9LCBjID0gMDsgYyA8IGEubGVuZ3RoOyBjKyspIHsKICAgIGJbYS5jaGFyQXQoYyldID0gMDsKICB9CgogIGZvciAoYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSB7CiAgICBiW2EuY2hhckF0KGMpXSB8PSAxIDw8IGEubGVuZ3RoIC0gYyAtIDE7CiAgfQoKICByZXR1cm4gYjsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLnBhdGNoX2FkZENvbnRleHRfID0gZnVuY3Rpb24gKGEsIGIpIHsKICBpZiAoMCAhPSBiLmxlbmd0aCkgewogICAgaWYgKG51bGwgPT09IGEuc3RhcnQyKSB0aHJvdyBFcnJvcigicGF0Y2ggbm90IGluaXRpYWxpemVkIik7CgogICAgZm9yICh2YXIgYyA9IGIuc3Vic3RyaW5nKGEuc3RhcnQyLCBhLnN0YXJ0MiArIGEubGVuZ3RoMSksIGQgPSAwOyBiLmluZGV4T2YoYykgIT0gYi5sYXN0SW5kZXhPZihjKSAmJiBjLmxlbmd0aCA8IHRoaXMuTWF0Y2hfTWF4Qml0cyAtIHRoaXMuUGF0Y2hfTWFyZ2luIC0gdGhpcy5QYXRjaF9NYXJnaW47KSB7CiAgICAgIGQgKz0gdGhpcy5QYXRjaF9NYXJnaW4sIGMgPSBiLnN1YnN0cmluZyhhLnN0YXJ0MiAtIGQsIGEuc3RhcnQyICsgYS5sZW5ndGgxICsgZCk7CiAgICB9CgogICAgZCArPSB0aGlzLlBhdGNoX01hcmdpbjsKICAgIChjID0gYi5zdWJzdHJpbmcoYS5zdGFydDIgLSBkLCBhLnN0YXJ0MikpICYmIGEuZGlmZnMudW5zaGlmdChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGMpKTsKICAgIChkID0gYi5zdWJzdHJpbmcoYS5zdGFydDIgKyBhLmxlbmd0aDEsIGEuc3RhcnQyICsgYS5sZW5ndGgxICsgZCkpICYmIGEuZGlmZnMucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGQpKTsKICAgIGEuc3RhcnQxIC09IGMubGVuZ3RoOwogICAgYS5zdGFydDIgLT0gYy5sZW5ndGg7CiAgICBhLmxlbmd0aDEgKz0gYy5sZW5ndGggKyBkLmxlbmd0aDsKICAgIGEubGVuZ3RoMiArPSBjLmxlbmd0aCArIGQubGVuZ3RoOwogIH0KfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLnBhdGNoX21ha2UgPSBmdW5jdGlvbiAoYSwgYiwgYykgewogIGlmICgic3RyaW5nIiA9PSB0eXBlb2YgYSAmJiAic3RyaW5nIiA9PSB0eXBlb2YgYiAmJiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgYykgewogICAgdmFyIGQgPSBhOwogICAgYiA9IHRoaXMuZGlmZl9tYWluKGQsIGIsICEwKTsKICAgIDIgPCBiLmxlbmd0aCAmJiAodGhpcy5kaWZmX2NsZWFudXBTZW1hbnRpYyhiKSwgdGhpcy5kaWZmX2NsZWFudXBFZmZpY2llbmN5KGIpKTsKICB9IGVsc2UgaWYgKGEgJiYgIm9iamVjdCIgPT0gdHlwZW9mIGEgJiYgInVuZGVmaW5lZCIgPT0gdHlwZW9mIGIgJiYgInVuZGVmaW5lZCIgPT0gdHlwZW9mIGMpIGIgPSBhLCBkID0gdGhpcy5kaWZmX3RleHQxKGIpO2Vsc2UgaWYgKCJzdHJpbmciID09IHR5cGVvZiBhICYmIGIgJiYgIm9iamVjdCIgPT0gdHlwZW9mIGIgJiYgInVuZGVmaW5lZCIgPT0gdHlwZW9mIGMpIGQgPSBhO2Vsc2UgaWYgKCJzdHJpbmciID09IHR5cGVvZiBhICYmICJzdHJpbmciID09IHR5cGVvZiBiICYmIGMgJiYgIm9iamVjdCIgPT0gdHlwZW9mIGMpIGQgPSBhLCBiID0gYztlbHNlIHRocm93IEVycm9yKCJVbmtub3duIGNhbGwgZm9ybWF0IHRvIHBhdGNoX21ha2UuIik7CgogIGlmICgwID09PSBiLmxlbmd0aCkgcmV0dXJuIFtdOwogIGMgPSBbXTsKICBhID0gbmV3IGRpZmZfbWF0Y2hfcGF0Y2gucGF0Y2hfb2JqKCk7CgogIGZvciAodmFyIGUgPSAwLCBmID0gMCwgZyA9IDAsIGggPSBkLCBsID0gMDsgbCA8IGIubGVuZ3RoOyBsKyspIHsKICAgIHZhciBrID0gYltsXVswXSwKICAgICAgICBtID0gYltsXVsxXTsKICAgIGUgfHwgayA9PT0gRElGRl9FUVVBTCB8fCAoYS5zdGFydDEgPSBmLCBhLnN0YXJ0MiA9IGcpOwoKICAgIHN3aXRjaCAoaykgewogICAgICBjYXNlIERJRkZfSU5TRVJUOgogICAgICAgIGEuZGlmZnNbZSsrXSA9IGJbbF07CiAgICAgICAgYS5sZW5ndGgyICs9IG0ubGVuZ3RoOwogICAgICAgIGQgPSBkLnN1YnN0cmluZygwLCBnKSArIG0gKyBkLnN1YnN0cmluZyhnKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgRElGRl9ERUxFVEU6CiAgICAgICAgYS5sZW5ndGgxICs9IG0ubGVuZ3RoOwogICAgICAgIGEuZGlmZnNbZSsrXSA9IGJbbF07CiAgICAgICAgZCA9IGQuc3Vic3RyaW5nKDAsIGcpICsgZC5zdWJzdHJpbmcoZyArIG0ubGVuZ3RoKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgRElGRl9FUVVBTDoKICAgICAgICBtLmxlbmd0aCA8PSAyICogdGhpcy5QYXRjaF9NYXJnaW4gJiYgZSAmJiBiLmxlbmd0aCAhPSBsICsgMSA/IChhLmRpZmZzW2UrK10gPSBiW2xdLCBhLmxlbmd0aDEgKz0gbS5sZW5ndGgsIGEubGVuZ3RoMiArPSBtLmxlbmd0aCkgOiBtLmxlbmd0aCA+PSAyICogdGhpcy5QYXRjaF9NYXJnaW4gJiYgZSAmJiAodGhpcy5wYXRjaF9hZGRDb250ZXh0XyhhLCBoKSwgYy5wdXNoKGEpLCBhID0gbmV3IGRpZmZfbWF0Y2hfcGF0Y2gucGF0Y2hfb2JqKCksIGUgPSAwLCBoID0gZCwgZiA9IGcpOwogICAgfQoKICAgIGsgIT09IERJRkZfSU5TRVJUICYmIChmICs9IG0ubGVuZ3RoKTsKICAgIGsgIT09IERJRkZfREVMRVRFICYmIChnICs9IG0ubGVuZ3RoKTsKICB9CgogIGUgJiYgKHRoaXMucGF0Y2hfYWRkQ29udGV4dF8oYSwgaCksIGMucHVzaChhKSk7CiAgcmV0dXJuIGM7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5wYXRjaF9kZWVwQ29weSA9IGZ1bmN0aW9uIChhKSB7CiAgZm9yICh2YXIgYiA9IFtdLCBjID0gMDsgYyA8IGEubGVuZ3RoOyBjKyspIHsKICAgIHZhciBkID0gYVtjXSwKICAgICAgICBlID0gbmV3IGRpZmZfbWF0Y2hfcGF0Y2gucGF0Y2hfb2JqKCk7CiAgICBlLmRpZmZzID0gW107CgogICAgZm9yICh2YXIgZiA9IDA7IGYgPCBkLmRpZmZzLmxlbmd0aDsgZisrKSB7CiAgICAgIGUuZGlmZnNbZl0gPSBuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKGQuZGlmZnNbZl1bMF0sIGQuZGlmZnNbZl1bMV0pOwogICAgfQoKICAgIGUuc3RhcnQxID0gZC5zdGFydDE7CiAgICBlLnN0YXJ0MiA9IGQuc3RhcnQyOwogICAgZS5sZW5ndGgxID0gZC5sZW5ndGgxOwogICAgZS5sZW5ndGgyID0gZC5sZW5ndGgyOwogICAgYltjXSA9IGU7CiAgfQoKICByZXR1cm4gYjsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLnBhdGNoX2FwcGx5ID0gZnVuY3Rpb24gKGEsIGIpIHsKICBpZiAoMCA9PSBhLmxlbmd0aCkgcmV0dXJuIFtiLCBbXV07CiAgYSA9IHRoaXMucGF0Y2hfZGVlcENvcHkoYSk7CiAgdmFyIGMgPSB0aGlzLnBhdGNoX2FkZFBhZGRpbmcoYSk7CiAgYiA9IGMgKyBiICsgYzsKICB0aGlzLnBhdGNoX3NwbGl0TWF4KGEpOwoKICBmb3IgKHZhciBkID0gMCwgZSA9IFtdLCBmID0gMDsgZiA8IGEubGVuZ3RoOyBmKyspIHsKICAgIHZhciBnID0gYVtmXS5zdGFydDIgKyBkLAogICAgICAgIGggPSB0aGlzLmRpZmZfdGV4dDEoYVtmXS5kaWZmcyksCiAgICAgICAgbCA9IC0xOwoKICAgIGlmIChoLmxlbmd0aCA+IHRoaXMuTWF0Y2hfTWF4Qml0cykgewogICAgICB2YXIgayA9IHRoaXMubWF0Y2hfbWFpbihiLCBoLnN1YnN0cmluZygwLCB0aGlzLk1hdGNoX01heEJpdHMpLCBnKTsKICAgICAgLTEgIT0gayAmJiAobCA9IHRoaXMubWF0Y2hfbWFpbihiLCBoLnN1YnN0cmluZyhoLmxlbmd0aCAtIHRoaXMuTWF0Y2hfTWF4Qml0cyksIGcgKyBoLmxlbmd0aCAtIHRoaXMuTWF0Y2hfTWF4Qml0cyksIC0xID09IGwgfHwgayA+PSBsKSAmJiAoayA9IC0xKTsKICAgIH0gZWxzZSBrID0gdGhpcy5tYXRjaF9tYWluKGIsIGgsIGcpOwoKICAgIGlmICgtMSA9PSBrKSBlW2ZdID0gITEsIGQgLT0gYVtmXS5sZW5ndGgyIC0gYVtmXS5sZW5ndGgxO2Vsc2UgaWYgKGVbZl0gPSAhMCwgZCA9IGsgLSBnLCBnID0gLTEgPT0gbCA/IGIuc3Vic3RyaW5nKGssIGsgKyBoLmxlbmd0aCkgOiBiLnN1YnN0cmluZyhrLCBsICsgdGhpcy5NYXRjaF9NYXhCaXRzKSwgaCA9PSBnKSBiID0gYi5zdWJzdHJpbmcoMCwgaykgKyB0aGlzLmRpZmZfdGV4dDIoYVtmXS5kaWZmcykgKyBiLnN1YnN0cmluZyhrICsgaC5sZW5ndGgpO2Vsc2UgaWYgKGcgPSB0aGlzLmRpZmZfbWFpbihoLCBnLCAhMSksIGgubGVuZ3RoID4gdGhpcy5NYXRjaF9NYXhCaXRzICYmIHRoaXMuZGlmZl9sZXZlbnNodGVpbihnKSAvIGgubGVuZ3RoID4gdGhpcy5QYXRjaF9EZWxldGVUaHJlc2hvbGQpIGVbZl0gPSAhMTtlbHNlIHsKICAgICAgdGhpcy5kaWZmX2NsZWFudXBTZW1hbnRpY0xvc3NsZXNzKGcpOwogICAgICBoID0gMDsKICAgICAgdmFyIG07CgogICAgICBmb3IgKGwgPSAwOyBsIDwgYVtmXS5kaWZmcy5sZW5ndGg7IGwrKykgewogICAgICAgIHZhciBwID0gYVtmXS5kaWZmc1tsXTsKICAgICAgICBwWzBdICE9PSBESUZGX0VRVUFMICYmIChtID0gdGhpcy5kaWZmX3hJbmRleChnLCBoKSk7CiAgICAgICAgcFswXSA9PT0gRElGRl9JTlNFUlQgPyBiID0gYi5zdWJzdHJpbmcoMCwgayArIG0pICsgcFsxXSArIGIuc3Vic3RyaW5nKGsgKyBtKSA6IHBbMF0gPT09IERJRkZfREVMRVRFICYmIChiID0gYi5zdWJzdHJpbmcoMCwgayArIG0pICsgYi5zdWJzdHJpbmcoayArIHRoaXMuZGlmZl94SW5kZXgoZywgaCArIHBbMV0ubGVuZ3RoKSkpOwogICAgICAgIHBbMF0gIT09IERJRkZfREVMRVRFICYmIChoICs9IHBbMV0ubGVuZ3RoKTsKICAgICAgfQogICAgfQogIH0KCiAgYiA9IGIuc3Vic3RyaW5nKGMubGVuZ3RoLCBiLmxlbmd0aCAtIGMubGVuZ3RoKTsKICByZXR1cm4gW2IsIGVdOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUucGF0Y2hfYWRkUGFkZGluZyA9IGZ1bmN0aW9uIChhKSB7CiAgZm9yICh2YXIgYiA9IHRoaXMuUGF0Y2hfTWFyZ2luLCBjID0gIiIsIGQgPSAxOyBkIDw9IGI7IGQrKykgewogICAgYyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGQpOwogIH0KCiAgZm9yIChkID0gMDsgZCA8IGEubGVuZ3RoOyBkKyspIHsKICAgIGFbZF0uc3RhcnQxICs9IGIsIGFbZF0uc3RhcnQyICs9IGI7CiAgfQoKICBkID0gYVswXTsKICB2YXIgZSA9IGQuZGlmZnM7CiAgaWYgKDAgPT0gZS5sZW5ndGggfHwgZVswXVswXSAhPSBESUZGX0VRVUFMKSBlLnVuc2hpZnQobmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBjKSksIGQuc3RhcnQxIC09IGIsIGQuc3RhcnQyIC09IGIsIGQubGVuZ3RoMSArPSBiLCBkLmxlbmd0aDIgKz0gYjtlbHNlIGlmIChiID4gZVswXVsxXS5sZW5ndGgpIHsKICAgIHZhciBmID0gYiAtIGVbMF1bMV0ubGVuZ3RoOwogICAgZVswXVsxXSA9IGMuc3Vic3RyaW5nKGVbMF1bMV0ubGVuZ3RoKSArIGVbMF1bMV07CiAgICBkLnN0YXJ0MSAtPSBmOwogICAgZC5zdGFydDIgLT0gZjsKICAgIGQubGVuZ3RoMSArPSBmOwogICAgZC5sZW5ndGgyICs9IGY7CiAgfQogIGQgPSBhW2EubGVuZ3RoIC0gMV07CiAgZSA9IGQuZGlmZnM7CiAgMCA9PSBlLmxlbmd0aCB8fCBlW2UubGVuZ3RoIC0gMV1bMF0gIT0gRElGRl9FUVVBTCA/IChlLnB1c2gobmV3IGRpZmZfbWF0Y2hfcGF0Y2guRGlmZihESUZGX0VRVUFMLCBjKSksIGQubGVuZ3RoMSArPSBiLCBkLmxlbmd0aDIgKz0gYikgOiBiID4gZVtlLmxlbmd0aCAtIDFdWzFdLmxlbmd0aCAmJiAoZiA9IGIgLSBlW2UubGVuZ3RoIC0gMV1bMV0ubGVuZ3RoLCBlW2UubGVuZ3RoIC0gMV1bMV0gKz0gYy5zdWJzdHJpbmcoMCwgZiksIGQubGVuZ3RoMSArPSBmLCBkLmxlbmd0aDIgKz0gZik7CiAgcmV0dXJuIGM7Cn07CgpkaWZmX21hdGNoX3BhdGNoLnByb3RvdHlwZS5wYXRjaF9zcGxpdE1heCA9IGZ1bmN0aW9uIChhKSB7CiAgZm9yICh2YXIgYiA9IHRoaXMuTWF0Y2hfTWF4Qml0cywgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSB7CiAgICBpZiAoIShhW2NdLmxlbmd0aDEgPD0gYikpIHsKICAgICAgdmFyIGQgPSBhW2NdOwogICAgICBhLnNwbGljZShjLS0sIDEpOwoKICAgICAgZm9yICh2YXIgZSA9IGQuc3RhcnQxLCBmID0gZC5zdGFydDIsIGcgPSAiIjsgMCAhPT0gZC5kaWZmcy5sZW5ndGg7KSB7CiAgICAgICAgdmFyIGggPSBuZXcgZGlmZl9tYXRjaF9wYXRjaC5wYXRjaF9vYmooKSwKICAgICAgICAgICAgbCA9ICEwOwogICAgICAgIGguc3RhcnQxID0gZSAtIGcubGVuZ3RoOwogICAgICAgIGguc3RhcnQyID0gZiAtIGcubGVuZ3RoOwogICAgICAgICIiICE9PSBnICYmIChoLmxlbmd0aDEgPSBoLmxlbmd0aDIgPSBnLmxlbmd0aCwgaC5kaWZmcy5wdXNoKG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgZykpKTsKCiAgICAgICAgZm9yICg7IDAgIT09IGQuZGlmZnMubGVuZ3RoICYmIGgubGVuZ3RoMSA8IGIgLSB0aGlzLlBhdGNoX01hcmdpbjspIHsKICAgICAgICAgIGcgPSBkLmRpZmZzWzBdWzBdOwogICAgICAgICAgdmFyIGsgPSBkLmRpZmZzWzBdWzFdOwogICAgICAgICAgZyA9PT0gRElGRl9JTlNFUlQgPyAoaC5sZW5ndGgyICs9IGsubGVuZ3RoLCBmICs9IGsubGVuZ3RoLCBoLmRpZmZzLnB1c2goZC5kaWZmcy5zaGlmdCgpKSwgbCA9ICExKSA6IGcgPT09IERJRkZfREVMRVRFICYmIDEgPT0gaC5kaWZmcy5sZW5ndGggJiYgaC5kaWZmc1swXVswXSA9PSBESUZGX0VRVUFMICYmIGsubGVuZ3RoID4gMiAqIGIgPyAoaC5sZW5ndGgxICs9IGsubGVuZ3RoLCBlICs9IGsubGVuZ3RoLCBsID0gITEsIGguZGlmZnMucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKGcsIGspKSwgZC5kaWZmcy5zaGlmdCgpKSA6IChrID0gay5zdWJzdHJpbmcoMCwgYiAtIGgubGVuZ3RoMSAtIHRoaXMuUGF0Y2hfTWFyZ2luKSwgaC5sZW5ndGgxICs9IGsubGVuZ3RoLCBlICs9IGsubGVuZ3RoLCBnID09PSBESUZGX0VRVUFMID8gKGgubGVuZ3RoMiArPSBrLmxlbmd0aCwgZiArPSBrLmxlbmd0aCkgOiBsID0gITEsIGguZGlmZnMucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKGcsIGspKSwgayA9PSBkLmRpZmZzWzBdWzFdID8gZC5kaWZmcy5zaGlmdCgpIDogZC5kaWZmc1swXVsxXSA9IGQuZGlmZnNbMF1bMV0uc3Vic3RyaW5nKGsubGVuZ3RoKSk7CiAgICAgICAgfQoKICAgICAgICBnID0gdGhpcy5kaWZmX3RleHQyKGguZGlmZnMpOwogICAgICAgIGcgPSBnLnN1YnN0cmluZyhnLmxlbmd0aCAtIHRoaXMuUGF0Y2hfTWFyZ2luKTsKICAgICAgICBrID0gdGhpcy5kaWZmX3RleHQxKGQuZGlmZnMpLnN1YnN0cmluZygwLCB0aGlzLlBhdGNoX01hcmdpbik7CiAgICAgICAgIiIgIT09IGsgJiYgKGgubGVuZ3RoMSArPSBrLmxlbmd0aCwgaC5sZW5ndGgyICs9IGsubGVuZ3RoLCAwICE9PSBoLmRpZmZzLmxlbmd0aCAmJiBoLmRpZmZzW2guZGlmZnMubGVuZ3RoIC0gMV1bMF0gPT09IERJRkZfRVFVQUwgPyBoLmRpZmZzW2guZGlmZnMubGVuZ3RoIC0gMV1bMV0gKz0gayA6IGguZGlmZnMucHVzaChuZXcgZGlmZl9tYXRjaF9wYXRjaC5EaWZmKERJRkZfRVFVQUwsIGspKSk7CiAgICAgICAgbCB8fCBhLnNwbGljZSgrK2MsIDAsIGgpOwogICAgICB9CiAgICB9CiAgfQp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wcm90b3R5cGUucGF0Y2hfdG9UZXh0ID0gZnVuY3Rpb24gKGEpIHsKICBmb3IgKHZhciBiID0gW10sIGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykgewogICAgYltjXSA9IGFbY107CiAgfQoKICByZXR1cm4gYi5qb2luKCIiKTsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucHJvdG90eXBlLnBhdGNoX2Zyb21UZXh0ID0gZnVuY3Rpb24gKGEpIHsKICB2YXIgYiA9IFtdOwogIGlmICghYSkgcmV0dXJuIGI7CiAgYSA9IGEuc3BsaXQoIlxuIik7CgogIGZvciAodmFyIGMgPSAwLCBkID0gL15AQCAtKFxkKyksPyhcZCopIFwrKFxkKyksPyhcZCopIEBAJC87IGMgPCBhLmxlbmd0aDspIHsKICAgIHZhciBlID0gYVtjXS5tYXRjaChkKTsKICAgIGlmICghZSkgdGhyb3cgRXJyb3IoIkludmFsaWQgcGF0Y2ggc3RyaW5nOiAiICsgYVtjXSk7CiAgICB2YXIgZiA9IG5ldyBkaWZmX21hdGNoX3BhdGNoLnBhdGNoX29iaigpOwogICAgYi5wdXNoKGYpOwogICAgZi5zdGFydDEgPSBwYXJzZUludChlWzFdLCAxMCk7CiAgICAiIiA9PT0gZVsyXSA/IChmLnN0YXJ0MS0tLCBmLmxlbmd0aDEgPSAxKSA6ICIwIiA9PSBlWzJdID8gZi5sZW5ndGgxID0gMCA6IChmLnN0YXJ0MS0tLCBmLmxlbmd0aDEgPSBwYXJzZUludChlWzJdLCAxMCkpOwogICAgZi5zdGFydDIgPSBwYXJzZUludChlWzNdLCAxMCk7CiAgICAiIiA9PT0gZVs0XSA/IChmLnN0YXJ0Mi0tLCBmLmxlbmd0aDIgPSAxKSA6ICIwIiA9PSBlWzRdID8gZi5sZW5ndGgyID0gMCA6IChmLnN0YXJ0Mi0tLCBmLmxlbmd0aDIgPSBwYXJzZUludChlWzRdLCAxMCkpOwoKICAgIGZvciAoYysrOyBjIDwgYS5sZW5ndGg7KSB7CiAgICAgIGUgPSBhW2NdLmNoYXJBdCgwKTsKCiAgICAgIHRyeSB7CiAgICAgICAgdmFyIGcgPSBkZWNvZGVVUkkoYVtjXS5zdWJzdHJpbmcoMSkpOwogICAgICB9IGNhdGNoIChoKSB7CiAgICAgICAgdGhyb3cgRXJyb3IoIklsbGVnYWwgZXNjYXBlIGluIHBhdGNoX2Zyb21UZXh0OiAiICsgZyk7CiAgICAgIH0KCiAgICAgIGlmICgiLSIgPT0gZSkgZi5kaWZmcy5wdXNoKG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9ERUxFVEUsIGcpKTtlbHNlIGlmICgiKyIgPT0gZSkgZi5kaWZmcy5wdXNoKG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9JTlNFUlQsIGcpKTtlbHNlIGlmICgiICIgPT0gZSkgZi5kaWZmcy5wdXNoKG5ldyBkaWZmX21hdGNoX3BhdGNoLkRpZmYoRElGRl9FUVVBTCwgZykpO2Vsc2UgaWYgKCJAIiA9PSBlKSBicmVhaztlbHNlIGlmICgiIiAhPT0gZSkgdGhyb3cgRXJyb3IoJ0ludmFsaWQgcGF0Y2ggbW9kZSAiJyArIGUgKyAnIiBpbjogJyArIGcpOwogICAgICBjKys7CiAgICB9CiAgfQoKICByZXR1cm4gYjsKfTsKCmRpZmZfbWF0Y2hfcGF0Y2gucGF0Y2hfb2JqID0gZnVuY3Rpb24gKCkgewogIHRoaXMuZGlmZnMgPSBbXTsKICB0aGlzLnN0YXJ0MiA9IHRoaXMuc3RhcnQxID0gbnVsbDsKICB0aGlzLmxlbmd0aDIgPSB0aGlzLmxlbmd0aDEgPSAwOwp9OwoKZGlmZl9tYXRjaF9wYXRjaC5wYXRjaF9vYmoucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewogIGZvciAodmFyIGEgPSBbIkBAIC0iICsgKDAgPT09IHRoaXMubGVuZ3RoMSA/IHRoaXMuc3RhcnQxICsgIiwwIiA6IDEgPT0gdGhpcy5sZW5ndGgxID8gdGhpcy5zdGFydDEgKyAxIDogdGhpcy5zdGFydDEgKyAxICsgIiwiICsgdGhpcy5sZW5ndGgxKSArICIgKyIgKyAoMCA9PT0gdGhpcy5sZW5ndGgyID8gdGhpcy5zdGFydDIgKyAiLDAiIDogMSA9PSB0aGlzLmxlbmd0aDIgPyB0aGlzLnN0YXJ0MiArIDEgOiB0aGlzLnN0YXJ0MiArIDEgKyAiLCIgKyB0aGlzLmxlbmd0aDIpICsgIiBAQFxuIl0sIGIsIGMgPSAwOyBjIDwgdGhpcy5kaWZmcy5sZW5ndGg7IGMrKykgewogICAgc3dpdGNoICh0aGlzLmRpZmZzW2NdWzBdKSB7CiAgICAgIGNhc2UgRElGRl9JTlNFUlQ6CiAgICAgICAgYiA9ICIrIjsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgRElGRl9ERUxFVEU6CiAgICAgICAgYiA9ICItIjsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgRElGRl9FUVVBTDoKICAgICAgICBiID0gIiAiOwogICAgfQoKICAgIGFbYyArIDFdID0gYiArIGVuY29kZVVSSSh0aGlzLmRpZmZzW2NdWzFdKSArICJcbiI7CiAgfQoKICByZXR1cm4gYS5qb2luKCIiKS5yZXBsYWNlKC8lMjAvZywgIiAiKTsKfTsKCnRoaXMuZGlmZl9tYXRjaF9wYXRjaCA9IGRpZmZfbWF0Y2hfcGF0Y2g7CnRoaXMuRElGRl9ERUxFVEUgPSBESUZGX0RFTEVURTsKdGhpcy5ESUZGX0lOU0VSVCA9IERJRkZfSU5TRVJUOwp0aGlzLkRJRkZfRVFVQUwgPSBESUZGX0VRVUFMOwp3aW5kb3cuZGlmZl9tYXRjaF9wYXRjaCA9IGRpZmZfbWF0Y2hfcGF0Y2g7CndpbmRvdy5ESUZGX0lOU0VSVCA9IERJRkZfSU5TRVJUOwp3aW5kb3cuRElGRl9ERUxFVEUgPSBESUZGX0RFTEVURTsKd2luZG93LkRJRkZfRVFVQUwgPSBESUZGX0VRVUFMOw=="},null]}