{"remainingRequest":"/Users/shanebeal/Desktop/bodewiki/node_modules/babel-loader/lib/index.js??ref--0-1!/Users/shanebeal/Desktop/bodewiki/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/shanebeal/Desktop/bodewiki/client/components/editor/editor-modal-media.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/shanebeal/Desktop/bodewiki/client/components/editor/editor-modal-media.vue","mtime":1742769082000},{"path":"/Users/shanebeal/Desktop/bodewiki/.babelrc","mtime":1742797763162},{"path":"/Users/shanebeal/Desktop/bodewiki/node_modules/cache-loader/dist/cjs.js","mtime":1742846258556},{"path":"/Users/shanebeal/Desktop/bodewiki/node_modules/babel-loader/lib/index.js","mtime":1742846259254},{"path":"/Users/shanebeal/Desktop/bodewiki/node_modules/vue-loader/lib/index.js","mtime":1742846259543}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9nZXQgZnJvbSAibG9kYXNoL2dldCI7CmltcG9ydCBfbGFzdCBmcm9tICJsb2Rhc2gvbGFzdCI7CmltcG9ydCBfZGVsYXkgZnJvbSAibG9kYXNoL2RlbGF5IjsKaW1wb3J0IF9maW5kIGZyb20gImxvZGFzaC9maW5kIjsKaW1wb3J0IF9jb21wYWN0IGZyb20gImxvZGFzaC9jb21wYWN0IjsgLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KZnVuY3Rpb24gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXJMb29zZShyLCBlKSB7IHZhciB0ID0gInVuZGVmaW5lZCIgIT0gdHlwZW9mIFN5bWJvbCAmJiByW1N5bWJvbC5pdGVyYXRvcl0gfHwgclsiQEBpdGVyYXRvciJdOyBpZiAodCkgcmV0dXJuICh0ID0gdC5jYWxsKHIpKS5uZXh0LmJpbmQodCk7IGlmIChBcnJheS5pc0FycmF5KHIpIHx8ICh0ID0gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KHIpKSB8fCBlICYmIHIgJiYgIm51bWJlciIgPT0gdHlwZW9mIHIubGVuZ3RoKSB7IHQgJiYgKHIgPSB0KTsgdmFyIG8gPSAwOyByZXR1cm4gZnVuY3Rpb24gKCkgeyByZXR1cm4gbyA+PSByLmxlbmd0aCA/IHsgZG9uZTogITAgfSA6IHsgZG9uZTogITEsIHZhbHVlOiByW28rK10gfTsgfTsgfSB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gaXRlcmF0ZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KHIsIGEpIHsgaWYgKHIpIHsgaWYgKCJzdHJpbmciID09IHR5cGVvZiByKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkociwgYSk7IHZhciB0ID0ge30udG9TdHJpbmcuY2FsbChyKS5zbGljZSg4LCAtMSk7IHJldHVybiAiT2JqZWN0IiA9PT0gdCAmJiByLmNvbnN0cnVjdG9yICYmICh0ID0gci5jb25zdHJ1Y3Rvci5uYW1lKSwgIk1hcCIgPT09IHQgfHwgIlNldCIgPT09IHQgPyBBcnJheS5mcm9tKHIpIDogIkFyZ3VtZW50cyIgPT09IHQgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QodCkgPyBfYXJyYXlMaWtlVG9BcnJheShyLCBhKSA6IHZvaWQgMDsgfSB9CmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KHIsIGEpIHsgKG51bGwgPT0gYSB8fCBhID4gci5sZW5ndGgpICYmIChhID0gci5sZW5ndGgpOyBmb3IgKHZhciBlID0gMCwgbiA9IEFycmF5KGEpOyBlIDwgYTsgZSsrKSBuW2VdID0gcltlXTsgcmV0dXJuIG47IH0KZnVuY3Rpb24gX3JlZ2VuZXJhdG9yUnVudGltZSgpIHsgInVzZSBzdHJpY3QiOyAvKiEgcmVnZW5lcmF0b3ItcnVudGltZSAtLSBDb3B5cmlnaHQgKGMpIDIwMTQtcHJlc2VudCwgRmFjZWJvb2ssIEluYy4gLS0gbGljZW5zZSAoTUlUKTogaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlZ2VuZXJhdG9yL2Jsb2IvbWFpbi9MSUNFTlNFICovIF9yZWdlbmVyYXRvclJ1bnRpbWUgPSBmdW5jdGlvbiBfcmVnZW5lcmF0b3JSdW50aW1lKCkgeyByZXR1cm4gZTsgfTsgdmFyIHQsIGUgPSB7fSwgciA9IE9iamVjdC5wcm90b3R5cGUsIG4gPSByLmhhc093blByb3BlcnR5LCBvID0gT2JqZWN0LmRlZmluZVByb3BlcnR5IHx8IGZ1bmN0aW9uICh0LCBlLCByKSB7IHRbZV0gPSByLnZhbHVlOyB9LCBpID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sID8gU3ltYm9sIDoge30sIGEgPSBpLml0ZXJhdG9yIHx8ICJAQGl0ZXJhdG9yIiwgYyA9IGkuYXN5bmNJdGVyYXRvciB8fCAiQEBhc3luY0l0ZXJhdG9yIiwgdSA9IGkudG9TdHJpbmdUYWcgfHwgIkBAdG9TdHJpbmdUYWciOyBmdW5jdGlvbiBkZWZpbmUodCwgZSwgcikgeyByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIGUsIHsgdmFsdWU6IHIsIGVudW1lcmFibGU6ICEwLCBjb25maWd1cmFibGU6ICEwLCB3cml0YWJsZTogITAgfSksIHRbZV07IH0gdHJ5IHsgZGVmaW5lKHt9LCAiIik7IH0gY2F0Y2ggKHQpIHsgZGVmaW5lID0gZnVuY3Rpb24gZGVmaW5lKHQsIGUsIHIpIHsgcmV0dXJuIHRbZV0gPSByOyB9OyB9IGZ1bmN0aW9uIHdyYXAodCwgZSwgciwgbikgeyB2YXIgaSA9IGUgJiYgZS5wcm90b3R5cGUgaW5zdGFuY2VvZiBHZW5lcmF0b3IgPyBlIDogR2VuZXJhdG9yLCBhID0gT2JqZWN0LmNyZWF0ZShpLnByb3RvdHlwZSksIGMgPSBuZXcgQ29udGV4dChuIHx8IFtdKTsgcmV0dXJuIG8oYSwgIl9pbnZva2UiLCB7IHZhbHVlOiBtYWtlSW52b2tlTWV0aG9kKHQsIHIsIGMpIH0pLCBhOyB9IGZ1bmN0aW9uIHRyeUNhdGNoKHQsIGUsIHIpIHsgdHJ5IHsgcmV0dXJuIHsgdHlwZTogIm5vcm1hbCIsIGFyZzogdC5jYWxsKGUsIHIpIH07IH0gY2F0Y2ggKHQpIHsgcmV0dXJuIHsgdHlwZTogInRocm93IiwgYXJnOiB0IH07IH0gfSBlLndyYXAgPSB3cmFwOyB2YXIgaCA9ICJzdXNwZW5kZWRTdGFydCIsIGwgPSAic3VzcGVuZGVkWWllbGQiLCBmID0gImV4ZWN1dGluZyIsIHMgPSAiY29tcGxldGVkIiwgeSA9IHt9OyBmdW5jdGlvbiBHZW5lcmF0b3IoKSB7fSBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvbigpIHt9IGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKCkge30gdmFyIHAgPSB7fTsgZGVmaW5lKHAsIGEsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0pOyB2YXIgZCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiwgdiA9IGQgJiYgZChkKHZhbHVlcyhbXSkpKTsgdiAmJiB2ICE9PSByICYmIG4uY2FsbCh2LCBhKSAmJiAocCA9IHYpOyB2YXIgZyA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLnByb3RvdHlwZSA9IEdlbmVyYXRvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHApOyBmdW5jdGlvbiBkZWZpbmVJdGVyYXRvck1ldGhvZHModCkgeyBbIm5leHQiLCAidGhyb3ciLCAicmV0dXJuIl0uZm9yRWFjaChmdW5jdGlvbiAoZSkgeyBkZWZpbmUodCwgZSwgZnVuY3Rpb24gKHQpIHsgcmV0dXJuIHRoaXMuX2ludm9rZShlLCB0KTsgfSk7IH0pOyB9IGZ1bmN0aW9uIEFzeW5jSXRlcmF0b3IodCwgZSkgeyBmdW5jdGlvbiBpbnZva2UociwgbywgaSwgYSkgeyB2YXIgYyA9IHRyeUNhdGNoKHRbcl0sIHQsIG8pOyBpZiAoInRocm93IiAhPT0gYy50eXBlKSB7IHZhciB1ID0gYy5hcmcsIGggPSB1LnZhbHVlOyByZXR1cm4gaCAmJiAib2JqZWN0IiA9PSB0eXBlb2YgaCAmJiBuLmNhbGwoaCwgIl9fYXdhaXQiKSA/IGUucmVzb2x2ZShoLl9fYXdhaXQpLnRoZW4oZnVuY3Rpb24gKHQpIHsgaW52b2tlKCJuZXh0IiwgdCwgaSwgYSk7IH0sIGZ1bmN0aW9uICh0KSB7IGludm9rZSgidGhyb3ciLCB0LCBpLCBhKTsgfSkgOiBlLnJlc29sdmUoaCkudGhlbihmdW5jdGlvbiAodCkgeyB1LnZhbHVlID0gdCwgaSh1KTsgfSwgZnVuY3Rpb24gKHQpIHsgcmV0dXJuIGludm9rZSgidGhyb3ciLCB0LCBpLCBhKTsgfSk7IH0gYShjLmFyZyk7IH0gdmFyIHI7IG8odGhpcywgIl9pbnZva2UiLCB7IHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0LCBuKSB7IGZ1bmN0aW9uIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCkgeyByZXR1cm4gbmV3IGUoZnVuY3Rpb24gKGUsIHIpIHsgaW52b2tlKHQsIG4sIGUsIHIpOyB9KTsgfSByZXR1cm4gciA9IHIgPyByLnRoZW4oY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcsIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKSA6IGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCk7IH0gfSk7IH0gZnVuY3Rpb24gbWFrZUludm9rZU1ldGhvZChlLCByLCBuKSB7IHZhciBvID0gaDsgcmV0dXJuIGZ1bmN0aW9uIChpLCBhKSB7IGlmIChvID09PSBmKSB0aHJvdyBFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgcnVubmluZyIpOyBpZiAobyA9PT0gcykgeyBpZiAoInRocm93IiA9PT0gaSkgdGhyb3cgYTsgcmV0dXJuIHsgdmFsdWU6IHQsIGRvbmU6ICEwIH07IH0gZm9yIChuLm1ldGhvZCA9IGksIG4uYXJnID0gYTs7KSB7IHZhciBjID0gbi5kZWxlZ2F0ZTsgaWYgKGMpIHsgdmFyIHUgPSBtYXliZUludm9rZURlbGVnYXRlKGMsIG4pOyBpZiAodSkgeyBpZiAodSA9PT0geSkgY29udGludWU7IHJldHVybiB1OyB9IH0gaWYgKCJuZXh0IiA9PT0gbi5tZXRob2QpIG4uc2VudCA9IG4uX3NlbnQgPSBuLmFyZztlbHNlIGlmICgidGhyb3ciID09PSBuLm1ldGhvZCkgeyBpZiAobyA9PT0gaCkgdGhyb3cgbyA9IHMsIG4uYXJnOyBuLmRpc3BhdGNoRXhjZXB0aW9uKG4uYXJnKTsgfSBlbHNlICJyZXR1cm4iID09PSBuLm1ldGhvZCAmJiBuLmFicnVwdCgicmV0dXJuIiwgbi5hcmcpOyBvID0gZjsgdmFyIHAgPSB0cnlDYXRjaChlLCByLCBuKTsgaWYgKCJub3JtYWwiID09PSBwLnR5cGUpIHsgaWYgKG8gPSBuLmRvbmUgPyBzIDogbCwgcC5hcmcgPT09IHkpIGNvbnRpbnVlOyByZXR1cm4geyB2YWx1ZTogcC5hcmcsIGRvbmU6IG4uZG9uZSB9OyB9ICJ0aHJvdyIgPT09IHAudHlwZSAmJiAobyA9IHMsIG4ubWV0aG9kID0gInRocm93Iiwgbi5hcmcgPSBwLmFyZyk7IH0gfTsgfSBmdW5jdGlvbiBtYXliZUludm9rZURlbGVnYXRlKGUsIHIpIHsgdmFyIG4gPSByLm1ldGhvZCwgbyA9IGUuaXRlcmF0b3Jbbl07IGlmIChvID09PSB0KSByZXR1cm4gci5kZWxlZ2F0ZSA9IG51bGwsICJ0aHJvdyIgPT09IG4gJiYgZS5pdGVyYXRvci5yZXR1cm4gJiYgKHIubWV0aG9kID0gInJldHVybiIsIHIuYXJnID0gdCwgbWF5YmVJbnZva2VEZWxlZ2F0ZShlLCByKSwgInRocm93IiA9PT0gci5tZXRob2QpIHx8ICJyZXR1cm4iICE9PSBuICYmIChyLm1ldGhvZCA9ICJ0aHJvdyIsIHIuYXJnID0gbmV3IFR5cGVFcnJvcigiVGhlIGl0ZXJhdG9yIGRvZXMgbm90IHByb3ZpZGUgYSAnIiArIG4gKyAiJyBtZXRob2QiKSksIHk7IHZhciBpID0gdHJ5Q2F0Y2gobywgZS5pdGVyYXRvciwgci5hcmcpOyBpZiAoInRocm93IiA9PT0gaS50eXBlKSByZXR1cm4gci5tZXRob2QgPSAidGhyb3ciLCByLmFyZyA9IGkuYXJnLCByLmRlbGVnYXRlID0gbnVsbCwgeTsgdmFyIGEgPSBpLmFyZzsgcmV0dXJuIGEgPyBhLmRvbmUgPyAocltlLnJlc3VsdE5hbWVdID0gYS52YWx1ZSwgci5uZXh0ID0gZS5uZXh0TG9jLCAicmV0dXJuIiAhPT0gci5tZXRob2QgJiYgKHIubWV0aG9kID0gIm5leHQiLCByLmFyZyA9IHQpLCByLmRlbGVnYXRlID0gbnVsbCwgeSkgOiBhIDogKHIubWV0aG9kID0gInRocm93Iiwgci5hcmcgPSBuZXcgVHlwZUVycm9yKCJpdGVyYXRvciByZXN1bHQgaXMgbm90IGFuIG9iamVjdCIpLCByLmRlbGVnYXRlID0gbnVsbCwgeSk7IH0gZnVuY3Rpb24gcHVzaFRyeUVudHJ5KHQpIHsgdmFyIGUgPSB7IHRyeUxvYzogdFswXSB9OyAxIGluIHQgJiYgKGUuY2F0Y2hMb2MgPSB0WzFdKSwgMiBpbiB0ICYmIChlLmZpbmFsbHlMb2MgPSB0WzJdLCBlLmFmdGVyTG9jID0gdFszXSksIHRoaXMudHJ5RW50cmllcy5wdXNoKGUpOyB9IGZ1bmN0aW9uIHJlc2V0VHJ5RW50cnkodCkgeyB2YXIgZSA9IHQuY29tcGxldGlvbiB8fCB7fTsgZS50eXBlID0gIm5vcm1hbCIsIGRlbGV0ZSBlLmFyZywgdC5jb21wbGV0aW9uID0gZTsgfSBmdW5jdGlvbiBDb250ZXh0KHQpIHsgdGhpcy50cnlFbnRyaWVzID0gW3sgdHJ5TG9jOiAicm9vdCIgfV0sIHQuZm9yRWFjaChwdXNoVHJ5RW50cnksIHRoaXMpLCB0aGlzLnJlc2V0KCEwKTsgfSBmdW5jdGlvbiB2YWx1ZXMoZSkgeyBpZiAoZSB8fCAiIiA9PT0gZSkgeyB2YXIgciA9IGVbYV07IGlmIChyKSByZXR1cm4gci5jYWxsKGUpOyBpZiAoImZ1bmN0aW9uIiA9PSB0eXBlb2YgZS5uZXh0KSByZXR1cm4gZTsgaWYgKCFpc05hTihlLmxlbmd0aCkpIHsgdmFyIG8gPSAtMSwgaSA9IGZ1bmN0aW9uIG5leHQoKSB7IGZvciAoOyArK28gPCBlLmxlbmd0aDspIGlmIChuLmNhbGwoZSwgbykpIHJldHVybiBuZXh0LnZhbHVlID0gZVtvXSwgbmV4dC5kb25lID0gITEsIG5leHQ7IHJldHVybiBuZXh0LnZhbHVlID0gdCwgbmV4dC5kb25lID0gITAsIG5leHQ7IH07IHJldHVybiBpLm5leHQgPSBpOyB9IH0gdGhyb3cgbmV3IFR5cGVFcnJvcih0eXBlb2YgZSArICIgaXMgbm90IGl0ZXJhYmxlIik7IH0gcmV0dXJuIEdlbmVyYXRvckZ1bmN0aW9uLnByb3RvdHlwZSA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLCBvKGcsICJjb25zdHJ1Y3RvciIsIHsgdmFsdWU6IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLCBjb25maWd1cmFibGU6ICEwIH0pLCBvKEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLCAiY29uc3RydWN0b3IiLCB7IHZhbHVlOiBHZW5lcmF0b3JGdW5jdGlvbiwgY29uZmlndXJhYmxlOiAhMCB9KSwgR2VuZXJhdG9yRnVuY3Rpb24uZGlzcGxheU5hbWUgPSBkZWZpbmUoR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsIHUsICJHZW5lcmF0b3JGdW5jdGlvbiIpLCBlLmlzR2VuZXJhdG9yRnVuY3Rpb24gPSBmdW5jdGlvbiAodCkgeyB2YXIgZSA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQgJiYgdC5jb25zdHJ1Y3RvcjsgcmV0dXJuICEhZSAmJiAoZSA9PT0gR2VuZXJhdG9yRnVuY3Rpb24gfHwgIkdlbmVyYXRvckZ1bmN0aW9uIiA9PT0gKGUuZGlzcGxheU5hbWUgfHwgZS5uYW1lKSk7IH0sIGUubWFyayA9IGZ1bmN0aW9uICh0KSB7IHJldHVybiBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2YodCwgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUpIDogKHQuX19wcm90b19fID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsIGRlZmluZSh0LCB1LCAiR2VuZXJhdG9yRnVuY3Rpb24iKSksIHQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShnKSwgdDsgfSwgZS5hd3JhcCA9IGZ1bmN0aW9uICh0KSB7IHJldHVybiB7IF9fYXdhaXQ6IHQgfTsgfSwgZGVmaW5lSXRlcmF0b3JNZXRob2RzKEFzeW5jSXRlcmF0b3IucHJvdG90eXBlKSwgZGVmaW5lKEFzeW5jSXRlcmF0b3IucHJvdG90eXBlLCBjLCBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9KSwgZS5Bc3luY0l0ZXJhdG9yID0gQXN5bmNJdGVyYXRvciwgZS5hc3luYyA9IGZ1bmN0aW9uICh0LCByLCBuLCBvLCBpKSB7IHZvaWQgMCA9PT0gaSAmJiAoaSA9IFByb21pc2UpOyB2YXIgYSA9IG5ldyBBc3luY0l0ZXJhdG9yKHdyYXAodCwgciwgbiwgbyksIGkpOyByZXR1cm4gZS5pc0dlbmVyYXRvckZ1bmN0aW9uKHIpID8gYSA6IGEubmV4dCgpLnRoZW4oZnVuY3Rpb24gKHQpIHsgcmV0dXJuIHQuZG9uZSA/IHQudmFsdWUgOiBhLm5leHQoKTsgfSk7IH0sIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhnKSwgZGVmaW5lKGcsIHUsICJHZW5lcmF0b3IiKSwgZGVmaW5lKGcsIGEsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0pLCBkZWZpbmUoZywgInRvU3RyaW5nIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gIltvYmplY3QgR2VuZXJhdG9yXSI7IH0pLCBlLmtleXMgPSBmdW5jdGlvbiAodCkgeyB2YXIgZSA9IE9iamVjdCh0KSwgciA9IFtdOyBmb3IgKHZhciBuIGluIGUpIHIucHVzaChuKTsgcmV0dXJuIHIucmV2ZXJzZSgpLCBmdW5jdGlvbiBuZXh0KCkgeyBmb3IgKDsgci5sZW5ndGg7KSB7IHZhciB0ID0gci5wb3AoKTsgaWYgKHQgaW4gZSkgcmV0dXJuIG5leHQudmFsdWUgPSB0LCBuZXh0LmRvbmUgPSAhMSwgbmV4dDsgfSByZXR1cm4gbmV4dC5kb25lID0gITAsIG5leHQ7IH07IH0sIGUudmFsdWVzID0gdmFsdWVzLCBDb250ZXh0LnByb3RvdHlwZSA9IHsgY29uc3RydWN0b3I6IENvbnRleHQsIHJlc2V0OiBmdW5jdGlvbiByZXNldChlKSB7IGlmICh0aGlzLnByZXYgPSAwLCB0aGlzLm5leHQgPSAwLCB0aGlzLnNlbnQgPSB0aGlzLl9zZW50ID0gdCwgdGhpcy5kb25lID0gITEsIHRoaXMuZGVsZWdhdGUgPSBudWxsLCB0aGlzLm1ldGhvZCA9ICJuZXh0IiwgdGhpcy5hcmcgPSB0LCB0aGlzLnRyeUVudHJpZXMuZm9yRWFjaChyZXNldFRyeUVudHJ5KSwgIWUpIGZvciAodmFyIHIgaW4gdGhpcykgInQiID09PSByLmNoYXJBdCgwKSAmJiBuLmNhbGwodGhpcywgcikgJiYgIWlzTmFOKCtyLnNsaWNlKDEpKSAmJiAodGhpc1tyXSA9IHQpOyB9LCBzdG9wOiBmdW5jdGlvbiBzdG9wKCkgeyB0aGlzLmRvbmUgPSAhMDsgdmFyIHQgPSB0aGlzLnRyeUVudHJpZXNbMF0uY29tcGxldGlvbjsgaWYgKCJ0aHJvdyIgPT09IHQudHlwZSkgdGhyb3cgdC5hcmc7IHJldHVybiB0aGlzLnJ2YWw7IH0sIGRpc3BhdGNoRXhjZXB0aW9uOiBmdW5jdGlvbiBkaXNwYXRjaEV4Y2VwdGlvbihlKSB7IGlmICh0aGlzLmRvbmUpIHRocm93IGU7IHZhciByID0gdGhpczsgZnVuY3Rpb24gaGFuZGxlKG4sIG8pIHsgcmV0dXJuIGEudHlwZSA9ICJ0aHJvdyIsIGEuYXJnID0gZSwgci5uZXh0ID0gbiwgbyAmJiAoci5tZXRob2QgPSAibmV4dCIsIHIuYXJnID0gdCksICEhbzsgfSBmb3IgKHZhciBvID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IG8gPj0gMDsgLS1vKSB7IHZhciBpID0gdGhpcy50cnlFbnRyaWVzW29dLCBhID0gaS5jb21wbGV0aW9uOyBpZiAoInJvb3QiID09PSBpLnRyeUxvYykgcmV0dXJuIGhhbmRsZSgiZW5kIik7IGlmIChpLnRyeUxvYyA8PSB0aGlzLnByZXYpIHsgdmFyIGMgPSBuLmNhbGwoaSwgImNhdGNoTG9jIiksIHUgPSBuLmNhbGwoaSwgImZpbmFsbHlMb2MiKTsgaWYgKGMgJiYgdSkgeyBpZiAodGhpcy5wcmV2IDwgaS5jYXRjaExvYykgcmV0dXJuIGhhbmRsZShpLmNhdGNoTG9jLCAhMCk7IGlmICh0aGlzLnByZXYgPCBpLmZpbmFsbHlMb2MpIHJldHVybiBoYW5kbGUoaS5maW5hbGx5TG9jKTsgfSBlbHNlIGlmIChjKSB7IGlmICh0aGlzLnByZXYgPCBpLmNhdGNoTG9jKSByZXR1cm4gaGFuZGxlKGkuY2F0Y2hMb2MsICEwKTsgfSBlbHNlIHsgaWYgKCF1KSB0aHJvdyBFcnJvcigidHJ5IHN0YXRlbWVudCB3aXRob3V0IGNhdGNoIG9yIGZpbmFsbHkiKTsgaWYgKHRoaXMucHJldiA8IGkuZmluYWxseUxvYykgcmV0dXJuIGhhbmRsZShpLmZpbmFsbHlMb2MpOyB9IH0gfSB9LCBhYnJ1cHQ6IGZ1bmN0aW9uIGFicnVwdCh0LCBlKSB7IGZvciAodmFyIHIgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgciA+PSAwOyAtLXIpIHsgdmFyIG8gPSB0aGlzLnRyeUVudHJpZXNbcl07IGlmIChvLnRyeUxvYyA8PSB0aGlzLnByZXYgJiYgbi5jYWxsKG8sICJmaW5hbGx5TG9jIikgJiYgdGhpcy5wcmV2IDwgby5maW5hbGx5TG9jKSB7IHZhciBpID0gbzsgYnJlYWs7IH0gfSBpICYmICgiYnJlYWsiID09PSB0IHx8ICJjb250aW51ZSIgPT09IHQpICYmIGkudHJ5TG9jIDw9IGUgJiYgZSA8PSBpLmZpbmFsbHlMb2MgJiYgKGkgPSBudWxsKTsgdmFyIGEgPSBpID8gaS5jb21wbGV0aW9uIDoge307IHJldHVybiBhLnR5cGUgPSB0LCBhLmFyZyA9IGUsIGkgPyAodGhpcy5tZXRob2QgPSAibmV4dCIsIHRoaXMubmV4dCA9IGkuZmluYWxseUxvYywgeSkgOiB0aGlzLmNvbXBsZXRlKGEpOyB9LCBjb21wbGV0ZTogZnVuY3Rpb24gY29tcGxldGUodCwgZSkgeyBpZiAoInRocm93IiA9PT0gdC50eXBlKSB0aHJvdyB0LmFyZzsgcmV0dXJuICJicmVhayIgPT09IHQudHlwZSB8fCAiY29udGludWUiID09PSB0LnR5cGUgPyB0aGlzLm5leHQgPSB0LmFyZyA6ICJyZXR1cm4iID09PSB0LnR5cGUgPyAodGhpcy5ydmFsID0gdGhpcy5hcmcgPSB0LmFyZywgdGhpcy5tZXRob2QgPSAicmV0dXJuIiwgdGhpcy5uZXh0ID0gImVuZCIpIDogIm5vcm1hbCIgPT09IHQudHlwZSAmJiBlICYmICh0aGlzLm5leHQgPSBlKSwgeTsgfSwgZmluaXNoOiBmdW5jdGlvbiBmaW5pc2godCkgeyBmb3IgKHZhciBlID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGUgPj0gMDsgLS1lKSB7IHZhciByID0gdGhpcy50cnlFbnRyaWVzW2VdOyBpZiAoci5maW5hbGx5TG9jID09PSB0KSByZXR1cm4gdGhpcy5jb21wbGV0ZShyLmNvbXBsZXRpb24sIHIuYWZ0ZXJMb2MpLCByZXNldFRyeUVudHJ5KHIpLCB5OyB9IH0sIGNhdGNoOiBmdW5jdGlvbiBfY2F0Y2godCkgeyBmb3IgKHZhciBlID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGUgPj0gMDsgLS1lKSB7IHZhciByID0gdGhpcy50cnlFbnRyaWVzW2VdOyBpZiAoci50cnlMb2MgPT09IHQpIHsgdmFyIG4gPSByLmNvbXBsZXRpb247IGlmICgidGhyb3ciID09PSBuLnR5cGUpIHsgdmFyIG8gPSBuLmFyZzsgcmVzZXRUcnlFbnRyeShyKTsgfSByZXR1cm4gbzsgfSB9IHRocm93IEVycm9yKCJpbGxlZ2FsIGNhdGNoIGF0dGVtcHQiKTsgfSwgZGVsZWdhdGVZaWVsZDogZnVuY3Rpb24gZGVsZWdhdGVZaWVsZChlLCByLCBuKSB7IHJldHVybiB0aGlzLmRlbGVnYXRlID0geyBpdGVyYXRvcjogdmFsdWVzKGUpLCByZXN1bHROYW1lOiByLCBuZXh0TG9jOiBuIH0sICJuZXh0IiA9PT0gdGhpcy5tZXRob2QgJiYgKHRoaXMuYXJnID0gdCksIHk7IH0gfSwgZTsgfQpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAobiwgdCwgZSwgciwgbywgYSwgYykgeyB0cnkgeyB2YXIgaSA9IG5bYV0oYyksIHUgPSBpLnZhbHVlOyB9IGNhdGNoIChuKSB7IHJldHVybiB2b2lkIGUobik7IH0gaS5kb25lID8gdCh1KSA6IFByb21pc2UucmVzb2x2ZSh1KS50aGVuKHIsIG8pOyB9CmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgdmFyIHQgPSB0aGlzLCBlID0gYXJndW1lbnRzOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHIsIG8pIHsgdmFyIGEgPSBuLmFwcGx5KHQsIGUpOyBmdW5jdGlvbiBfbmV4dChuKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChhLCByLCBvLCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIG4pOyB9IGZ1bmN0aW9uIF90aHJvdyhuKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChhLCByLCBvLCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBuKTsgfSBfbmV4dCh2b2lkIDApOyB9KTsgfTsgfQppbXBvcnQgeyBnZXQsIHN5bmMgfSBmcm9tICd2dWV4LXBhdGhpZnknOwppbXBvcnQgQ29va2llcyBmcm9tICdqcy1jb29raWUnOwppbXBvcnQgdnVlRmlsZVBvbmQgZnJvbSAndnVlLWZpbGVwb25kJzsKaW1wb3J0ICdmaWxlcG9uZC9kaXN0L2ZpbGVwb25kLm1pbi5jc3MnOwppbXBvcnQgbGlzdEFzc2V0UXVlcnkgZnJvbSAnZ3FsL2VkaXRvci9lZGl0b3ItbWVkaWEtcXVlcnktbGlzdC5ncWwnOwppbXBvcnQgbGlzdEZvbGRlckFzc2V0UXVlcnkgZnJvbSAnZ3FsL2VkaXRvci9lZGl0b3ItbWVkaWEtcXVlcnktZm9sZGVyLWxpc3QuZ3FsJzsKaW1wb3J0IGNyZWF0ZUFzc2V0Rm9sZGVyTXV0YXRpb24gZnJvbSAnZ3FsL2VkaXRvci9lZGl0b3ItbWVkaWEtbXV0YXRpb24tZm9sZGVyLWNyZWF0ZS5ncWwnOwppbXBvcnQgcmVuYW1lQXNzZXRNdXRhdGlvbiBmcm9tICdncWwvZWRpdG9yL2VkaXRvci1tZWRpYS1tdXRhdGlvbi1hc3NldC1yZW5hbWUuZ3FsJzsKaW1wb3J0IGRlbGV0ZUFzc2V0TXV0YXRpb24gZnJvbSAnZ3FsL2VkaXRvci9lZGl0b3ItbWVkaWEtbXV0YXRpb24tYXNzZXQtZGVsZXRlLmdxbCc7CnZhciBGaWxlUG9uZCA9IHZ1ZUZpbGVQb25kKCk7CnZhciBsb2NhbGVTZWdtZW50UmVnZXggPSAvXltBLVpdezJ9KC1bQS1aXXsyfSk/JC9pOwp2YXIgZGlzYWxsb3dlZEZvbGRlckNoYXJzID0gL1tBLVooKT0uIUAjJCU/JiorYH48Piw7OlxcL1tcXcKse3wgXS87CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBGaWxlUG9uZDogRmlsZVBvbmQKICB9LAogIHByb3BzOiB7CiAgICB2YWx1ZTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZvbGRlcnM6IFtdLAogICAgICBmaWxlczogW10sCiAgICAgIGFzc2V0czogW10sCiAgICAgIHBhZ2luYXRpb246IDEsCiAgICAgIHJlbW90ZUltYWdlVXJsOiAnJywKICAgICAgaW1hZ2VBbGlnbm1lbnRzOiBbewogICAgICAgIHRleHQ6ICdOb25lJywKICAgICAgICB2YWx1ZTogJycKICAgICAgfSwgewogICAgICAgIHRleHQ6ICdMZWZ0JywKICAgICAgICB2YWx1ZTogJ2xlZnQnCiAgICAgIH0sIHsKICAgICAgICB0ZXh0OiAnQ2VudGVyZWQnLAogICAgICAgIHZhbHVlOiAnY2VudGVyJwogICAgICB9LCB7CiAgICAgICAgdGV4dDogJ1JpZ2h0JywKICAgICAgICB2YWx1ZTogJ3JpZ2h0JwogICAgICB9LCB7CiAgICAgICAgdGV4dDogJ0Fic29sdXRlIFRvcCBSaWdodCcsCiAgICAgICAgdmFsdWU6ICdhYnN0b3ByaWdodCcKICAgICAgfV0sCiAgICAgIGltYWdlQWxpZ25tZW50OiAnJywKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIG5ld0ZvbGRlckRpYWxvZzogZmFsc2UsCiAgICAgIG5ld0ZvbGRlck5hbWU6ICcnLAogICAgICBuZXdGb2xkZXJMb2FkaW5nOiBmYWxzZSwKICAgICAgcHJldmlld0RpYWxvZzogZmFsc2UsCiAgICAgIHJlbmFtZURpYWxvZzogZmFsc2UsCiAgICAgIHJlbmFtZUFzc2V0TmFtZTogJycsCiAgICAgIHJlbmFtZUFzc2V0TG9hZGluZzogZmFsc2UsCiAgICAgIGRlbGV0ZURpYWxvZzogZmFsc2UsCiAgICAgIGRlbGV0ZUFzc2V0TG9hZGluZzogZmFsc2UKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgaXNTaG93bjogewogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsKSB7CiAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCB2YWwpOwogICAgICB9CiAgICB9LAogICAgZWRpdG9yS2V5OiBnZXQoJ2VkaXRvci9lZGl0b3JLZXknKSwKICAgIGFjdGl2ZU1vZGFsOiBzeW5jKCdlZGl0b3IvYWN0aXZlTW9kYWwnKSwKICAgIGZvbGRlclRyZWU6IGdldCgnZWRpdG9yL21lZGlhQGZvbGRlclRyZWUnKSwKICAgIGN1cnJlbnRGb2xkZXJJZDogc3luYygnZWRpdG9yL21lZGlhQGN1cnJlbnRGb2xkZXJJZCcpLAogICAgY3VycmVudEZpbGVJZDogc3luYygnZWRpdG9yL21lZGlhQGN1cnJlbnRGaWxlSWQnKSwKICAgIHBhZ2VUb3RhbDogZnVuY3Rpb24gcGFnZVRvdGFsKCkgewogICAgICBpZiAoIXRoaXMuYXNzZXRzKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICAgIH0KICAgICAgcmV0dXJuIE1hdGguY2VpbCh0aGlzLmFzc2V0cy5sZW5ndGggLyAxNSk7CiAgICB9LAogICAgaGVhZGVyczogZnVuY3Rpb24gaGVhZGVycygpIHsKICAgICAgcmV0dXJuIF9jb21wYWN0KFt0aGlzLiR2dWV0aWZ5LmJyZWFrcG9pbnQuc21BbmRVcCAmJiB7CiAgICAgICAgdGV4dDogdGhpcy4kdCgnZWRpdG9yOmFzc2V0cy5oZWFkZXJJZCcpLAogICAgICAgIHZhbHVlOiAnaWQnLAogICAgICAgIHdpZHRoOiA4MAogICAgICB9LCB7CiAgICAgICAgdGV4dDogdGhpcy4kdCgnZWRpdG9yOmFzc2V0cy5oZWFkZXJGaWxlbmFtZScpLAogICAgICAgIHZhbHVlOiAnZmlsZW5hbWUnCiAgICAgIH0sIHRoaXMuJHZ1ZXRpZnkuYnJlYWtwb2ludC5sZ0FuZFVwICYmIHsKICAgICAgICB0ZXh0OiB0aGlzLiR0KCdlZGl0b3I6YXNzZXRzLmhlYWRlclR5cGUnKSwKICAgICAgICB2YWx1ZTogJ2V4dCcsCiAgICAgICAgd2lkdGg6IDkwCiAgICAgIH0sIHRoaXMuJHZ1ZXRpZnkuYnJlYWtwb2ludC5tZEFuZFVwICYmIHsKICAgICAgICB0ZXh0OiB0aGlzLiR0KCdlZGl0b3I6YXNzZXRzLmhlYWRlckZpbGVTaXplJyksCiAgICAgICAgdmFsdWU6ICdmaWxlU2l6ZScsCiAgICAgICAgd2lkdGg6IDExMAogICAgICB9LCB0aGlzLiR2dWV0aWZ5LmJyZWFrcG9pbnQubWRBbmRVcCAmJiB7CiAgICAgICAgdGV4dDogdGhpcy4kdCgnZWRpdG9yOmFzc2V0cy5oZWFkZXJBZGRlZCcpLAogICAgICAgIHZhbHVlOiAnY3JlYXRlZEF0JywKICAgICAgICB3aWR0aDogMTc1CiAgICAgIH0sIHRoaXMuJHZ1ZXRpZnkuYnJlYWtwb2ludC5zbUFuZFVwICYmIHsKICAgICAgICB0ZXh0OiB0aGlzLiR0KCdlZGl0b3I6YXNzZXRzLmhlYWRlckFjdGlvbnMnKSwKICAgICAgICB2YWx1ZTogJycsCiAgICAgICAgd2lkdGg6IDgwLAogICAgICAgIHNvcnRhYmxlOiBmYWxzZSwKICAgICAgICBhbGlnbjogJ3JpZ2h0JwogICAgICB9XSk7CiAgICB9LAogICAgaXNGb2xkZXJOYW1lVmFsaWQ6IGZ1bmN0aW9uIGlzRm9sZGVyTmFtZVZhbGlkKCkgewogICAgICByZXR1cm4gdGhpcy5uZXdGb2xkZXJOYW1lLmxlbmd0aCA+IDEgJiYgIWxvY2FsZVNlZ21lbnRSZWdleC50ZXN0KHRoaXMubmV3Rm9sZGVyTmFtZSkgJiYgIWRpc2FsbG93ZWRGb2xkZXJDaGFycy50ZXN0KHRoaXMubmV3Rm9sZGVyTmFtZSk7CiAgICB9LAogICAgY3VycmVudEFzc2V0OiBmdW5jdGlvbiBjdXJyZW50QXNzZXQoKSB7CiAgICAgIHJldHVybiBfZmluZCh0aGlzLmFzc2V0cywgWydpZCcsIHRoaXMuY3VycmVudEZpbGVJZF0pIHx8IHt9OwogICAgfSwKICAgIGZpbGVQb25kU2VydmVyT3B0czogZnVuY3Rpb24gZmlsZVBvbmRTZXJ2ZXJPcHRzKCkgewogICAgICB2YXIgand0VG9rZW4gPSBDb29raWVzLmdldCgnand0Jyk7CiAgICAgIHJldHVybiB7CiAgICAgICAgcHJvY2VzczogewogICAgICAgICAgdXJsOiAnL3UnLAogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6ICJCZWFyZXIgIiArIGp3dFRva2VuCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIG5ld0ZvbGRlckRpYWxvZzogZnVuY3Rpb24gbmV3Rm9sZGVyRGlhbG9nKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBpZiAobmV3VmFsdWUpIHsKICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy4kcmVmcy5mb2xkZXJOYW1lSXB0LmZvY3VzKCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LAogIGZpbHRlcnM6IHsKICAgIHByZXR0eUJ5dGVzOiBmdW5jdGlvbiBwcmV0dHlCeXRlcyhudW0pIHsKICAgICAgaWYgKHR5cGVvZiBudW0gIT09ICdudW1iZXInIHx8IGlzTmFOKG51bSkpIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdFeHBlY3RlZCBhIG51bWJlcicpOwogICAgICB9CiAgICAgIHZhciBleHBvbmVudDsKICAgICAgdmFyIHVuaXQ7CiAgICAgIHZhciBuZWcgPSBudW0gPCAwOwogICAgICB2YXIgdW5pdHMgPSBbJ0InLCAna0InLCAnTUInLCAnR0InLCAnVEInLCAnUEInLCAnRUInLCAnWkInLCAnWUInXTsKICAgICAgaWYgKG5lZykgewogICAgICAgIG51bSA9IC1udW07CiAgICAgIH0KICAgICAgaWYgKG51bSA8IDEpIHsKICAgICAgICByZXR1cm4gKG5lZyA/ICctJyA6ICcnKSArIG51bSArICcgQic7CiAgICAgIH0KICAgICAgZXhwb25lbnQgPSBNYXRoLm1pbihNYXRoLmZsb29yKE1hdGgubG9nKG51bSkgLyBNYXRoLmxvZygxMDAwKSksIHVuaXRzLmxlbmd0aCAtIDEpOwogICAgICBudW0gPSAobnVtIC8gTWF0aC5wb3coMTAwMCwgZXhwb25lbnQpKS50b0ZpeGVkKDIpICogMTsKICAgICAgdW5pdCA9IHVuaXRzW2V4cG9uZW50XTsKICAgICAgcmV0dXJuIChuZWcgPyAnLScgOiAnJykgKyBudW0gKyAnICcgKyB1bml0OwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgcmVmcmVzaDogZnVuY3Rpb24gcmVmcmVzaCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvcigvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLiRhcG9sbG8ucXVlcmllcy5hc3NldHMucmVmZXRjaCgpOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgX3RoaXMyLiRzdG9yZS5jb21taXQoJ3Nob3dOb3RpZmljYXRpb24nLCB7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiBfdGhpczIuJHQoJ2VkaXRvcjphc3NldHMucmVmcmVzaFN1Y2Nlc3MnKSwKICAgICAgICAgICAgICAgIHN0eWxlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICBpY29uOiAnY2hlY2snCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBpbnNlcnQ6IGZ1bmN0aW9uIGluc2VydCgpIHsKICAgICAgdmFyIGFzc2V0ID0gX2ZpbmQodGhpcy5hc3NldHMsIFsnaWQnLCB0aGlzLmN1cnJlbnRGaWxlSWRdKTsKICAgICAgdmFyIGFzc2V0UGF0aCA9IHRoaXMuZm9sZGVyVHJlZS5tYXAoZnVuY3Rpb24gKGYpIHsKICAgICAgICByZXR1cm4gZi5zbHVnOwogICAgICB9KS5qb2luKCcvJyk7CiAgICAgIHRoaXMuJHJvb3QuJGVtaXQoJ2VkaXRvckluc2VydCcsIHsKICAgICAgICBraW5kOiBhc3NldC5raW5kLAogICAgICAgIHBhdGg6IHRoaXMuY3VycmVudEZvbGRlcklkID4gMCA/ICIvIiArIGFzc2V0UGF0aCArICIvIiArIGFzc2V0LmZpbGVuYW1lIDogIi8iICsgYXNzZXQuZmlsZW5hbWUsCiAgICAgICAgdGV4dDogYXNzZXQuZmlsZW5hbWUsCiAgICAgICAgYWxpZ246IHRoaXMuaW1hZ2VBbGlnbm1lbnQKICAgICAgfSk7CiAgICAgIHRoaXMuYWN0aXZlTW9kYWwgPSAnJzsKICAgIH0sCiAgICBicm93c2U6IGZ1bmN0aW9uIGJyb3dzZSgpIHsKICAgICAgdGhpcy4kcmVmcy5wb25kLmJyb3dzZSgpOwogICAgfSwKICAgIHVwbG9hZDogZnVuY3Rpb24gdXBsb2FkKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgZmlsZXMsIF9pdGVyYXRvciwgX3N0ZXAsIGZpbGU7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGZpbGVzID0gX3RoaXMzLiRyZWZzLnBvbmQuZ2V0RmlsZXMoKTsKICAgICAgICAgICAgICBpZiAoIShmaWxlcy5sZW5ndGggPCAxKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBfdGhpczMuJHN0b3JlLmNvbW1pdCgnc2hvd05vdGlmaWNhdGlvbicsIHsKICAgICAgICAgICAgICAgIG1lc3NhZ2U6IF90aGlzMy4kdCgnZWRpdG9yOmFzc2V0cy5ub1VwbG9hZEVycm9yJyksCiAgICAgICAgICAgICAgICBzdHlsZTogJ3dhcm5pbmcnLAogICAgICAgICAgICAgICAgaWNvbjogJ3dhcm5pbmcnCiAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlckxvb3NlKGZpbGVzKTsgIShfc3RlcCA9IF9pdGVyYXRvcigpKS5kb25lOykgewogICAgICAgICAgICAgICAgZmlsZSA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgICAgICAgZmlsZS5zZXRNZXRhZGF0YSh7CiAgICAgICAgICAgICAgICAgIGZvbGRlcklkOiBfdGhpczMuY3VycmVudEZvbGRlcklkCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA2OwogICAgICAgICAgICAgIHJldHVybiBfdGhpczMuJHJlZnMucG9uZC5wcm9jZXNzRmlsZXMoKTsKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgb25GaWxlUHJvY2Vzc2VkOiBmdW5jdGlvbiBvbkZpbGVQcm9jZXNzZWQoZXJyLCBmaWxlKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBpZiAoIWVycikgewogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCBfdGhpczQuJHN0b3JlLmNvbW1pdCgnc2hvd05vdGlmaWNhdGlvbicsIHsKICAgICAgICAgICAgICAgIG1lc3NhZ2U6IF90aGlzNC4kdCgnZWRpdG9yOmFzc2V0cy51cGxvYWRGYWlsZWQnKSwKICAgICAgICAgICAgICAgIHN0eWxlOiAnZXJyb3InLAogICAgICAgICAgICAgICAgaWNvbjogJ2Vycm9yJwogICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIF9kZWxheShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBfdGhpczQuJHJlZnMucG9uZC5yZW1vdmVGaWxlKGZpbGUuaWQpOwogICAgICAgICAgICAgIH0sIDUwMDApOwogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0LiRhcG9sbG8ucXVlcmllcy5hc3NldHMucmVmZXRjaCgpOwogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBkb3duRm9sZGVyOiBmdW5jdGlvbiBkb3duRm9sZGVyKGZvbGRlcikgewogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRvci9wdXNoTWVkaWFGb2xkZXJUcmVlJywgZm9sZGVyKTsKICAgICAgdGhpcy5jdXJyZW50Rm9sZGVySWQgPSBmb2xkZXIuaWQ7CiAgICAgIHRoaXMuY3VycmVudEZpbGVJZCA9IG51bGw7CiAgICB9LAogICAgdXBGb2xkZXI6IGZ1bmN0aW9uIHVwRm9sZGVyKCkgewogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRvci9wb3BNZWRpYUZvbGRlclRyZWUnKTsKICAgICAgdmFyIHBhcmVudEZvbGRlciA9IF9sYXN0KHRoaXMuZm9sZGVyVHJlZSk7CiAgICAgIHRoaXMuY3VycmVudEZvbGRlcklkID0gcGFyZW50Rm9sZGVyID8gcGFyZW50Rm9sZGVyLmlkIDogMDsKICAgICAgdGhpcy5jdXJyZW50RmlsZUlkID0gbnVsbDsKICAgIH0sCiAgICBjcmVhdGVGb2xkZXI6IGZ1bmN0aW9uIGNyZWF0ZUZvbGRlcigpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvcigvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgdmFyIHJlc3A7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF90aGlzNS4kc3RvcmUuY29tbWl0KCJsb2FkaW5nU3RhcnQiLCAnZWRpdG9yLW1lZGlhLWNyZWF0ZWZvbGRlcicpOwogICAgICAgICAgICAgIF90aGlzNS5uZXdGb2xkZXJMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICBfY29udGV4dDQucHJldiA9IDI7CiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA1OwogICAgICAgICAgICAgIHJldHVybiBfdGhpczUuJGFwb2xsby5tdXRhdGUoewogICAgICAgICAgICAgICAgbXV0YXRpb246IGNyZWF0ZUFzc2V0Rm9sZGVyTXV0YXRpb24sCiAgICAgICAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgICAgICAgcGFyZW50Rm9sZGVySWQ6IF90aGlzNS5jdXJyZW50Rm9sZGVySWQsCiAgICAgICAgICAgICAgICAgIHNsdWc6IF90aGlzNS5uZXdGb2xkZXJOYW1lCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICByZXNwID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICAgICAgaWYgKCFfZ2V0KHJlc3AsICdkYXRhLmFzc2V0cy5jcmVhdGVGb2xkZXIucmVzcG9uc2VSZXN1bHQuc3VjY2VlZGVkJywgZmFsc2UpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gOTsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXM1LiRhcG9sbG8ucXVlcmllcy5mb2xkZXJzLnJlZmV0Y2goKTsKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIF90aGlzNS4kc3RvcmUuY29tbWl0KCdzaG93Tm90aWZpY2F0aW9uJywgewogICAgICAgICAgICAgICAgbWVzc2FnZTogX3RoaXM1LiR0KCdlZGl0b3I6YXNzZXRzLmZvbGRlckNyZWF0ZVN1Y2Nlc3MnKSwKICAgICAgICAgICAgICAgIHN0eWxlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICBpY29uOiAnY2hlY2snCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgX3RoaXM1Lm5ld0ZvbGRlckRpYWxvZyA9IGZhbHNlOwogICAgICAgICAgICAgIF90aGlzNS5uZXdGb2xkZXJOYW1lID0gJyc7CiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBfdGhpczUuJHN0b3JlLmNvbW1pdCgncHVzaEdyYXBoRXJyb3InLCBuZXcgRXJyb3IoX2dldChyZXNwLCAnZGF0YS5hc3NldHMuY3JlYXRlRm9sZGVyLnJlc3BvbnNlUmVzdWx0Lm1lc3NhZ2UnKSkpOwogICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgX2NvbnRleHQ0LnByZXYgPSAxNzsKICAgICAgICAgICAgICBfY29udGV4dDQudDAgPSBfY29udGV4dDRbImNhdGNoIl0oMik7CiAgICAgICAgICAgICAgX3RoaXM1LiRzdG9yZS5jb21taXQoJ3B1c2hHcmFwaEVycm9yJywgX2NvbnRleHQ0LnQwKTsKICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICBfdGhpczUubmV3Rm9sZGVyTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIF90aGlzNS4kc3RvcmUuY29tbWl0KCJsb2FkaW5nU3RvcCIsICdlZGl0b3ItbWVkaWEtY3JlYXRlZm9sZGVyJyk7CiAgICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQsIG51bGwsIFtbMiwgMTddXSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG9wZW5SZW5hbWVEaWFsb2c6IGZ1bmN0aW9uIG9wZW5SZW5hbWVEaWFsb2coKSB7CiAgICAgIHRoaXMucmVuYW1lQXNzZXROYW1lID0gdGhpcy5jdXJyZW50QXNzZXQuZmlsZW5hbWU7CiAgICAgIHRoaXMucmVuYW1lRGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICByZW5hbWVBc3NldDogZnVuY3Rpb24gcmVuYW1lQXNzZXQoKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgIHZhciByZXNwOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfdGhpczYuJHN0b3JlLmNvbW1pdCgibG9hZGluZ1N0YXJ0IiwgJ2VkaXRvci1tZWRpYS1yZW5hbWVhc3NldCcpOwogICAgICAgICAgICAgIF90aGlzNi5yZW5hbWVBc3NldExvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICAgIF9jb250ZXh0NS5wcmV2ID0gMjsKICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDU7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNi4kYXBvbGxvLm11dGF0ZSh7CiAgICAgICAgICAgICAgICBtdXRhdGlvbjogcmVuYW1lQXNzZXRNdXRhdGlvbiwKICAgICAgICAgICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgICAgICAgICBpZDogX3RoaXM2LmN1cnJlbnRGaWxlSWQsCiAgICAgICAgICAgICAgICAgIGZpbGVuYW1lOiBfdGhpczYucmVuYW1lQXNzZXROYW1lCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICByZXNwID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgICAgaWYgKCFfZ2V0KHJlc3AsICdkYXRhLmFzc2V0cy5yZW5hbWVBc3NldC5yZXNwb25zZVJlc3VsdC5zdWNjZWVkZWQnLCBmYWxzZSkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA5OwogICAgICAgICAgICAgIHJldHVybiBfdGhpczYuJGFwb2xsby5xdWVyaWVzLmFzc2V0cy5yZWZldGNoKCk7CiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBfdGhpczYuJHN0b3JlLmNvbW1pdCgnc2hvd05vdGlmaWNhdGlvbicsIHsKICAgICAgICAgICAgICAgIG1lc3NhZ2U6IF90aGlzNi4kdCgnZWRpdG9yOmFzc2V0cy5yZW5hbWVTdWNjZXNzJyksCiAgICAgICAgICAgICAgICBzdHlsZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgICAgaWNvbjogJ2NoZWNrJwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIF90aGlzNi5yZW5hbWVEaWFsb2cgPSBmYWxzZTsKICAgICAgICAgICAgICBfdGhpczYucmVuYW1lQXNzZXROYW1lID0gJyc7CiAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxNTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBfdGhpczYuJHN0b3JlLmNvbW1pdCgncHVzaEdyYXBoRXJyb3InLCBuZXcgRXJyb3IoX2dldChyZXNwLCAnZGF0YS5hc3NldHMucmVuYW1lQXNzZXQucmVzcG9uc2VSZXN1bHQubWVzc2FnZScpKSk7CiAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAyMDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICBfY29udGV4dDUucHJldiA9IDE3OwogICAgICAgICAgICAgIF9jb250ZXh0NS50MCA9IF9jb250ZXh0NVsiY2F0Y2giXSgyKTsKICAgICAgICAgICAgICBfdGhpczYuJHN0b3JlLmNvbW1pdCgncHVzaEdyYXBoRXJyb3InLCBfY29udGV4dDUudDApOwogICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgIF90aGlzNi5yZW5hbWVBc3NldExvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICBfdGhpczYuJHN0b3JlLmNvbW1pdCgibG9hZGluZ1N0b3AiLCAnZWRpdG9yLW1lZGlhLXJlbmFtZWFzc2V0Jyk7CiAgICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUsIG51bGwsIFtbMiwgMTddXSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGRlbGV0ZUFzc2V0OiBmdW5jdGlvbiBkZWxldGVBc3NldCgpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvcigvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgdmFyIHJlc3A7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF90aGlzNy4kc3RvcmUuY29tbWl0KCJsb2FkaW5nU3RhcnQiLCAnZWRpdG9yLW1lZGlhLWRlbGV0ZWFzc2V0Jyk7CiAgICAgICAgICAgICAgX3RoaXM3LmRlbGV0ZUFzc2V0TG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgICAgX2NvbnRleHQ2LnByZXYgPSAyOwogICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNTsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXM3LiRhcG9sbG8ubXV0YXRlKHsKICAgICAgICAgICAgICAgIG11dGF0aW9uOiBkZWxldGVBc3NldE11dGF0aW9uLAogICAgICAgICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgICAgICAgIGlkOiBfdGhpczcuY3VycmVudEZpbGVJZAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgIGlmICghX2dldChyZXNwLCAnZGF0YS5hc3NldHMuZGVsZXRlQXNzZXQucmVzcG9uc2VSZXN1bHQuc3VjY2VlZGVkJywgZmFsc2UpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF90aGlzNy5jdXJyZW50RmlsZUlkID0gbnVsbDsKICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDEwOwogICAgICAgICAgICAgIHJldHVybiBfdGhpczcuJGFwb2xsby5xdWVyaWVzLmFzc2V0cy5yZWZldGNoKCk7CiAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgX3RoaXM3LiRzdG9yZS5jb21taXQoJ3Nob3dOb3RpZmljYXRpb24nLCB7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiBfdGhpczcuJHQoJ2VkaXRvcjphc3NldHMuZGVsZXRlU3VjY2VzcycpLAogICAgICAgICAgICAgICAgc3R5bGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgICAgIGljb246ICdjaGVjaycKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBfdGhpczcuZGVsZXRlRGlhbG9nID0gZmFsc2U7CiAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAxNTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBfdGhpczcuJHN0b3JlLmNvbW1pdCgncHVzaEdyYXBoRXJyb3InLCBuZXcgRXJyb3IoX2dldChyZXNwLCAnZGF0YS5hc3NldHMuZGVsZXRlQXNzZXQucmVzcG9uc2VSZXN1bHQubWVzc2FnZScpKSk7CiAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAyMDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDE3OwogICAgICAgICAgICAgIF9jb250ZXh0Ni50MCA9IF9jb250ZXh0NlsiY2F0Y2giXSgyKTsKICAgICAgICAgICAgICBfdGhpczcuJHN0b3JlLmNvbW1pdCgncHVzaEdyYXBoRXJyb3InLCBfY29udGV4dDYudDApOwogICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgIF90aGlzNy5kZWxldGVBc3NldExvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICBfdGhpczcuJHN0b3JlLmNvbW1pdCgibG9hZGluZ1N0b3AiLCAnZWRpdG9yLW1lZGlhLWRlbGV0ZWFzc2V0Jyk7CiAgICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYsIG51bGwsIFtbMiwgMTddXSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGNhbmNlbDogZnVuY3Rpb24gY2FuY2VsKCkgewogICAgICB0aGlzLmFjdGl2ZU1vZGFsID0gJyc7CiAgICB9CiAgfSwKICBhcG9sbG86IHsKICAgIGZvbGRlcnM6IHsKICAgICAgcXVlcnk6IGxpc3RGb2xkZXJBc3NldFF1ZXJ5LAogICAgICB2YXJpYWJsZXM6IGZ1bmN0aW9uIHZhcmlhYmxlcygpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgcGFyZW50Rm9sZGVySWQ6IHRoaXMuY3VycmVudEZvbGRlcklkCiAgICAgICAgfTsKICAgICAgfSwKICAgICAgZmV0Y2hQb2xpY3k6ICduZXR3b3JrLW9ubHknLAogICAgICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZShkYXRhKSB7CiAgICAgICAgcmV0dXJuIGRhdGEuYXNzZXRzLmZvbGRlcnM7CiAgICAgIH0sCiAgICAgIHdhdGNoTG9hZGluZzogZnVuY3Rpb24gd2F0Y2hMb2FkaW5nKGlzTG9hZGluZykgewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgibG9hZGluZyIgKyAoaXNMb2FkaW5nID8gJ1N0YXJ0JyA6ICdTdG9wJyksICdlZGl0b3ItbWVkaWEtZm9sZGVycy1saXN0LXJlZnJlc2gnKTsKICAgICAgfQogICAgfSwKICAgIGFzc2V0czogewogICAgICBxdWVyeTogbGlzdEFzc2V0UXVlcnksCiAgICAgIHZhcmlhYmxlczogZnVuY3Rpb24gdmFyaWFibGVzKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBmb2xkZXJJZDogdGhpcy5jdXJyZW50Rm9sZGVySWQsCiAgICAgICAgICBraW5kOiAnQUxMJwogICAgICAgIH07CiAgICAgIH0sCiAgICAgIHRocm90dGxlOiAxMDAwLAogICAgICBmZXRjaFBvbGljeTogJ25ldHdvcmstb25seScsCiAgICAgIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKGRhdGEpIHsKICAgICAgICByZXR1cm4gZGF0YS5hc3NldHMubGlzdDsKICAgICAgfSwKICAgICAgd2F0Y2hMb2FkaW5nOiBmdW5jdGlvbiB3YXRjaExvYWRpbmcoaXNMb2FkaW5nKSB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gaXNMb2FkaW5nOwogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgibG9hZGluZyIgKyAoaXNMb2FkaW5nID8gJ1N0YXJ0JyA6ICdTdG9wJyksICdlZGl0b3ItbWVkaWEtbGlzdC1yZWZyZXNoJyk7CiAgICAgIH0KICAgIH0KICB9Cn07"},null]}